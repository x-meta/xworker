%1500426178131
@
sname=SaveGifFirstFrame
slabel=保存Gif动画的第一帧
stype=composite
sgroup=界面.图片
sicon=icons/application.png
sstyledTextForInsert=parentContext.parentContext.codeText
suseTargetThingDoc=false
sdescriptors=xworker.swt.xworker.ThingRegistThing
sinheritDescription=false
sth_createIndex=true
sth_registThing=command|xworker.command.Root
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@Composite
  sname=Composite
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.xworker.ThingRegistThing/@Composite
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=Composite
    @/@Composite/@compositeGridLayout
    sname=compositeGridLayout
    smakeColumnsEqualWidth=false
    smarginWidth=5
    smarginHeight=5
    smarginLeft=0
    smarginTop=0
    smarginRight=0
    smarginBottom=0
    shorizontalSpacing=5
    sverticalSpacing=5
    sdescriptors=xworker.swt.Layouts/@GridLayout
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=compositeGridLayout
    @/@Composite/@thingForm
    sname=thingForm
    scolumn=1
    sH_SCROLL=true
    sV_SCROLL=true
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    sdescriptors=xworker.swt.Widgets/@ThingForm
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=thingForm
      @/@Composite/@thingForm/@Thing
      sname=Thing
      sdescriptors=xworker.swt.xworker.ThingForm/@Thing
      smany=true
      seditCols=2
      sinitialization=false
      smodifier=public
      sinheritDescription=false
      snotXmlAttribute=false
      sjson_isArray=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=Thing
        @/@Composite/@thingForm/@Thing/@description
        sname=description
        slabel=说明
        sinputtype=htmlDesc
        sshowLabel=true
        sreadOnly=false
        sdefault=xworker.things.p2017.p02.p21.SaveGifFirstFrame/@Composite/@thingForm/@Thing/@description
        sinheritDescription=false
        Sdescription=
#$@text#$@
<p>选择一个GIF把第一帧在相同的目录下保存为&lt;文件名.png&gt;。</p>

<p>如网页中让GIF动作有播放按钮的JavaScript需要第一帧的Png，如下面的代码：</p>

<pre class="brush:xml;">
&lt;p&gt;&lt;img alt=&quot;&quot; class=&quot;gifs&quot; data-gif=&quot;/images/2016/1107/193609swtexample.gif&quot; src=&quot;/images/2016/1107/193609swtexample.png&quot; style=&quot;max-width: 100%;&quot;&gt;&lt;/p&gt; 
     &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
     &lt;link href=&quot;/js/jquery/plugins/gifplayer.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;
     &lt;script type=&quot;text/javascript&quot; src=&quot;/js/jquery/plugins/jquery.gifplayer.js&quot;&gt;&lt;/script&gt;
     &lt;script&gt;
$(document).ready( function(){
  $(&#39;.gifs&#39;).gifplayer({
    label:&#39;&amp;#x25b7;&#39;
  });
});
&lt;/script&gt; </pre>

<p>&nbsp;</p>
#$@text#$@
        svalidateAllowBlank=true
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=description
        @/@Composite/@thingForm/@Thing/@GIF文件
        sname=path
        slabel=GIF文件
        sinputtype=file
        sshowLabel=true
        ssize=60
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=true
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=GIF文件
        @/@Composite/@thingForm/@Thing/@index
        sname=index
        slabel=第几帧
        sshowLabel=true
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=true
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=index
      @/@Composite/@thingForm/@thingFormGridData
      sname=thingFormGridData
      sstyle=FILL_BOTH
      shorizontalIndent=0
      swidth=-1
      sheight=-1
      shorizontalAlignment=BEGINNING
      sverticalAlignment=CENTER
      shorizontalSpan=1
      sverticalSpan=1
      sgrabExcessHorizontalSpace=false
      sgrabExcessVerticalSpace=false
      sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingFormGridData
    @/@Composite/@6131
    sname=buttonComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sid=6131
      @/@Composite/@6131/@6132
      sname=buttonCompositeGridData
      sstyle=FILL_HORIZONTAL
      shorizontalIndent=0
      swidth=-1
      sheight=-1
      shorizontalAlignment=END
      sverticalAlignment=CENTER
      shorizontalSpan=1
      sverticalSpan=1
      sgrabExcessHorizontalSpace=false
      sgrabExcessVerticalSpace=false
      sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
      sid=6132
      @/@Composite/@6131/@6133
      sname=buttonCompositeRowLayout
      sfill=false
      sjustify=false
      smarginWidth=0
      smarginHeight=0
      smarginLeft=3
      smarginTop=3
      smarginRight=3
      smarginBottom=3
      spack=true
      sspacing=3
      stype=SWT.HORIZONTAL
      swrap=true
      sdescriptors=xworker.swt.Layouts/@RowLayout
      sid=6133
      @/@Composite/@6131/@6134
      sname=saveButton
      stext=保存为PNG
      stype=SWT.PUSH
      sflat=false
      sborder=false
      sselected=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Button
      sth_createIndex=false
      sid=6134
        @/@Composite/@6131/@6134/@6135
        sname=RowData
        sexclude=false
        swidth=120
        sheight=-1
        sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
        sth_createIndex=false
        sid=6135
        @/@Composite/@6131/@6134/@6136
        sname=Listeners
        sdescriptors=xworker.swt.widgets.Widget/@Listeners
        sth_createIndex=false
        sid=6136
          @/@Composite/@6131/@6134/@6136/@6137
          sname=saveButtonSelection
          stype=Selection
          sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
          sth_createIndex=false
          sid=6137
            @/@Composite/@6131/@6134/@6136/@6137/@GroovyAction
            sname=GroovyAction
            sisSynchronized=false
            sthrowException=true
            suseOtherAction=false
            svarScope=Local
            sdisableGlobalContext=false
            Scode=
#$@text#$@
def values = thingForm.doAction("getValues", actionContext);
def gifFile = new File(values.path);
if(gifFile.exists()){
    def name = gifFile.getName();
    name = name.substring(0, name.lastIndexOf(".")) + ".png";
    def pngFile = new File(gifFile.getParentFile(), name);
    
    saveGif(actionContext, "gifFile", gifFile, "pngFile", pngFile, "frame", values.index);
    okMsg(actionContext);
}else{
    noGifMsg(actionContext);
}
#$@text#$@
            sinterpretationType=Action
            screateLocalVarScope=false
            ssaveReturn=false
            sdebugLog=false
            sdescriptors=xworker.lang.actions.Actions/@GroovyAction
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=GroovyAction
              @/@Composite/@6131/@6134/@6136/@6137/@GroovyAction/@ActionDefined
              sname=ActionDefined
              sdescriptors=xworker.lang.actions.Inout/@ActionDefined
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=ActionDefined
                @/@Composite/@6131/@6134/@6136/@6137/@GroovyAction/@ActionDefined/@msg
                sname=noGifMsg
                sshell=ognl:buttonComposite.getShell()
                sicon=ICON_WARNING
                sbuttons=OK
                stitle=文件不存在
                smessage=Gif文件不存在，请重新选择。
                sinterpretationType=Self
                sattributeTemplate=false
                schildsAttributeTemplate=false
                svarScope=Local
                sisSynchronized=false
                sthrowException=true
                suseOtherAction=false
                screateLocalVarScope=false
                ssaveReturn=false
                sdisableGlobalContext=false
                sdebugLog=false
                sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=msg
                @/@Composite/@6131/@6134/@6136/@6137/@GroovyAction/@ActionDefined/@msg1
                sname=okMsg
                sshell=ognl:buttonComposite.getShell()
                sicon=ICON_INFORMATION
                sbuttons=OK
                stitle=成功
                smessage=PNG文件已保存。
                sinterpretationType=Self
                sattributeTemplate=false
                schildsAttributeTemplate=false
                svarScope=Local
                sisSynchronized=false
                sthrowException=true
                suseOtherAction=false
                screateLocalVarScope=false
                ssaveReturn=false
                sdisableGlobalContext=false
                sdebugLog=false
                sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=msg1
                @/@Composite/@6131/@6134/@6136/@6137/@GroovyAction/@ActionDefined/@saveGif
                sname=saveGif
                sinputFile=var:gifFile
                sframe=var:frame
                soutputFormat=PNG
                soutputFile=var:pngFile
                sinterpretationType=Self
                sattributeTemplate=false
                schildsAttributeTemplate=false
                svarScope=Local
                sisSynchronized=false
                sthrowException=true
                suseOtherAction=false
                screateLocalVarScope=false
                ssaveReturn=false
                sdisableGlobalContext=false
                sdebugLog=false
                sdescriptors=xworker.swt.actions.GraphicsActions/@GifToOther
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=saveGif
