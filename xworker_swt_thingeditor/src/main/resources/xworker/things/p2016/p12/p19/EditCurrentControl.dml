%1624260407699
@
sname=EditCurrentControl
slabel=编辑控件
stype=composite
sgroup=控件.-1000|通用
sicon=icons/application.png
sstyledTextForInsert=parentContext.parentContext.codeText
suseTargetThingDoc=false
sen_label=Edit Control
sen_group=Widgets.-1000|Common
sdescriptors=xworker.content.QuickContent
sinheritDescription=false
sth_createIndex=true
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@composite
  sname=composite
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.content.QuickContent/@Composite
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=composite
    @/@composite/@resources
    sname=resources
    sdescriptors=xworker.swt.Widgets/@Resource
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=resources
      @/@composite/@resources/@I18nResource
      sname=I18nResource
      sdescriptors=xworker.swt.util.Resource/@I18nResource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=I18nResource
        @/@composite/@resources/@I18nResource/@saveButton
        sname=saveButton
        slabel=保存
        sen_label=Save
        sdescriptors=xworker.lang.util.I18nResource/@resource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=saveButton
    @/@composite/@editComposite
    sname=editComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=editComposite
      @/@composite/@editComposite/@shellGridLayout
      sname=editCompositeGridLayout
      smakeColumnsEqualWidth=false
      smarginWidth=5
      smarginHeight=5
      smarginLeft=0
      smarginTop=0
      smarginRight=0
      smarginBottom=0
      shorizontalSpacing=5
      sverticalSpacing=5
      sdescriptors=xworker.swt.Layouts/@GridLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=shellGridLayout
      @/@composite/@editComposite/@thingEditor
      sname=thingEditor
      stitle=true
      suseRootThing=false
      ssaveActionContainer=false
      svariablesActionContext=ognl:parentContext.parentContext.ui.getActionContext()
      sdescriptors=xworker.swt.Widgets/@ThingEditor
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingEditor
        @/@composite/@editComposite/@thingEditor/@thingEditorGridData
        sname=thingEditorGridData
        sstyle=FILL_BOTH
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=BEGINNING
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.Commons/@GridData
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=thingEditorGridData
      @/@composite/@editComposite/@1442
      sname=buttonComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sid=1442
        @/@composite/@editComposite/@1442/@1443
        sname=buttonCompositeGridData
        sstyle=FILL_HORIZONTAL
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=END
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sid=1443
        @/@composite/@editComposite/@1442/@1444
        sname=buttonCompositeRowLayout
        sfill=false
        sjustify=false
        smarginWidth=0
        smarginHeight=0
        smarginLeft=3
        smarginTop=3
        smarginRight=3
        smarginBottom=3
        spack=true
        sspacing=3
        stype=SWT.HORIZONTAL
        swrap=true
        sdescriptors=xworker.swt.Layouts/@RowLayout
        sid=1444
        @/@composite/@editComposite/@1442/@1445
        sname=saveButton
        stext=label:xworker.things.p2016.p12.p19.EditCurrentControl/@composite/@resources/@I18nResource/@saveButton
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=1445
          @/@composite/@editComposite/@1442/@1445/@1446
          sname=RowData
          sexclude=false
          swidth=80
          sheight=-1
          sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
          sth_createIndex=false
          sid=1446
          @/@composite/@editComposite/@1442/@1445/@1447
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=1447
            @/@composite/@editComposite/@1442/@1445/@1447/@1448
            sname=okButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=1448
              @/@composite/@editComposite/@1442/@1445/@1447/@1448/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import xworker.swt.design.InjectableComposite;

//获取正编辑的事物
def thing = thingEditor.editorActions.doAction("getRootThing");

//设置子节点，在帮助小精灵的变量上下文中
InjectableComposite.setChild(thing, actionContext);
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
        @/@composite/@editComposite/@1442/@14451
        sname=setNewControlButton
        stext=lang:d=重新设置控件&en=Set New Control
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=14451
          @/@composite/@editComposite/@1442/@14451/@1446
          sname=RowData
          sexclude=false
          swidth=120
          sheight=-1
          sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
          sth_createIndex=false
          sid=1446
          @/@composite/@editComposite/@1442/@14451/@1447
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=1447
            @/@composite/@editComposite/@1442/@14451/@1447/@1448
            sname=setNewControlButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=1448
              @/@composite/@editComposite/@1442/@14451/@1447/@1448/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
stackLayout.topControl = setControlComposite;
composite.layout();
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
    @/@composite/@Composite
    sname=setControlComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.xworker.ThingRegistThing/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=Composite
      @/@composite/@Composite/@resources
      sname=resources
      sdescriptors=xworker.swt.Widgets/@Resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=resources
        @/@composite/@Composite/@resources/@I18nResource
        sname=I18nResource
        sdescriptors=xworker.swt.util.Resource/@I18nResource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=I18nResource
          @/@composite/@Composite/@resources/@I18nResource/@setControlButton
          sname=setControlButton
          slabel=设置控件
          sen_label=Set Control
          sdescriptors=xworker.lang.util.I18nResource/@resource
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=setControlButton
      @/@composite/@Composite/@compositeGridLayout
      sname=compositeGridLayout
      smakeColumnsEqualWidth=false
      smarginWidth=5
      smarginHeight=5
      smarginLeft=0
      smarginTop=0
      smarginRight=0
      smarginBottom=0
      shorizontalSpacing=5
      sverticalSpacing=5
      sdescriptors=xworker.swt.Layouts/@GridLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=compositeGridLayout
      @/@composite/@Composite/@thingRegistor
      sname=thingRegistor
      sthing=xworker.swt.Widgets
      sregistType=child
      sparent=false
      ssearchByKeywords=true
      sshowContent=false
      scontentDisplayType=Composite
      sshowDescBrowser=true
      sdescBrowserRight=true
      sautoLoad=true
      scache=true
      sdescritporForNewThing=xworker.lang.MetaDescriptor3
      sdescritporChilds=false
      ssashFormWeights=50,50
      sdescriptors=xworker.swt.Widgets/@ThingRegistSelector
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingRegistor
        @/@composite/@Composite/@thingRegistor/@thingRegistorGridLayout
        sname=thingRegistorGridLayout
        sstyle=FILL_BOTH
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=BEGINNING
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=thingRegistorGridLayout
        @/@composite/@Composite/@thingRegistor/@actions
        sname=actions
        sdescriptors=xworker.swt.xworker.ThingRegistSelector/@actions1
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=actions
          @/@composite/@Composite/@thingRegistor/@actions/@selected
          sname=selected
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          Scode=
#$@text#$@
if(thing != null){
    actionContext.g().put("thing", thing);
    setButton.setEnabled(true);
}
#$@text#$@
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=selected
          @/@composite/@Composite/@thingRegistor/@actions/@defaultSelected
          sname=defaultSelected
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          Scode=
#$@text#$@
import org.xmeta.Thing;
import org.xmeta.ActionContext;

if(thing != null){
    actionContext.g().put("thing", thing);
    setButton.setEnabled(true);
    
    setButtonSelection.handleEvent(null);
    /*
    //创建新的子节点
    def child = new Thing(thing.getMetadata().getPath());
    def dialog = world.getThing("xworker.swt.design.prototype.InjectableNewChildDialog");
    def ac = new ActionContext();
    ac.put("parent", setButton.getShell());
    ac.put("parentContext", actionContext);
    def shell = dialog.doAction("create", ac);
    ac.thingEditor.editorActions.doAction("setThing", ["thing":child]);
    shell.setVisible(true);
    */
}
#$@text#$@
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=defaultSelected
      @/@composite/@Composite/@715
      sname=buttonComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sid=715
        @/@composite/@Composite/@715/@716
        sname=buttonCompositeGridData
        sstyle=FILL_HORIZONTAL
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=END
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sid=716
        @/@composite/@Composite/@715/@717
        sname=buttonCompositeRowLayout
        sfill=false
        sjustify=false
        smarginWidth=0
        smarginHeight=0
        smarginLeft=3
        smarginTop=3
        smarginRight=3
        smarginBottom=3
        spack=true
        sspacing=3
        stype=SWT.HORIZONTAL
        swrap=true
        sdescriptors=xworker.swt.Layouts/@RowLayout
        sid=717
        @/@composite/@Composite/@715/@718
        sname=setButton
        stext=label:xworker.things.p2016.p12.p19.EditCurrentControl/@composite/@Composite/@resources/@I18nResource/@setControlButton
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=false
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=718
          @/@composite/@Composite/@715/@718/@720
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=720
            @/@composite/@Composite/@715/@718/@720/@721
            sname=setButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=721
              @/@composite/@Composite/@715/@718/@720/@721/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import org.eclipse.swt.SWT;

//如果已经有了控件，先提示
def c = confirm(actionContext);

if(editButton.isEnabled() && c != "OK"){
    return;
}

def ac = new ActionContext();
ac.put("parent", setButton.getShell());
ac.put("parentContext", actionContext);

def dialogThing = world.getThing("xworker.swt.design.prototype.InjectableNewChildDialog");
def shell = dialogThing.doAction("create", ac);
def child = new Thing(thing.getMetadata().getPath());
ac.thingEditor.editorActions.doAction("setThing", ["thing":child]);
shell.setVisible(true);

//重新初始化
def action = world.getAction("xworker.things.p2016.p12.p19.EditCurrentControl/@composite/@init");
action.run(actionContext);
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
                @/@composite/@Composite/@715/@718/@720/@721/@GroovyAction/@ActionDefined
                sname=ActionDefined
                sdescriptors=xworker.lang.actions.Inout/@ActionDefined
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=ActionDefined
                  @/@composite/@Composite/@715/@718/@720/@721/@GroovyAction/@ActionDefined/@confirm
                  sname=confirm
                  sshell=ognl:composite.getShell()
                  sicon=ICON_QUESTION
                  sbuttons=OK | CANCEL
                  stitle=lang:d=设置控件&en=Set New Control
                  smessage=lang:d=确定要覆盖当前控件么？&en=Are you sure to replace current control?
                  sinterpretationType=Self
                  sattributeTemplate=false
                  schildsAttributeTemplate=false
                  svarScope=Local
                  sisSynchronized=false
                  sthrowException=true
                  suseOtherAction=false
                  screateLocalVarScope=false
                  ssaveReturn=false
                  sdisableGlobalContext=false
                  sdebugLog=false
                  sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
                  sinheritDescription=false
                  sth_createIndex=false
                  sth_registMyChilds=false
                  sth_registDisabled=false
                  sth_mark=false
                  sid=confirm
        @/@composite/@Composite/@715/@7181
        sname=editButton
        stext=lang:d=取消&en=Cancel
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=false
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=7181
          @/@composite/@Composite/@715/@7181/@720
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=720
            @/@composite/@Composite/@715/@7181/@720/@721
            sname=editButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=721
              @/@composite/@Composite/@715/@7181/@720/@721/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import org.xmeta.Thing;
import org.xmeta.ActionContext;

stackLayout.topControl = editComposite;
composite.layout();
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
    @/@composite/@stackLayout
    sname=stackLayout
    stopControl=setControlComposite
    sdescriptors=xworker.swt.Layouts/@StackLayout
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=stackLayout
    @/@composite/@init
    sname=init
    sisSynchronized=false
    sthrowException=true
    suseOtherAction=false
    svarScope=Local
    sdisableGlobalContext=false
    Scode=
#$@text#$@
//获取Interactive UI
def ui = parentContext.parentContext.ui;
def control = ui.getControl();

//设置编辑的事物
def thing = control.getData("thing");
def controlThing = thing.getThing("Control@0");
if(controlThing != null && controlThing.getChilds().size() > 0){
    def child = controlThing.getChilds().get(0);
    thingEditor.editorActions.doAction("setThing", ["thing":child]);
    
    editButton.setEnabled(true);
    
    stackLayout.topControl = editComposite;
    composite.layout();
}
#$@text#$@
    sinterpretationType=Action
    screateLocalVarScope=false
    ssaveReturn=false
    sdebugLog=false
    sdescriptors=xworker.swt.widgets.Widget/@Code
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=init
