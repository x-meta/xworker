%1582872930644
@
sname=shell
stext=数据库工具
sNO_TRIM=false
sCLOSE=true
sTITLE=true
sMIN=true
sMAX=true
sBORDER=false
sRESIZE=true
sON_TOP=false
sTOOL=false
sNO_FOCUS=false
swidth=1024
sheight=768
scenterScreen=true
spack=false
smaximized=false
sfullScreen=false
sdesign=true
sisIde=false
sdesignDefaultOpen=false
sH_SCROLL=false
sV_SCROLL=false
sNO_BACKGROUND=false
sNO_MERGE_PAINTS=false
sNO_REDRAW_RESIZE=false
sNO_RADIO_GROUP=false
sEMBEDDED=false
sDOUBLE_BUFFERED=false
slabel=DbTools
scapture=false
senabled=true
sredraw=true
svisible=true
sdescriptors=xworker.swt.widgets.Shell
sinheritDescription=false
sth_createIndex=false
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@shellFillLayout
  sname=shellFillLayout
  stype=SWT.HORIZONTAL
  sdescriptors=xworker.swt.Layouts/@FillLayout
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=shellFillLayout
  @/@mainSashForm
  sname=mainSashForm
  sstyle=HORIZONTAL
  sSMOOTH=false
  sweights=30,70
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.Widgets/@SashForm
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=mainSashForm
    @/@mainSashForm/@dataObjectsComposite
    sname=dataObjectsComposite
    sBORDER=true
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=dataObjectsComposite
      @/@mainSashForm/@dataObjectsComposite/@dataObjectsCompositeFillLayout
      sname=dataObjectsCompositeFillLayout
      stype=SWT.HORIZONTAL
      sdescriptors=xworker.swt.Layouts/@FillLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=dataObjectsCompositeFillLayout
      @/@mainSashForm/@dataObjectsComposite/@dataObjects
      sname=tools
      sthing=xworker.app.db.manager.DbToolsComposites
      sregistType=command
      ssearchByKeywords=true
      sshowDescBrowser=false
      sdescBrowserRight=false
      sautoLoad=true
      scache=true
      sdescritporForNewThing=xworker.swt.widgets.Composite
      sdescriptors=xworker.swt.Widgets/@ThingRegistSelector
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=dataObjects
        @/@mainSashForm/@dataObjectsComposite/@dataObjects/@actions
        sname=actions
        sdescriptors=xworker.swt.xworker.ThingRegistSelector/@actions1
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=actions
          @/@mainSashForm/@dataObjectsComposite/@dataObjects/@actions/@defaultSelected
          sname=selected
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          Scode=
#$@text#$@
if(thing != null){
    actions.doAction("openComposite", actionContext, ["composite":thing]);
}
#$@text#$@
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=defaultSelected
    @/@mainSashForm/@mainTabFolder
    sname=mainTabFolder
    sstyle=TOP
    sBORDER=true
    sFLAT=false
    sCLOSE=false
    sSINGLE=false
    sMRUVisible=false
    ssimple=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@CTabFolder
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=mainTabFolder
    @/@mainSashForm/@actions
    sname=actions
    sdescriptors=xworker.swt.Widgets/@actions
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=actions
      @/@mainSashForm/@actions/@openComposite
      sname=openComposite
      scompositePath=var:composite
      scTabFolder=var:mainTabFolder
      sclose=true
      stabItemText=ognl:composite.getMetadata().getLabel();
      stabItemKey=ognl:composite.getMetadata().getPath()
      stabContentKey=ognl:composite.getMetadata().getPath()
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sdescriptors=xworker.swt.actions.CTabFolderActions/@Composite
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=openComposite
        @/@mainSashForm/@actions/@openComposite/@actions
        sname=actions
        sdescriptors=xworker.lang.actions.SelfAction/@actions1
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=actions
          @/@mainSashForm/@actions/@openComposite/@actions/@getTabItemKey
          sname=getTabItemKey
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          scode=return composite.getMetadata().getPath();
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=getTabItemKey
          @/@mainSashForm/@actions/@openComposite/@actions/@getTabItemText
          sname=getTabItemText
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          scode=return composite.getMetadata().getLabel();
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=getTabItemText
          @/@mainSashForm/@actions/@openComposite/@actions/@getTabContentKey
          sname=getTabContentKey
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          scode=return composite.getMetadata().getPath();
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=getTabContentKey
      @/@mainSashForm/@actions/@init
      sname=ideInit
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
import org.xmeta.Thing;
def dbs = [
    "oracle":"xworker.app.db.indexs.ToolsOralceIndex",
    "derby":"xworker.app.db.indexs.ToolsDerbyIndex",
    "mysql":"xworker.app.db.indexs.ToolsMysqlIndex",
    "sqlserver":"xworker.app.db.indexs.ToolsSqlserverIndex",
    "db2":"xworker.app.db.indexs.ToolsDB2Index",
    "sqlite":"xworker.app.db.indexs.ToolsSqliteIndex"
];

if(actionContext.get("params") != null && params.get("fromDataSource")){
    //
    def dataSource = params.dataSource;
    
    if(actionContext.get("tab") != null){
        tab.setText(dataSource.metadata.label);
    }
    
    actionContext.g().put("dataSource", dataSource);
        
    //设置注册管理器
    def exts = "xworker.app.db.manager.DbToolsComposites," + dataSource.getMetadata().getPath();
    def dbType = dataSource.getStringBlankAsNull("dbType");
    if(dbType != null){
        dbType = dbType.toLowerCase();
        for(key in dbs.keySet()){
            if(dbType.indexOf(key) != -1){
                exts = exts + "," + dbs.get(key);
                break;
            }
        }
    }
    def toolsRegistThing = dataSource.getStringBlankAsNull("toolsRegistThing");
    if(toolsRegistThing != null){
        exts = exts + "," + toolsRegistThing;
    }
    def rthing = new Thing();        
    rthing.set("extends", exts);
    tools.doAction("init", actionContext, ["thing": rthing, "type":"command"]);
    tools.doAction("refresh", actionContext);
}
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sswitchResult=false
      sdebugLog=false
      sdescriptors=xworker.swt.widgets.Widget/@Code
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=init
      @/@mainSashForm/@actions/@setDataSource
      sname=setDataSource
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
import org.xmeta.Thing;
def dbs = [
    "oracle":"xworker.app.db.indexs.ToolsOralceIndex",
    "derby":"xworker.app.db.indexs.ToolsDerbyIndex",
    "mysql":"xworker.app.db.indexs.ToolsMysqlIndex",
    "sqlserver":"xworker.app.db.indexs.ToolsSqlserverIndex",
    "db2":"xworker.app.db.indexs.ToolsDB2Index",
    "sqlite":"xworker.app.db.indexs.ToolsSqliteIndex"
];
    
actionContext.g().put("dataSource", dataSource);
    
//设置注册管理器
def exts = "xworker.app.db.manager.DbToolsComposites," + dataSource.getMetadata().getPath();
def dbType = dataSource.getStringBlankAsNull("dbType");
if(dbType != null){
    dbType = dbType.toLowerCase();
    for(key in dbs.keySet()){
        if(dbType.indexOf(key) != -1){
            exts = exts + "," + dbs.get(key);
            break;
        }
    }
}
def toolsRegistThing = dataSource.getStringBlankAsNull("toolsRegistThing");
if(toolsRegistThing != null){
    exts = exts + "," + toolsRegistThing;
}
def rthing = new Thing();        
rthing.set("extends", exts);
tools.doAction("init", actionContext, ["thing": rthing, "type":"command"]);
tools.doAction("refresh", actionContext);
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sswitchResult=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_noThingRegistViewer=false
      sth_fileMonitor=false
      sth_mark=false
      sth_registQueryOnlySelf=false
      sid=setDataSource
        @/@mainSashForm/@actions/@setDataSource/@ins
        sisValidate=false
        sname=ins
        sdescriptors=xworker.lang.actions.Inout/@ins
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_noThingRegistViewer=false
        sth_fileMonitor=false
        sth_mark=false
        sth_registQueryOnlySelf=false
        sid=ins
          @/@mainSashForm/@actions/@setDataSource/@ins/@dataSource
          sname=dataSource
          stype=org.xmeta.Thing
          stypeCheck=false
          soptional=true
          scheck=false
          scheckLevel=exception
          sdescriptors=xworker.lang.actions.Inout/@ins/@param
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_noThingRegistViewer=false
          sth_fileMonitor=false
          sth_mark=false
          sth_registQueryOnlySelf=false
          sid=dataSource
  @/@init
  sname=init
  sisSynchronized=false
  sthrowException=true
  suseOtherAction=false
  svarScope=Local
  sdisableGlobalContext=false
  Scode=
#$@text#$@
if(actionContext.get("currentThing") != null){
    //从数据源事物的菜单进入的
    _g.put("dataSource", currentThing);
}else{
    //放入一个测试的数据源
    _g.put("dataSource", world.getThing("_local.xworker.db.appds.218.202.225.213_sh13_System"));
}
#$@text#$@
  sinterpretationType=Action
  screateLocalVarScope=false
  ssaveReturn=false
  sdebugLog=false
  sdescriptors=xworker.swt.widgets.Widget/@Code
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=init
