^1579677119519
@
sname
Contexts
slabel
Listeners
sgroup
actions
sdescritporForNewThing
xworker.message.MessageWithToolbar
Sdescription
#$@text#$@
<h1>动作监听器</h1>

<p>&nbsp;&nbsp;&nbsp; 动作监听器是一种可以监听动作执行的事物。它可以在动作执行前、执行成功或执行异常时执行相应的init、suceess和exception方法，从而可以监控动作的执行。另外也增加了onDoAction方法可以监听事物行为的执行。</p>

<p>&nbsp;&nbsp;&nbsp; 动作监听器可以用于实现动作监听，动作调试、数据库资源创建和释放等等功能。</p>

<h2>1.使用动作监听器</h2>

<p>&nbsp;&nbsp;&nbsp; 在一个动作下添加contexts（动作监听器或ActionListeners）子事物，既可以为该动作添加动作监听器。</p>

<p>&nbsp;&nbsp;&nbsp; 动作监听器本来叫做动作上下文，后改名为动作监听器，所以添加的是contexts子事物，标签是动作监听器（中文）或ActionListener(英文）。</p>

<h2>2.全局动作监听器</h2>

<p>&nbsp;&nbsp;&nbsp; 可以通过World.addGlobalActionListener(Thing listener, int index)方法添加一个全局动作监听器。</p>

<p>&nbsp;&nbsp;&nbsp;全局动作监听器会监听系统的每一个动作的执行，如果动作上下文执行耗时过多那么它会让系统的整体速度慢下来。</p>

<p>&nbsp;&nbsp;&nbsp; 比如XWorker的动作调试功能是通过全局动作监听器实现的。</p>

<h3>2.1.避免递归</h3>

<p>&nbsp;&nbsp;&nbsp; 为了避免递归，全局动作上下文的动作是不能被全局动作上下文监听的。</p>

<h2>4.如何实现动作监听器</h2>

<p>&nbsp;&nbsp;&nbsp; 实现了init、success、exception和onDoAction方法的事物都可以作为动作监听器。动作监听器应以child的方式注册到事物xworker.lang.context.Contexts下。</p>

<h3>4.1.获取被监听的动作和变量上下文</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp; 动作监听器使用独立的变量上下文，在动作监听器的变量上下文中可以获取监控的动作和动作变量上下文。</p>

<pre class="brush:java;">
//被监听的动作的变量上下文
ActionContext acContext = (ActionContext) actionContext.get(Action.str_parentContext);		
//获取被监听的动作
List&lt;Action&gt; actions = acContext.getActions();
Action action = actions.get(actions.size() - 1);</pre>

<p>&nbsp;&nbsp;&nbsp; 以上对init、sucess和exception方法有效。</p>

<h3>4.2.获取被监听的事物、方法名称</h3>

<p>&nbsp;&nbsp;&nbsp; 监听事物执行动作时并没有使用独立的变量上下文，因此当前变量上下文就是事物执行动作时的变量上下文。</p>

<pre class="brush:java;">
//获取事物以及相应要执行的方法名称
Thing thing = actionContext.getObject(&quot;thing&quot;);
String actionName = actionContext.getObject(&quot;actionName&quot;);</pre>

<p>&nbsp;</p>

<p>&nbsp;</p>
#$@text#$@
sdescriptors
xworker.lang.util.ThingIndex
sinheritDescription
false
sth_createIndex
true
sth_registThing
child|xworker.lang.util.ThingIndex
sth_registMyChilds
false
sth_registDisabled
false
sth_fileMonitor
false
Sen_description
#$@text#$@
<h1>Action Listener</h1>

<p>&nbsp;&nbsp;&nbsp; An action listener is a thing that can monitor the execution of an action. It can execute the corresponding init, suceess and exception methods before the action is executed, the execution is successful or the execution is abnormal, so that the execution of the action can be monitored. In addition, the onDoAction method is added to monitor the execution of things. </p>

<p>&nbsp;&nbsp;&nbsp; The action listener can be used to implement action monitoring, action debugging, database resource creation and release, and so on. </p>

<h2>1. Use the action listener</h2>

<p>&nbsp;&nbsp;&nbsp; Add contexts (action listeners or ActionListeners) sub-things under an action, and you can add action listeners for the action. </p>

<p>&nbsp;&nbsp;&nbsp; The action listener was originally called the action context, but was later renamed the action listener, so the contexts child thing was added, and the label was the action listener (Chinese) or ActionListener (English). </p>

<h2>2. Global action listener</h2>

<p>&nbsp;&nbsp;&nbsp; You can add a global action listener through the World.addGlobalActionListener(Thing listener, int index) method. </p>

<p>&nbsp;&nbsp;&nbsp;The global action listener will monitor the execution of every action in the system. If the execution of the action context takes too much time, it will slow down the overall speed of the system. </p>

<p>&nbsp;&nbsp;&nbsp; For example, the action debugging function of XWorker is realized through the global action listener. </p>

<h3>2.1. Avoid recursion</h3>

<p>&nbsp;&nbsp;&nbsp; To avoid recursion, actions in the global action context cannot be monitored by the global action context. </p>

<h2>4. How to implement an action listener</h2>

<p>&nbsp;&nbsp;&nbsp; Things that implement the init, success, exception and onDoAction methods can all be used as action listeners. The action listener should be registered under the thing xworker.lang.context.Contexts in a child manner. </p>

<h3>4.1. Get the monitored action and variable context</h3>

<p>&nbsp;&nbsp;&nbsp;&nbsp; The action listener uses an independent variable context, and the monitored action and action variable context can be obtained in the variable context of the action listener. </p>

<pre class="brush:java;">
//The variable context of the action being monitored
ActionContext acContext = (ActionContext) actionContext.get(Action.str_parentContext);
//Get the monitored action
List&lt;Action&gt; actions = acContext.getActions();
Action action = actions.get(actions.size()-1);</pre>

<p>&nbsp;&nbsp;&nbsp; The above is valid for init, sucess and exception methods. </p>

<h3>4.2. Get the name of the monitored thing and method</h3>

<p>&nbsp;&nbsp;&nbsp; does not use an independent variable context when monitoring things perform actions, so the current variable context is the variable context when things perform actions. </p>

<pre class="brush:java;">
//Get things and the name of the corresponding method to be executed
Thing thing = actionContext.getObject(&quot;thing&quot;);
String actionName = actionContext.getObject(&quot;actionName&quot;);</pre>

<p>&nbsp;</p>

<p>&nbsp;</p>
#$@text#$@
sth_mark
false
  @/@DataSouceActionContext
  sname
  DataSouceActionContext
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.db.jdbc.DataSouceActionContext
  smany
  true
  seditCols
  2
  sinitialization
  false
  sgroup
  db
  smodifier
  public
  sinheritDescription
  true
  sth_createIndex
  false
  sid
  DataSouceActionContext
  @/@HibernateContext
  sname
  HibernateContext
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.lang.context.HibernateContext
  smany
  true
  seditCols
  2
  sinitialization
  false
  sgroup
  db
  smodifier
  public
  sinheritDescription
  true
  sth_createIndex
  false
  sid
  HibernateContext
  @/@PerformanceContext
  sname
  PerformanceContext
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.lang.context.PerformanceContext
  smany
  true
  seditCols
  2
  sinitialization
  false
  sgroup
  debug
  smodifier
  public
  sinheritDescription
  true
  sth_createIndex
  false
  sid
  PerformanceContext
  @/@FileOutputStream
  sname
  FileOutputStream
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.lang.actions.io.FileOutputStream
  smany
  true
  seditCols
  2
  sinitialization
  false
  sgroup
  io
  smodifier
  public
  sinheritDescription
  true
  sth_createIndex
  false
  sid
  FileOutputStream
  @/@FileInputStream
  sname
  FileInputStream
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.lang.actions.io.FileInputStream
  smany
  true
  seditCols
  2
  sinitialization
  false
  sgroup
  io
  smodifier
  public
  sinheritDescription
  true
  sth_createIndex
  false
  sid
  FileInputStream
  @/@DebugContext
  sname
  DebugContext
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.lang.context.DebugContext
  smany
  true
  seditCols
  2
  sinitialization
  false
  sgroup
  debug
  smodifier
  public
  sinheritDescription
  true
  snotXmlAttribute
  false
  sjson_isArray
  false
  sth_createIndex
  false
  sth_registMyChilds
  false
  sth_registDisabled
  false
  sth_mark
  false
  sid
  DebugContext
  @/@ExecutorActionContext
  sname
  ExecutorActionContext
  sdescriptors
  xworker.lang.MetaDescriptor3/@thing
  sextends
  xworker.lang.executor.ExecutorActionContext
  smany
  true
  seditCols
  2
  sformNoLabel
  false
  sinitialization
  false
  sgroup
  executor
  smodifier
  public
  sinheritDescription
  true
  snotXmlAttribute
  false
  sjson_isArray
  false
  sth_createIndex
  false
  sth_registMyChilds
  false
  sth_registDisabled
  false
  sth_fileMonitor
  false
  sth_mark
  false
  sid
  ExecutorActionContext
  @/@AbstractActionListener
  sname
  AbstractActionListener
  sdescriptors
  xworker.lang.util.ThingIndex/@thing
  sextends
  xworker.lang.context.ActionListener,xworker.lang.actions.Context
  smany
  true
  seditCols
  2
  sformNoLabel
  false
  sinitialization
  false
  smodifier
  public
  sinheritDescription
  true
  snotXmlAttribute
  false
  sjson_isArray
  false
  sth_createIndex
  false
  sth_registMyChilds
  false
  sth_registDisabled
  false
  sth_noThingRegistViewer
  false
  sth_fileMonitor
  false
  sth_mark
  false
  sth_registQueryOnlySelf
  false
  sid
  AbstractActionListener
    @/@AbstractActionListener/@extends
    sname
    extends
    sgroup
    Regist
    sshowLabel
    true
    slabelAlign
    right
    slabelVAlign
    baseline
    smodifier
    public
    sreadOnly
    false
    sinheritDescription
    false
    svalidateAllowBlank
    true
    LvalidateOnBlur
    true
    LallowDecimals
    true
    LallowNegative
    true
    snotXmlAttribute
    false
    sdescriptors
    xworker.lang.MetaDescriptor3/@attribute
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sth_noThingRegistViewer
    false
    sth_fileMonitor
    false
    sth_mark
    false
    sth_registQueryOnlySelf
    false
    sid
    extends
    @/@AbstractActionListener/@th_createIndex
    sname
    th_createIndex
    slabel
    是否创建索引
    sinputtype
    truefalse
    sgroup
    Regist
    sshowLabel
    true
    slabelAlign
    right
    slabelVAlign
    baseline
    smodifier
    public
    sreadOnly
    false
    sdefault
    fasle
    sinheritDescription
    false
    sdescription
    <p>如果不是根事物，只有指定要创建索引数据库里才会创建索引。</p>
    svalidateAllowBlank
    true
    LvalidateOnBlur
    false
    LallowDecimals
    false
    LallowNegative
    false
    snotXmlAttribute
    false
    sen_label
    CreateIndex
    sdescriptors
    xworker.lang.MetaDescriptor3/@attribute
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sen_description
    <p>If it is not the root thing, an index will only be created in the database that is specified to be created. </p>
    sth_mark
    false
    sid
    th_createIndex
    @/@AbstractActionListener/@26113
    sname
    th_registThing
    ssize
    60
    sgroup
    Regist
    sshowLabel
    true
    slabelAlign
    right
    slabelVAlign
    baseline
    smodifier
    public
    sreadOnly
    false
    sinheritDescription
    false
    svalidateAllowBlank
    true
    LvalidateOnBlur
    true
    LallowDecimals
    true
    LallowNegative
    true
    snotXmlAttribute
    false
    sdescriptors
    xworker.lang.MetaDescriptor3/@attribute
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sth_fileMonitor
    false
    sth_mark
    false
    sid
    26113
