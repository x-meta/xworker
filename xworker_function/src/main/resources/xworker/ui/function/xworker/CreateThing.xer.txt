^1409708117942
@
sname
CreateThing
slabel
创建事物
sselfCallback
false
sdescription
<p>该函数用于创建一个事物，如果创建成功返回新创建的事物。</p>
sdescriptors
xworker.lang.function.Function
sth_createIndex
false
sth_mark
false
@/@actions
sname
actions
sdescriptors
xworker.lang.MetaDescriptor3/@actions
sth_createIndex
false
sth_mark
false
@/@actions/@doCheck
sname
doCheck
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
def thingName = actionContext.get("thingName");
def category = actionContext.get("category");
def descriptor = actionContext.get("descriptor");
def codeType = actionContext.get("codeType");

if(thingName == null || "" == thingName){
    return "事物名称不能为空！";
}

if(category == null){
    return "目录不存在，请选择存在的目录！";
}

if(world.getThingCoder(codeType) == null){
    return "事物编码" + codeType + "不存在，请重新选择编码。";
}

def thing = category.getThing(thingName);
if(thing != null){
    return "事物已经存在，请选择其他事物名，path=" + category.getName() + "." + thingName;
}

return null;
#$@text#$@
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
sth_createIndex
false
sth_mark
false
@/@actions/@doFunction
sname
doFunction
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
import org.xmeta.Thing;
import org.xmeta.cache.ThingCache;

def thingName = actionContext.get("thingName");
def category = actionContext.get("category");
def descriptor = actionContext.get("descriptor");
def codeType = actionContext.get("codeType");
def thManager = category.getThingManager();

//创建新的对象    
Thing thing = new Thing(thingName, thingName, descriptor, false);
thing.metadata.setCategory(category);
thing.metadata.initPath();
thing.metadata.setCoderType(codeType);
thManager.save(thing);

//放入缓存
ThingCache.put(thing.metadata.path, thing);

//返回值
return thing;
#$@text#$@
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
sth_createIndex
false
sth_mark
false
@/@label
sname
label
sshowLabel
true
ssize
40
sreadOnly
false
sinheritDescription
false
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
snotXmlAttribute
false
sdescriptors
xworker.ui.function.FunctionRequestUIHandlerProxy/@attribute
sth_createIndex
false
sth_registMyChilds
false
sth_mark
false
@/@descriptor
sname
descriptor
slabel
描述者
soptional
false
stype
string
sextends
xworker.lang.function.Parameter
Sdescription
#$@text#$@
<p><strong>创建事物-&gt;选择事物的描述者</strong></p>

<p>请选择一个事物的描述者。事物的描述者是事物的类或结构，比如如果要创建一个SWT的窗口，那么就可以选择xworker.swt.widgets.Shell作为描述者。</p>
#$@text#$@
sdescriptors
xworker.lang.function.Function/@thing
sth_createIndex
false
sth_mark
false
@/@descriptor/@BestFunction
sname
selectDescriptor
sfunctionPath
xworker.ui.function.xworker.SelectDescriptorFunction
sisDescriptor
true
sdescriptors
xworker.lang.function.Function/@thing/@BestFunction
sth_createIndex
false
sth_mark
false
@/@categoryPath
sname
category
slabel
目录
soptional
false
stype
string
sextends
xworker.lang.function.Parameter
Sdescription
#$@text#$@
<p><strong>创建事物-&gt;选择要保存到的事物管理器和目录</strong></p>

<p>请选择事物管理器和目录。事物管理器相当于项目，同一个项目的事物可以放到同一个事物管理器下，目录则是事物管理器下的事物分类目录。</p>

<p>设置事物管理器时会同时设置目录，反之亦然。</p>
#$@text#$@
sdescriptors
xworker.lang.function.Function/@thing
sth_createIndex
false
sth_mark
false
@/@categoryPath/@selectThingManager
sname
categoryManager
sfunctionPath
xworker.ui.function.xworker.SelectCategoryFunction
sisDescriptor
true
sdescriptors
xworker.lang.function.Function/@thing/@BestFunction
sth_createIndex
false
sth_mark
false
@/@thingName
sname
thingName
slabel
事物名称
soptional
false
stype
string
sextends
xworker.lang.function.Parameter
Sdescription
#$@text#$@
<p><strong>创建事物-&gt;事物命名</strong></p>

<p>请输入事物名称，事物名一般是文件名，事物名要符合文件名的规则。</p>
#$@text#$@
sdescriptors
xworker.lang.function.Function/@thing
sth_createIndex
false
sth_mark
false
@/@thingName/@BestFunction
sname
inputText
sfunctionPath
xworker.ui.function.swt.text.InputTextFunction
sisDescriptor
true
sdescriptors
xworker.lang.function.Function/@thing/@BestFunction
sth_createIndex
false
sth_mark
false
@/@thingName/@actions
sname
actions
sdescriptors
xworker.lang.MetaDescriptor3/@actions
sth_createIndex
false
sth_mark
false
@/@thingName/@actions/@doCheck
sname
doCheck
schangeSelf
false
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Self
sattributeTemplate
false
schildsAttributeTemplate
false
svarScope
Local
sisSynchronized
false
sthrowException
true
suseOtherAction
false
screateLocalVarScope
false
ssaveReturn
false
sdisableGlobalContext
false
sdescriptors
xworker.lang.actions.Actions/@ReturnFirstNotNull
sth_createIndex
false
sth_mark
false
@/@thingName/@actions/@doCheck/@actions
sname
actions
sdescriptors
xworker.lang.actions.ReturnFirstNotNull/@actions
sth_createIndex
false
sth_mark
false
@/@thingName/@actions/@doCheck/@actions/@notNull
sname
notNull
slabel
事物名称不能为空！
smessage
label:xworker.ui.function.xworker.CreateThing/@thingName/@actions/@doCheck/@actions/@notNull
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Self
sattributeTemplate
false
schildsAttributeTemplate
false
svarScope
Local
sisSynchronized
false
sthrowException
true
suseOtherAction
false
screateLocalVarScope
false
ssaveReturn
false
sdisableGlobalContext
false
sdescriptors
xworker.lang.function.actions.ParameterValidates/@NotNull
sth_createIndex
false
sth_mark
false
@/@codeType
sname
codeType
slabel
编码类型
soptional
false
stype
string
sextends
xworker.lang.function.Parameter
sdefaultValue
xer.txt
Sdescription
#$@text#$@
<p><strong>创建事物-&gt;选择事物的编码类型</strong></p>

<p>请选择事物的编码类型，xer.txt是默认的编码格式。</p>

<p><strong>注意</strong></p>

<p>XML格式不保存默认值，并且在初始化时如果连个事物相互是描述者时会递归产生错误。</p>
#$@text#$@
sdescriptors
xworker.lang.function.Function/@thing
sth_createIndex
false
sth_mark
false
@/@description
sname
description
sinputtype
htmlDesc
sshowLabel
false
sreadOnly
false
sdefault
xworker.ui.function.xworker.CreateThing
sinheritDescription
false
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
sdescriptors
xworker.lang.MetaDescriptor3/@attribute
sth_createIndex
false
sth_mark
false
