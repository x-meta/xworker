%1569572892132
@
sname=shell
stext=lang:d=另存为...&en=Save as...
sNO_TRIM=false
sCLOSE=true
sTITLE=true
sMIN=true
sMAX=true
sBORDER=false
sRESIZE=true
sON_TOP=false
sTOOL=false
sNO_FOCUS=false
swidth=400
sheight=480
scenterScreen=true
spack=false
smaximized=false
sfullScreen=false
sdesign=true
sisIde=false
sdesignDefaultOpen=false
sexitOnDispose=false
sH_SCROLL=false
sV_SCROLL=false
sNO_BACKGROUND=false
sNO_MERGE_PAINTS=false
sNO_REDRAW_RESIZE=false
sNO_RADIO_GROUP=false
sEMBEDDED=false
sDOUBLE_BUFFERED=false
slabel=SaveAsDialog
scapture=false
senabled=true
sredraw=true
svisible=true
sdescriptors=xworker.swt.widgets.Shell
sinheritDescription=false
sth_createIndex=false
sth_registMyChilds=false
sth_registDisabled=false
sth_fileMonitor=false
sth_mark=false
  @/@GridLayout
  sname=GridLayout
  snumColumns=2
  smakeColumnsEqualWidth=false
  smarginWidth=5
  smarginHeight=5
  smarginLeft=0
  smarginTop=0
  smarginRight=0
  smarginBottom=0
  shorizontalSpacing=5
  sverticalSpacing=5
  sdescriptors=xworker.swt.Layouts/@GridLayout
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_fileMonitor=false
  sth_mark=false
  sid=GridLayout
  @/@resources
  sname=resources
  sdescriptors=xworker.swt.Widgets/@Resource
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_mark=false
  sid=resources
    @/@resources/@packageImage
    sname=packageImage
    stype=Image
    simageFile=/xworker/ide/images/package.gif
    sdescriptors=xworker.swt.util.Resource/@Image
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_mark=false
    sid=packageImage
    @/@resources/@I18nResource
    sname=I18nResource
    sdescriptors=xworker.swt.util.Resource/@I18nResource
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=I18nResource
      @/@resources/@I18nResource/@title
      sname=title
      slabel=目录选择器
      sen_label=Category Selector
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=title
      @/@resources/@I18nResource/@projectItem
      sname=projectItem
      slabel=项目
      sen_label=Projects
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=projectItem
      @/@resources/@I18nResource/@thingLibItem
      sname=thingLibItem
      slabel=事物库
      sen_label=Thing Libs
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingLibItem
      @/@resources/@I18nResource/@okButton
      sname=okButton
      slabel=确定
      sen_label=Ok
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=okButton
      @/@resources/@I18nResource/@cancelButton
      sname=cancelButton
      slabel=取消
      sen_label=Cancel
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=cancelButton
      @/@resources/@I18nResource/@createCategoryButton
      sname=createCategoryButton
      slabel=创建目录
      sen_label=Create Category
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=createCategoryButton
      @/@resources/@I18nResource/@editLibButton
      sname=editLibButton
      slabel=编辑事物库
      sen_label=Edit Thing Libs
      sdescriptors=xworker.lang.util.I18nResource/@resource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=editLibButton
  @/@nameLabel
  sname=nameLabel
  sBORDER=false
  stype=HORIZONTAL
  salignment=LEFT
  stext=lang:d=名字：&en=Name:
  scapture=false
  senabled=true
  sredraw=true
  spack=false
  svisible=true
  sdescriptors=xworker.swt.Widgets/@Label
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_fileMonitor=false
  sth_mark=false
  sid=nameLabel
  @/@nameText
  sname=nameText
  sstyle=SINGLE
  sH_SCROLL=false
  sV_SCROLL=false
  sWRAP=false
  sREAD_ONLY=false
  sPASSWORD=false
  sSEARCH=false
  sCANCEL=false
  sBORDER=true
  salign=LEFT
  scapture=false
  senabled=true
  sredraw=true
  spack=false
  svisible=true
  sdescriptors=xworker.swt.Widgets/@Text
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_fileMonitor=false
  sth_mark=false
  sid=nameText
    @/@nameText/@nameTextGridData
    sname=nameTextGridData
    sstyle=FILL_HORIZONTAL
    shorizontalIndent=0
    swidth=-1
    sheight=-1
    shorizontalAlignment=BEGINNING
    sverticalAlignment=CENTER
    shorizontalSpan=1
    sverticalSpan=1
    sgrabExcessHorizontalSpace=false
    sgrabExcessVerticalSpace=false
    sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_fileMonitor=false
    sth_mark=false
    sid=nameTextGridData
  @/@typeLabel
  sname=typeLabel
  sBORDER=false
  stype=HORIZONTAL
  sshadow=SHADOW_OUT
  salignment=LEFT
  stext=label:xworker.ide.worldExplorer.swt.i18n.I18nResource/@newThingDialog/@codeType
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.Widgets/@Label
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=typeLabel
  @/@codecTypeCombo
  sname=codecTypeCombo
  stype=DROP_DOWN
  sREAD_ONLY=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.Widgets/@Combo
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=codecTypeCombo
    @/@codecTypeCombo/@codecTypeComboGridData
    sname=codecTypeComboGridData
    shorizontalIndent=0
    swidth=-1
    sheight=-1
    shorizontalAlignment=BEGINNING
    sverticalAlignment=CENTER
    shorizontalSpan=1
    sverticalSpan=1
    sgrabExcessHorizontalSpace=false
    sgrabExcessVerticalSpace=false
    sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=codecTypeComboGridData
  @/@tabFolder
  sname=tabFolder
  sstyle=TOP
  sBORDER=true
  sFLAT=true
  sCLOSE=false
  sSINGLE=false
  sMRUVisible=false
  ssimple=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.Widgets/@CTabFolder
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=tabFolder
    @/@tabFolder/@tabFolderGridData
    sname=tabFolderGridData
    sstyle=FILL_BOTH
    shorizontalIndent=0
    swidth=-1
    sheight=-1
    shorizontalAlignment=BEGINNING
    sverticalAlignment=CENTER
    shorizontalSpan=2
    sverticalSpan=1
    sgrabExcessHorizontalSpace=false
    sgrabExcessVerticalSpace=false
    sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=tabFolderGridData
    @/@tabFolder/@projectTabItem
    sname=projectTabItem
    stext=label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@projectItem
    sCLOSE=false
    sdescriptors=xworker.swt.custom.CTabFolder/@CTabItem
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=projectTabItem
      @/@tabFolder/@projectTabItem/@projectComposite
      sname=projectComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=projectComposite
        @/@tabFolder/@projectTabItem/@projectComposite/@projectCompositeGridLayout
        sname=projectCompositeGridLayout
        smakeColumnsEqualWidth=false
        smarginWidth=5
        smarginHeight=5
        smarginLeft=0
        smarginTop=0
        smarginRight=0
        smarginBottom=0
        shorizontalSpacing=5
        sverticalSpacing=5
        sdescriptors=xworker.swt.Layouts/@GridLayout
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=projectCompositeGridLayout
        @/@tabFolder/@projectTabItem/@projectComposite/@tree
        sname=tree
        sselectStyle=SINGLE
        sV_SCROLL=true
        sH_SCROLL=true
        sCHECK=false
        sFULL_SELECTION=false
        sHIDE_SELECTION=false
        sBORDER=false
        slineVisible=false
        smultipleColumns=false
        sheaderVisible=false
        ssortIndicator=false
        smoveableColumns=false
        sheadImages=false
        ssubImages=false
        scheckSelection=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Tree
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_mark=false
        sid=tree
          @/@tabFolder/@projectTabItem/@projectComposite/@tree/@treeGridData
          sname=treeGridData
          sstyle=FILL_BOTH
          shorizontalIndent=0
          swidth=-1
          sheight=-1
          shorizontalAlignment=BEGINNING
          sverticalAlignment=CENTER
          shorizontalSpan=1
          sverticalSpan=1
          sgrabExcessHorizontalSpace=false
          sgrabExcessVerticalSpace=false
          sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_mark=false
          sid=treeGridData
          @/@tabFolder/@projectTabItem/@projectComposite/@tree/@TreeModels
          sname=TreeModels
          sdescriptors=xworker.swt.widgets.Tree/@treeModels
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_mark=false
          sid=TreeModels
            @/@tabFolder/@projectTabItem/@projectComposite/@tree/@TreeModels/@XWorkerModel
            sname=XWorkerModel
            sdefaultWorld=true
            sdisplayLevel=category
            srefreshOnGetChilds=false
            srootVisiable=false
            sbindToParent=true
            smultiSubModel=false
            srootNodeId=__TreeNodeRootId__
            smultiSubModelSeparator=-
            sloadBackground=false
            saddTabUrl=false
            scacheExpandStatusId=xworker_project_tree
            sdescriptors=xworker.app.model.tree.TreeModels/@XWorkerModel
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_mark=false
            sid=XWorkerModel
          @/@tabFolder/@projectTabItem/@projectComposite/@tree/@Listeners
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_mark=false
          sid=Listeners
            @/@tabFolder/@projectTabItem/@projectComposite/@tree/@Listeners/@treeSelection
            sname=treeSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_mark=false
            sid=treeSelection
              @/@tabFolder/@projectTabItem/@projectComposite/@tree/@Listeners/@treeSelection/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import org.xmeta.Index;

def index = Index.getIndexById(event.item.getData().get("id"));
if(index.getType() == "thingManager" || index.getType() == "category"){
    okButton.setEnabled(true);
    createCategoryButton.setEnabled(true);
    actionContext.getScope(0).put("index", index);
}else{
    //log.info("index=" + index);
    okButton.setEnabled(false);
    actionContext.getScope(0).put("index", null);
    createCategoryButton.setEnabled(false);
}
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_mark=false
              sid=GroovyAction
            @/@tabFolder/@projectTabItem/@projectComposite/@tree/@Listeners/@treeDefaultSelection
            sname=treeDefaultSelection
            stype=DefaultSelection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=treeDefaultSelection
              @/@tabFolder/@projectTabItem/@projectComposite/@tree/@Listeners/@treeDefaultSelection/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import org.xmeta.Index;

def index = Index.getIndexById(event.item.getData().get("id"));
if(index.getType() == "thingManager" || index.getType() == "category"){
    okButton.setEnabled(true);
    createCategoryButton.setEnabled(true);
    actionContext.getScope(0).put("index", index);
    
    actionContext.getScope(0).put("result", index);
    shell.dispose();
}else{
    okButton.setEnabled(false);
    actionContext.getScope(0).put("index", null);
    createCategoryButton.setEnabled(false);
}
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_mark=false
              sid=GroovyAction
        @/@tabFolder/@projectTabItem/@projectComposite/@17578
        sname=buttonComposite
        sBORDER=false
        sH_SCROLL=false
        sV_SCROLL=false
        sNO_BACKGROUND=false
        sNO_FOCUS=false
        sNO_MERGE_PAINTS=false
        sNO_REDRAW_RESIZE=false
        sNO_RADIO_GROUP=false
        sEMBEDDED=false
        sDOUBLE_BUFFERED=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Composite
        sid=17578
          @/@tabFolder/@projectTabItem/@projectComposite/@17578/@17579
          sname=buttonCompositeGridData
          sstyle=FILL_HORIZONTAL
          shorizontalIndent=0
          swidth=-1
          sheight=-1
          shorizontalAlignment=END
          sverticalAlignment=CENTER
          shorizontalSpan=1
          sverticalSpan=1
          sgrabExcessHorizontalSpace=false
          sgrabExcessVerticalSpace=false
          sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
          sid=17579
          @/@tabFolder/@projectTabItem/@projectComposite/@17578/@17580
          sname=buttonCompositeRowLayout
          sfill=false
          sjustify=false
          smarginWidth=0
          smarginHeight=0
          smarginLeft=3
          smarginTop=3
          smarginRight=3
          smarginBottom=3
          spack=true
          sspacing=3
          stype=SWT.HORIZONTAL
          swrap=true
          sdescriptors=xworker.swt.Layouts/@RowLayout
          sid=17580
          @/@tabFolder/@projectTabItem/@projectComposite/@17578/@5153
          sname=createCategoryButton
          stext=label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@createCategoryButton
          stype=SWT.PUSH
          sflat=false
          sborder=false
          sselected=false
          scapture=false
          senabled=false
          sredraw=true
          svisible=true
          sdescriptors=xworker.swt.Widgets/@Button
          sth_createIndex=false
          sid=5153
            @/@tabFolder/@projectTabItem/@projectComposite/@17578/@5153/@5155
            sname=Listeners
            sdescriptors=xworker.swt.widgets.Widget/@Listeners
            sth_createIndex=false
            sid=5155
              @/@tabFolder/@projectTabItem/@projectComposite/@17578/@5153/@5155/@5156
              sname=createCategoryButtonSelection
              stype=Selection
              sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex=false
              sid=5156
                @/@tabFolder/@projectTabItem/@projectComposite/@17578/@5153/@5155/@5156/@GroovyAction
                sname=GroovyAction
                sisSynchronized=false
                sthrowException=true
                suseOtherAction=false
                svarScope=Local
                sdisableGlobalContext=false
                Scode=
#$@text#$@
import org.xmeta.ActionContext;
import xworker.swt.util.SwtDialog;
import org.xmeta.util.UtilString;
import org.xmeta.Index;
import org.xmeta.ThingManager;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.MessageBox;
import org.eclipse.swt.widgets.TreeItem;

def data = tree.getSelection()[0].getData();
def theIndex = Index.getIndexById(data.get("id"));
def category = theIndex.getIndexObject();
def thingManager = null;
if(category instanceof ThingManager){
    thingManager = category;
}else{
    thingManager = category.getThingManager();
}
def ac = new ActionContext();
ac.put("parent", tree.getShell());

def shellThing = world.getThing("xworker.ide.worldExplorer.swt.dialogs.NewCategoryDialog/@shellt");
def shell = shellThing.doAction("create", ac);
def dialog = new SwtDialog(tree.getShell(), shell, ac);

def newCategory = dialog.open();
if(newCategory != null){
    def categoryPath =  null;
    if(category.getCategory(newCategory) != null){
        MessageBox box = new MessageBox(tree.getShell(), SWT.OK | SWT.ICON_ERROR);
        box.setText(UtilString.getString("res:res.w_exp:commonBoxTitle:操作信息", actionContext));
        box.setMessage(UtilString.getString("res:res.w_exp:alertCategoryExists:目录已经存在！", actionContext));
        box.open();
        return;
    }else{
        def simpleCategoryName = newCategory;
        if(category.getName() != "" && category.getName() != null){
            newCategory = category.getName() + "." + newCategory;
        }
        
        if(!thingManager.createCategory(newCategory)){
            MessageBox box = new MessageBox(shell, SWT.OK | SWT.ICON_ERROR);
            box.setText(StringUtils.getString("label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@createCategoryButton", actionContext));
            box.setMessage("不能创建目录：" + newPackage + "!");
            box.open();
            return;
        }else{
            def parentTreeItem = tree.getSelection()[0];
            def parentIndex = parentTreeItem.getData().get("index");
            parentIndex.refresh();
            def newIndex = null;
            for(index in parentIndex.childs){
                if(index.name == simpleCategoryName){
                     newIndex = index;
                     break;
                }
            }
            //查找插入的位置
            int index = 0;
            for(item in parentTreeItem.getItems()){
                if(item.getData().name >= simpleCategoryName){         
                    break;
                }
                
                index ++;
            }
            
            TreeItem citem = new TreeItem(parentTreeItem, SWT.NONE, index);
            citem.setText(simpleCategoryName);
            citem.setData(["data":newIndex, "index":newIndex,"name":simpleCategoryName, "id":newIndex.getPath()]);
            citem.setImage(packageImage);
            citem.setData("_treeModel",  tree.getSelection()[0].getData("_treeModel"));
            
            //println(newIndex);
            actionContext.getScope(0).put("index", newIndex);
        }
    }
}
#$@text#$@
                sinterpretationType=Action
                screateLocalVarScope=false
                ssaveReturn=false
                sdebugLog=false
                sdescriptors=xworker.lang.actions.Actions/@GroovyAction
                sth_createIndex=false
                sth_mark=false
                sid=GroovyAction
    @/@tabFolder/@thingLibTabItem
    sname=thingLibTabItem
    stext=label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@thingLibItem
    sCLOSE=false
    sdescriptors=xworker.swt.custom.CTabFolder/@CTabItem
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=thingLibTabItem
      @/@tabFolder/@thingLibTabItem/@libComposite
      sname=libComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=libComposite
        @/@tabFolder/@thingLibTabItem/@libComposite/@libCompositeGridLayout
        sname=libCompositeGridLayout
        smakeColumnsEqualWidth=false
        smarginWidth=5
        smarginHeight=5
        smarginLeft=0
        smarginTop=0
        smarginRight=0
        smarginBottom=0
        shorizontalSpacing=5
        sverticalSpacing=5
        sdescriptors=xworker.swt.Layouts/@GridLayout
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=libCompositeGridLayout
        @/@tabFolder/@thingLibTabItem/@libComposite/@libTable
        sname=libTable
        sselectStyle=SINGLE
        sV_SCROLL=true
        sH_SCROLL=true
        sCHECK=false
        sFULL_SELECTION=true
        sHIDE_SELECTION=true
        sBORDER=false
        slineVisible=true
        smultipleColumns=false
        sheaderVisible=false
        ssortIndicator=true
        smoveableColumns=true
        sheadImages=false
        ssubImages=false
        sVIRTUAL=false
        scapture=false
        senabled=true
        sredraw=true
        spack=false
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Table
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=libTable
          @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@DataStore
          sname=DataStore
          sattachToParent=true
          sloadBackground=true
          sautoLoad=false
          sautoSave=false
          spaging=extend
          spageSize=50
          sstoreSortField=_extend
          sstoreSortDir=ASC
          seditable=extend
          seditmethod=extend
          sdescriptors=xworker.swt.widgets.Table/@DataStore
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=DataStore
            @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@DataStore/@dataObjects
            sname=dataObjects
            sdescriptors=xworker.app.view.swt.data.DataStore/@DataObjects
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=dataObjects
              @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@DataStore/@dataObjects/@AbstractDataObject
              sname=AbstractDataObject
              seditCols=2
              spaging=false
              sreadUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@read
              screateUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@create
              supdateUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@update
              sdestroyUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@destroy
              LstoreAutoDestroy=false
              sstoreAutoLoad=false
              LstoreAutoSave=true
              LstoreBatch=true
              LstorePruneModifiedRecords=false
              LstoreRemoteSort=false
              LstoreRestful=false
              sstoreRoot='rows'
              sstoreSuccessProperty='success'
              sstoreTotalProperty='totalCount'
              sstoreMessageProperty='msg'
              sgridEditable=false
              sgridEditType=cell
              sformReadUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@read
              sformCreateUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@create
              sformUpdateUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@update
              sformDestroyUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@delete
              spaging_afterPageText=页 共
              spaging_beforePageText=第
              Lpaging_displayInfo=false
              spaging_displayMsg=第{0}-第{1}条，共{2}条
              spaging_emptyMsg=没有数据
              spaging_firstText=首页
              spaging_lastText=最后一页
              spaging_nextText=下一页
              Lpaging_prependButtons=false
              spaging_prevText=上一页
              spaging_refreshText=刷新
              sgridColumnLocking=false
              sgridLockText='锁定'
              sgridUnlockText='解锁'
              scolumnGroup=false
              sgridCheckable=false
              sgridRowNumber=false
              sgridGrouping=false
              sgridGroupTextTpl='{text} ({[values.rs.length]} 条)'
              sgridRowExpander=false
              sautoGenerateId=false
              sidGenerateType=action
              sidAction=generateId
              sstoreSortDir=ASC
              sautoInit=false
              sautoInitAction=beforeCreate
              scacheRelation=false
              scacheRelationMaxSize=1000
              scacheRelationReadnone=false
              safterCreated=false
              sonLoaded=false
              sbeforeUpdate=false
              safterUpdated=false
              sbeforeDelete=false
              safterDeleted=false
              safterQueryed=false
              sdescriptors=xworker.dataObject.DataObjects/@AbstractDataObject
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=AbstractDataObject
                @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@DataStore/@dataObjects/@AbstractDataObject/@name
                sname=name
                slabel=事物库名
                stype=string
                soptional=true
                skey=false
                sdataField=true
                sviewField=true
                sreadField=true
                screateEditor=true
                seditEditor=true
                sviewEditor=true
                sgridEditor=true
                squeryEditor=true
                sreadOnly=false
                seditable=true
                sdisabled=false
                sshowLabel=true
                slabelAlign=right
                slabelVAlign=baseline
                svalidateAllowBlank=true
                LvalidateOnBlur=true
                LallowDecimals=true
                LallowNegative=true
                sshowInTable=true
                sgridWidth=350
                sdisplayRelationLabel=false
                sgridFixed=false
                sgridHidden=false
                sgridHideable=true
                sgridSortable=false
                scolumnLocked=false
                sgridGroupable=true
                sgridMenuDisabled=false
                sgridResizable=true
                sen_label=Name
                sdescriptors=xworker.dataObject.AbstractDataObject/@attribute
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=name
          @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@Listeners
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=Listeners
            @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@Listeners/@libTableSelection
            sname=libTableSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=libTableSelection
              @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@Listeners/@libTableSelection/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
def lib = event.item.getData();
def index = lib.getTodayIndex();
actionContext.getScope(0).put("index", index);

okButton.setEnabled(true);
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
            @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@Listeners/@libTableDefaultSeleciton
            sname=libTableDefaultSeleciton
            stype=DefaultSelection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=libTableDefaultSeleciton
              @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@Listeners/@libTableDefaultSeleciton/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
def lib = event.item.getData();
def index = lib.getTodayIndex();
actionContext.getScope(0).put("index", index);

okButton.setEnabled(true);

actionContext.getScope(0).put("result", index);
shell.dispose();
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
          @/@tabFolder/@thingLibTabItem/@libComposite/@libTable/@libTableGriddata
          sname=libTableGriddata
          sstyle=FILL_BOTH
          shorizontalIndent=0
          swidth=-1
          sheight=-1
          shorizontalAlignment=BEGINNING
          sverticalAlignment=CENTER
          shorizontalSpan=1
          sverticalSpan=1
          sgrabExcessHorizontalSpace=false
          sgrabExcessVerticalSpace=false
          sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=libTableGriddata
        @/@tabFolder/@thingLibTabItem/@libComposite/@5387
        sname=libButtonComposite
        sBORDER=false
        sH_SCROLL=false
        sV_SCROLL=false
        sNO_BACKGROUND=false
        sNO_FOCUS=false
        sNO_MERGE_PAINTS=false
        sNO_REDRAW_RESIZE=false
        sNO_RADIO_GROUP=false
        sEMBEDDED=false
        sDOUBLE_BUFFERED=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Composite
        sid=5387
          @/@tabFolder/@thingLibTabItem/@libComposite/@5387/@5388
          sname=buttonCompositeGridData
          sstyle=FILL_HORIZONTAL
          shorizontalIndent=0
          swidth=-1
          sheight=-1
          shorizontalAlignment=END
          sverticalAlignment=CENTER
          shorizontalSpan=1
          sverticalSpan=1
          sgrabExcessHorizontalSpace=false
          sgrabExcessVerticalSpace=false
          sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
          sid=5388
          @/@tabFolder/@thingLibTabItem/@libComposite/@5387/@5389
          sname=buttonCompositeRowLayout
          sfill=false
          sjustify=false
          smarginWidth=0
          smarginHeight=0
          smarginLeft=3
          smarginTop=3
          smarginRight=3
          smarginBottom=3
          spack=true
          sspacing=3
          stype=SWT.HORIZONTAL
          swrap=true
          sdescriptors=xworker.swt.Layouts/@RowLayout
          sid=5389
          @/@tabFolder/@thingLibTabItem/@libComposite/@5387/@5390
          sname=editLibButton
          stext=label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@editLibButton
          stype=SWT.PUSH
          sflat=false
          sborder=false
          sselected=false
          scapture=false
          senabled=true
          sredraw=true
          svisible=true
          sdescriptors=xworker.swt.Widgets/@Button
          sth_createIndex=false
          sid=5390
            @/@tabFolder/@thingLibTabItem/@libComposite/@5387/@5390/@5392
            sname=Listeners
            sdescriptors=xworker.swt.widgets.Widget/@Listeners
            sth_createIndex=false
            sid=5392
              @/@tabFolder/@thingLibTabItem/@libComposite/@5387/@5390/@5392/@5393
              sname=editLibButtonSelection
              stype=Selection
              sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex=false
              sid=5393
                @/@tabFolder/@thingLibTabItem/@libComposite/@5387/@5390/@5392/@5393/@GroovyAction
                sname=GroovyAction
                sisSynchronized=false
                sthrowException=true
                suseOtherAction=false
                svarScope=Local
                sdisableGlobalContext=false
                Scode=
#$@text#$@
import org.xmeta.util.UtilThing;
import xworker.util.XWorkerUtils;

def libConfig = UtilThing.getThingIfNotExistsCreate("_local.xworker.config.ThingLib", "_local", "xworker.ide.config.ThingLib");

XWorkerUtils.ideOpenThing(libConfig);
#$@text#$@
                sinterpretationType=Action
                screateLocalVarScope=false
                ssaveReturn=false
                sdebugLog=false
                sdescriptors=xworker.lang.actions.Actions/@GroovyAction
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=GroovyAction
  @/@17578
  sname=buttonComposite
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.Widgets/@Composite
  sid=17578
    @/@17578/@17579
    sname=buttonCompositeGridData
    sstyle=FILL_HORIZONTAL
    shorizontalIndent=0
    swidth=-1
    sheight=-1
    shorizontalAlignment=END
    sverticalAlignment=CENTER
    shorizontalSpan=2
    sverticalSpan=1
    sgrabExcessHorizontalSpace=false
    sgrabExcessVerticalSpace=false
    sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
    sid=17579
    @/@17578/@17580
    sname=buttonCompositeRowLayout
    sfill=false
    sjustify=false
    smarginWidth=0
    smarginHeight=0
    smarginLeft=3
    smarginTop=3
    smarginRight=3
    smarginBottom=3
    spack=true
    sspacing=3
    stype=SWT.HORIZONTAL
    swrap=true
    sdescriptors=xworker.swt.Layouts/@RowLayout
    sid=17580
    @/@17578/@17581
    sname=okButton
    stext=label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@okButton
    stype=SWT.PUSH
    sflat=false
    sborder=false
    sselected=false
    scapture=false
    senabled=false
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Button
    sth_createIndex=false
    sid=17581
      @/@17578/@17581/@17582
      sname=RowData
      sexclude=false
      swidth=80
      sheight=-1
      sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
      sth_createIndex=false
      sid=17582
      @/@17578/@17581/@17583
      sname=Listeners
      sdescriptors=xworker.swt.widgets.Widget/@Listeners
      sth_createIndex=false
      sid=17583
        @/@17578/@17581/@17583/@17584
        sname=okButtonSelection
        stype=Selection
        sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
        sth_createIndex=false
        sid=17584
          @/@17578/@17581/@17583/@17584/@GroovyAction
          sname=GroovyAction
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          Scode=
#$@text#$@
import org.xmeta.Index;
import org.xmeta.ThingManager;

//名字
def name = nameText.getText();
if(name == null || name == ""){
    noname(actionContext);
    return;
}

//编码方法
def coderType = codecTypeCombo.getText();

//修改事物另存为
def thingManager = null;
def categoryName = null;
def category = index.getIndexObject();
if(category instanceof ThingManager){
    thingManager = category.getName();
    categoryName = null;
}else{
    thingManager = category.getThingManager().getName();
    categoryName = category.getName();
}

def thingPath = name;
if(categoryName != null){
    thingPath = categoryName + "." + thingPath;
}
println thingManager + ":" + thingPath;
//检验事物是否已经存在
if(world.getThing(thingPath) != null){
    exists(actionContext);
    return;
}

if(actionContext.get("thing") != null){
    //另存为
    thing.getMetadata().setCoderType(coderType);
    thing.saveAs(thingManager, thingPath);
}

if(actionContext.get("actionThing") != null){
    actionTiong.doAction("ok", parentContext, "thing", thing);
}

shell.dispose();
#$@text#$@
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_mark=false
          sid=GroovyAction
            @/@17578/@17581/@17583/@17584/@GroovyAction/@ActionDefined
            sname=ActionDefined
            sdescriptors=xworker.lang.actions.Inout/@ActionDefined
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_fileMonitor=false
            sth_mark=false
            sid=ActionDefined
              @/@17578/@17581/@17583/@17584/@GroovyAction/@ActionDefined/@noname
              sname=noname
              sshell=var:shell
              sicon=ICON_WARNING
              sbuttons=OK
              stitle=lang:d=另存为...&en=Save as...
              smessage=lang:d=请输入名字!&en=Please input name!
              sinterpretationType=Self
              sattributeTemplate=false
              schildsAttributeTemplate=false
              svarScope=Local
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              screateLocalVarScope=false
              ssaveReturn=false
              sdisableGlobalContext=false
              sdebugLog=false
              sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_fileMonitor=false
              sth_mark=false
              sid=noname
              @/@17578/@17581/@17583/@17584/@GroovyAction/@ActionDefined/@noname1
              sname=exists
              sshell=var:shell
              sicon=ICON_WARNING
              sbuttons=OK
              stitle=lang:d=另存为...&en=Save as...
              smessage=lang:d=事物已经在!&en=Thing already exists!
              sinterpretationType=Self
              sattributeTemplate=false
              schildsAttributeTemplate=false
              svarScope=Local
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              screateLocalVarScope=false
              ssaveReturn=false
              sdisableGlobalContext=false
              sdebugLog=false
              sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_fileMonitor=false
              sth_mark=false
              sid=noname1
    @/@17578/@17585
    sname=cancelButton
    stext=label:xworker.ide.worldExplorer.swt.tools.CategoryIndexSelector/@resources/@I18nResource/@cancelButton
    stype=SWT.PUSH
    sflat=false
    sborder=false
    sselected=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Button
    sth_createIndex=false
    sid=17585
      @/@17578/@17585/@17586
      sname=RowData
      sexclude=false
      swidth=80
      sheight=-1
      sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
      sth_createIndex=false
      sid=17586
      @/@17578/@17585/@17587
      sname=Listeners
      sdescriptors=xworker.swt.widgets.Widget/@Listeners
      sth_createIndex=false
      sid=17587
        @/@17578/@17585/@17587/@17588
        sname=cancelButtonSelection
        stype=Selection
        sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
        sth_createIndex=false
        sid=17588
          @/@17578/@17585/@17587/@17588/@GroovyAction
          sname=GroovyAction
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          Scode=
#$@text#$@
if(actionContext.get("actionThing") != null){
    actionTiong.doAction("cancel", parentContext, "thing", thing);
}

shell.dispose();
#$@text#$@
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_mark=false
          sid=GroovyAction
  @/@init
  sname=init
  sisSynchronized=false
  sthrowException=true
  suseOtherAction=false
  svarScope=Local
  sdisableGlobalContext=false
  Scode=
#$@text#$@
import xworker.ide.config.ThingLibs;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;

def libs = ThingLibs.getAllLibs();
for(lib in libs){
    def item = new TableItem(libTable, SWT.NONE);
    item.setText(lib.label);
    item.setData(lib);
}

for(thingCoder in world.getThingCoders()){
    for(type in thingCoder.getCodeTypes()){
        codecTypeCombo.add(type);
    }
}
codecTypeCombo.select(0);
#$@text#$@
  sinterpretationType=Action
  screateLocalVarScope=false
  ssaveReturn=false
  sdebugLog=false
  sdescriptors=xworker.swt.widgets.Widget/@Code
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=init
