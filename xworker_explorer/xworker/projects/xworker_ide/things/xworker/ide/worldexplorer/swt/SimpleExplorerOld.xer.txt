^1592893541582
@
sname
SimpleExplorer
slabel
SimpleExplorerOld
sdescriptors
xworker.swt.widgets.Display
  @/@shell1
  sname
  shell
  stext
  res:res.w_exp:worldExplorer:事物管理器
  sstyle
  MODELESS
  sNO_TRIM
  false
  sCLOSE
  true
  sTITLE
  true
  sMIN
  true
  sMAX
  true
  sBORDER
  false
  sRESIZE
  true
  sON_TOP
  false
  sTOOL
  false
  sNO_FOCUS
  false
  swidth
  1024
  sheight
  768
  scenterScreen
  true
  spack
  false
  smaximized
  true
  sfullScreen
  false
  simeInputMode
  NONE
  sdesign
  true
  sisIde
  false
  sdesignDefaultOpen
  false
  sexitOnDispose
  true
  sH_SCROLL
  false
  sV_SCROLL
  false
  sNO_BACKGROUND
  false
  sNO_MERGE_PAINTS
  false
  sNO_REDRAW_RESIZE
  false
  sNO_RADIO_GROUP
  false
  sEMBEDDED
  false
  sDOUBLE_BUFFERED
  false
  slabel
  shell
  scapture
  false
  senabled
  true
  sredraw
  true
  svisible
  true
  sdescriptors
  xworker.swt.widgets.Display/@Shell
  sid
  shell1
    @/@shell1/@resources
    sname
    resources
    slabel
    resources
    sdescriptors
    xworker.swt.Widgets/@Resource
    sid
    resources
      @/@shell1/@resources/@saveImage
      sname
      saveImage
      stype
      Image
      simageFile
      /xworker/ide/images/save.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      saveImage
      @/@shell1/@resources/@newImage
      sname
      newImage
      stype
      Image
      simageFile
      /xworker/ide/images/new.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      newImage
      @/@shell1/@resources/@openImage
      sname
      openImage
      stype
      Image
      simageFile
      /xworker/ide/images/open.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      openImage
      @/@shell1/@resources/@tabSelectBackground
      sname
      tabSelectBackground
      srgb
      "#D2E9FF"
      sdescriptors
      xworker.swt.util.Resource/@Color
      sid
      tabSelectBackground
      @/@shell1/@resources/@flowImage
      sname
      flowImage
      stype
      Image
      simageFile
      /xworker/ide/images/thingFlow.GIF
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      flowImage
      @/@shell1/@resources/@xImage
      sname
      xImage
      stype
      Image
      simageFile
      icons/application_key.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      xImage
      @/@shell1/@resources/@openThingImage
      sname
      openThingImage
      stype
      Image
      simageFile
      /xworker/ide/images/openThing.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      openThingImage
      @/@shell1/@resources/@openActionImage
      sname
      openActionImage
      stype
      Image
      simageFile
      /xworker/ide/images/openAction.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sid
      openActionImage
      @/@shell1/@resources/@manong
      sname
      manongImage
      stype
      Image
      simageFile
      icons/world.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sth_createIndex
      false
      sth_mark
      false
      sid
      manong
      @/@shell1/@resources/@taskImage
      sname
      taskImage
      stype
      Image
      simageFile
      icons/clock_go.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      taskImage
      @/@shell1/@resources/@flowTaskImage
      sname
      flowTaskImage
      stype
      Image
      simageFile
      icons/chart_curve_go.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      flowTaskImage
      @/@shell1/@resources/@guideImage
      sname
      guideImage
      stype
      Image
      simageFile
      icons/user.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      guideImage
      @/@shell1/@resources/@templateImage
      sname
      templateImage
      stype
      Image
      simageFile
      icons/shape_move_forwards.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      templateImage
      @/@shell1/@resources/@noteImage
      sname
      noteImage
      stype
      Image
      simageFile
      icons/note_edit.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      noteImage
      @/@shell1/@resources/@monitorImage
      sname
      monitorImage
      stype
      Image
      simageFile
      icons/clock_pause.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      monitorImage
      @/@shell1/@resources/@debugEditImage
      sname
      debugEditImage
      stype
      Image
      simageFile
      icons/bug_edit.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      debugEditImage
      @/@shell1/@resources/@functionImage
      sname
      functionImage
      stype
      Image
      simageFile
      icons/page_white_actionscript.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      functionImage
      @/@shell1/@resources/@topicImage
      sname
      topicImage
      stype
      Image
      simageFile
      icons/application_home.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      topicImage
      @/@shell1/@resources/@I18nResource
      sname
      I18nResource
      sdescriptors
      xworker.swt.util.Resource/@I18nResource
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      I18nResource
        @/@shell1/@resources/@I18nResource/@helpSpriteButton
        sname
        helpSpriteButton
        slabel
        帮助小精灵
        sen_label
        Help Sprite
        sdescriptors
        xworker.lang.util.I18nResource/@resource
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        helpSpriteButton
      @/@shell1/@resources/@serviceImage
      sname
      serviceImage
      stype
      Image
      simageFile
      icons/cog.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      serviceImage
      @/@shell1/@resources/@databaseImage
      sname
      databaseImage
      stype
      Image
      simageFile
      icons/database_gear.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      databaseImage
      @/@shell1/@resources/@dataObjectImage
      sname
      dataObjectImage
      stype
      Image
      simageFile
      icons/table_multiple.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      dataObjectImage
      @/@shell1/@resources/@messageImage
      sname
      messageImage
      stype
      Image
      simageFile
      icons/email.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      messageImage
      @/@shell1/@resources/@thingImage
      sname
      thingImage
      stype
      Image
      simageFile
      icons/xworker/dataObject.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      thingImage
      @/@shell1/@resources/@monitorImage1
      sname
      monitorImage
      stype
      Image
      simageFile
      icons/monitor.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      monitorImage1
      @/@shell1/@resources/@projectNavImage
      sname
      projectNavImage
      stype
      Image
      simageFile
      icons/org/eclipse/swt/widgets/Tree.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      projectNavImage
      @/@shell1/@resources/@outlineImage
      sname
      outlineImage
      stype
      Image
      simageFile
      icons/org/eclipse/eview16/outline_co.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      outlineImage
      @/@shell1/@resources/@progressImage
      sname
      progressImage
      stype
      Image
      simageFile
      icons/org/eclipse/progress/pview.gif
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      progressImage
      @/@shell1/@resources/@aiLearningImage
      sname
      aiLearningImage
      stype
      Image
      simageFile
      icons/building_go.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      aiLearningImage
      @/@shell1/@resources/@userTaskImage
      sname
      userTaskImage
      stype
      Image
      simageFile
      icons/user_go.png
      sdescriptors
      xworker.swt.util.Resource/@Image
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_fileMonitor
      false
      sth_mark
      false
      sid
      userTaskImage
    @/@shell1/@mainMenu
    sname
    mainMenu
    sstyle
    BAR
    sNO_RADIO_GROUP
    false
    salign
    LEFT_TO_RIGHT
    slabel
    mainMenu
    sdescriptors
    xworker.swt.Widgets/@Menu
    sid
    mainMenu
      @/@shell1/@mainMenu/@menuFile
      sname
      menuFile
      stext
      res:res.w_exp:menuFile:文件
      sstyle
      CASCADE
      sselected
      false
      senabled
      true
      slabel
      menuFile
      sdescriptors
      xworker.swt.widgets.Menu/@MenuItem
      sid
      menuFile
        @/@shell1/@mainMenu/@menuFile/@menuNewFile
        sname
        menuNewFile
        sstyle
        DROP_DOWN
        sNO_RADIO_GROUP
        false
        salign
        LEFT_TO_RIGHT
        slabel
        menuNewFile
        sdescriptors
        xworker.swt.widgets.Menu/@MenuItem/@Menu
        sid
        menuNewFile
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenThingItem
          sname
          menuOpenThingItem
          stext
          res:res.w_exp:toolBarItemOpenThing:打开事物
          simage
          openThingImage
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuOpenThingItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenThingItem/@listeners
            sname
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenThingItem/@listeners/@menuOpenThingItemSelection
              sname
              menuOpenThingItemSelection
              stype
              Selection
              sref
              xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openToolItem/@listeners/@openToolItemSelection/@GroovyAction
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              menuOpenThingItemSelection
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenActionItem
          sname
          menuOpenActionItem
          stext
          打开动作
          simage
          openActionImage
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuOpenActionItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenActionItem/@listeners
            sname
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenActionItem/@listeners/@MenuOpenActionItemSelection
              sname
              MenuOpenActionItemSelection
              stype
              Selection
              sref
              xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@saveToolItem/@listeners/@saveToolItemSelection/@GroovyAction
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              MenuOpenActionItemSelection
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSaveItem
          sname
          menuFileSaveItem
          stext
          res:res.w_exp:menuItemSave:保存
          sstyle
          PUSH
          simage
          saveImage
          saccelerator
          Ctrl+S
          sselected
          false
          senabled
          true
          slabel
          menuFileSaveItem
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sid
          menuFileSaveItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSaveItem/@listeners
            sname
            listeners
            slabel
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSaveItem/@listeners/@menuFileSaveItemSelection
              sname
              menuFileSaveItemSelection
              stype
              Selection
              slabel
              menuFileSaveItemSelection
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sid
              menuFileSaveItemSelection
                @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSaveItem/@listeners/@menuFileSaveItemSelection/@GroovyAction
                sname
                GroovyAction
                sisSynchronized
                true
                sthrowException
                true
                suseOtherAction
                false
                svarScope
                Global
                sdisableGlobalContext
                false
                Scode
#$@text#$@
//取得当前编辑窗体中的Tab的actionContext
def tab = centerTabFolder.getSelection();
def tabActionContext = tab.getData("actionContext");

if(tabActionContext != null){
    //执行保存操作
    saveEditor.run(actionContext, "editorContext", tabActionContext);
    /*
    //如果actionContext中有okButtonSelection，执行保存
    def okButtonSelection = tabActionContext.get("okButtonSelection");
    if(okButtonSelection != null){
        okButtonSelection.handleEvent(null);
    }*/
}
#$@text#$@
                sinterpretationType
                Action
                screateLocalVarScope
                false
                ssaveReturn
                false
                sdebugLog
                false
                sdescriptors
                xworker.lang.actions.Actions/@GroovyAction
                sid
                GroovyAction
                  @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSaveItem/@listeners/@menuFileSaveItemSelection/@GroovyAction/@ActionDefined
                  sname
                  ActionDefined
                  sdescriptors
                  xworker.lang.actions.Inout/@ActionDefined
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  ActionDefined
                    @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSaveItem/@listeners/@menuFileSaveItemSelection/@GroovyAction/@ActionDefined/@saveEditor
                    sname
                    saveEditor
                    seditorContext
                    var:editorContext
                    sinterpretationType
                    Self
                    sattributeTemplate
                    false
                    schildsAttributeTemplate
                    false
                    svarScope
                    Local
                    sisSynchronized
                    false
                    sthrowException
                    true
                    screateLocalVarScope
                    false
                    ssaveReturn
                    false
                    sdisableGlobalContext
                    false
                    sdebugLog
                    false
                    sdescriptors
                    xworker.swt.xwidgets.app.AppActions/@Save
                    sinheritDescription
                    false
                    sth_createIndex
                    false
                    sth_registMyChilds
                    false
                    sth_registDisabled
                    false
                    sth_mark
                    false
                    sid
                    saveEditor
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSplit1
          sname
          menuFileSplit1
          sstyle
          SEPARATOR
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuFileSplit1
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuTasksItem
          sname
          menuTasksItem
          stext
          任务监控管理
          simage
          taskImage
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuTasksItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuTasksItem/@listeners
            sname
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuTasksItem/@listeners/@menuTasksItemSelection
              sname
              menuTasksItemSelection
              stype
              Selection
              sref
              xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@workFlow1/@listeners/@workFlowToolItemSelection/@openTaskManager
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              menuTasksItemSelection
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFloatTaskItem
          sname
          menuFloatTaskItem
          stext
          流程监控管理
          simage
          flowTaskImage
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuFloatTaskItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFloatTaskItem/@listeners
            sname
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFloatTaskItem/@listeners/@menuFloatTaskItemSelection
              sname
              menuFloatTaskItemSelection
              stype
              Selection
              sref
              xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@workFlow11/@listeners/@workFlowToolItemSelection/@openTaskManager
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              menuFloatTaskItemSelection
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSplit3
          sname
          menuFileSplit3
          sstyle
          SEPARATOR
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuFileSplit3
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenFunctionItem
          sname
          menuOpenFunctionItem
          stext
          Open functions
          simage
          xImage
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuOpenFunctionItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenFunctionItem/@listeners
            sname
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuOpenFunctionItem/@listeners/@menuOpenFunctionItemSelection
              sname
              menuOpenFunctionItemSelection
              stype
              Selection
              sref
              xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem/@listeners/@openFunctionsItemSelection/@GroovyAction
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              menuOpenFunctionItemSelection
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuMannongItem
          sname
          menuMannongItem
          stext
          码农的世界
          simage
          manongImage
          sselected
          false
          senabled
          true
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          menuMannongItem
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuMannongItem/@listeners
            sname
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuMannongItem/@listeners/@Listener
              sname
              menuMannongItemListener
              stype
              Selection
              sref
              workFlowToolItemSelection
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              Listener
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuFileSplit2
          sname
          menuFileSplit2
          sstyle
          SEPARATOR
          slabel
          menuFileSplit2
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sid
          menuFileSplit2
          @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuExit
          sname
          menuExit
          stext
          res:res.w_exp:menuItemExit:退出
          sstyle
          PUSH
          sselected
          false
          senabled
          true
          slabel
          menuExit
          sdescriptors
          xworker.swt.widgets.Menu/@MenuItem
          sid
          menuExit
            @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuExit/@listeners
            sname
            listeners
            slabel
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sid
            listeners
              @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuExit/@listeners/@menuExitSelection
              sname
              menuExitSelection
              stype
              Selection
              slabel
              menuExitSelection
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sid
              menuExitSelection
                @/@shell1/@mainMenu/@menuFile/@menuNewFile/@menuExit/@listeners/@menuExitSelection/@GroovyAction
                sname
                GroovyAction
                sisSynchronized
                false
                sthrowException
                false
                suseOtherAction
                false
                svarScope
                Global
                sdisableGlobalContext
                false
                scode
                shell.dispose();
                sdescriptors
                xworker.lang.actions.Actions/@GroovyAction
                sid
                GroovyAction
    @/@shell1/@shellFillLayout
    sname
    shellFillLayout
    stype
    SWT.HORIZONTAL
    slabel
    shellFillLayout
    sdescriptors
    xworker.swt.layout.FillLayout
    sid
    shellFillLayout
    @/@shell1/@mainComposite
    sname
    mainComposite
    sBORDER
    false
    sH_SCROLL
    false
    sV_SCROLL
    false
    sNO_BACKGROUND
    false
    sNO_FOCUS
    false
    sNO_MERGE_PAINTS
    false
    sNO_REDRAW_RESIZE
    false
    sNO_RADIO_GROUP
    false
    sEMBEDDED
    false
    sDOUBLE_BUFFERED
    false
    slabel
    mainComposite
    sdescriptors
    xworker.swt.Widgets/@Composite
    sid
    mainComposite
      @/@shell1/@mainComposite/@mainCompositeFillLayout
      sname
      mainCompositeGridLayout
      snumColumns
      2
      smakeColumnsEqualWidth
      false
      smarginWidth
      5
      smarginHeight
      5
      smarginLeft
      0
      smarginTop
      0
      smarginRight
      0
      smarginBottom
      0
      shorizontalSpacing
      5
      sverticalSpacing
      5
      slabel
      mainCompositeFillLayout
      sdescriptors
      xworker.swt.layout.GridLayout,xworker.swt.Layouts/@FillLayout
      sid
      mainCompositeFillLayout
      @/@shell1/@mainComposite/@mainCoolBar
      sname
      mainCoolBar
      stype
      HORIZONTAL
      sBORDER
      false
      sFLAT
      true
      sdescriptors
      xworker.swt.Widgets/@CoolBar
      sid
      mainCoolBar
        @/@shell1/@mainComposite/@mainCoolBar/@mainCoolBarGridData
        sname
        mainCoolBarGridData
        sstyle
        FILL_HORIZONTAL
        shorizontalIndent
        0
        swidth
        -1
        sheight
        -1
        shorizontalAlignment
        BEGINNING
        sverticalAlignment
        CENTER
        shorizontalSpan
        1
        sverticalSpan
        1
        sgrabExcessHorizontalSpace
        false
        sgrabExcessVerticalSpace
        false
        slabel
        mainCoolBarGridData
        sdescriptors
        xworker.swt.Commons/@GridData
        sid
        mainCoolBarGridData
        @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem
        sname
        mainCollItem
        sDROP_DOWN
        false
        slabel
        mainCollItem
        sdescriptors
        xworker.swt.widgets.CoolBar/@CoolItem
        sid
        mainCollItem
          @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar
          sname
          mainToolBar
          stype
          HORIZONTAL
          sFLAT
          true
          sWRAP
          false
          sBORDER
          false
          sSHADOW_OUT
          false
          sRIGHT
          false
          slabel
          mainToolBar
          sdescriptors
          xworker.swt.widgets.CoolBar/@CoolItem/@ToolBar
          sid
          mainToolBar
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@topicToolItem
            sname
            topicToolItem
            stype
            PUSH
            simage
            topicImage
            stoolTiptext
            主页
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            topicToolItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@topicToolItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@topicToolItem/@listeners/@topicToolItemSelection
                sname
                topicToolItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_mark
                false
                sid
                topicToolItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@topicToolItem/@listeners/@topicToolItemSelection/@openComposite
                  sname
                  openComposite
                  stitle
                  label:xworker.ide.worldexplorer.swt.i18n.TopicI18n/@main/@title
                  scompositePath
                  xworker.ui.topic.TopicShell/@mainComposite
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_mark
                  false
                  sid
                  openComposite
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openToolItem
            sname
            newThingToolItem
            stype
            PUSH
            simage
            newImage
            stoolTiptext
            新建事物
            senabled
            true
            slabel
            newThingToolItem
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            openToolItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openToolItem/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openToolItem/@listeners/@openToolItemSelection
                sname
                openToolItemSelection
                stype
                Selection
                slabel
                openToolItemSelection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                openToolItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openToolItem/@listeners/@openToolItemSelection/@GroovyAction
                  sname
                  GroovyAction
                  sisSynchronized
                  false
                  sthrowException
                  true
                  suseOtherAction
                  false
                  svarScope
                  Global
                  sdisableGlobalContext
                  false
                  Scode
#$@text#$@
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import xworker.swt.util.SwtDialog;

Thing dialogObject = world.getThing("xworker.ide.worldexplorer.swt.dialogs.NewThingDialog/@shell");

def parentShell = projectTree.getShell();
def newContext = new ActionContext();
newContext.put("parent", parentShell);

def newShell = dialogObject.doAction("create", newContext);

SwtDialog dialog = new SwtDialog(parentShell, newShell, newContext);
dialog.open();
#$@text#$@
                  sinterpretationType
                  Action
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.lang.actions.Actions/@GroovyAction
                  sid
                  GroovyAction
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@saveToolItem
            sname
            openActionItem
            stype
            PUSH
            simage
            openThingImage
            stoolTiptext
            打开动作
            senabled
            true
            slabel
            openActionItem
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sid
            saveToolItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@saveToolItem/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@saveToolItem/@listeners/@saveToolItemSelection
                sname
                saveToolItemSelection
                stype
                Selection
                slabel
                saveToolItemSelection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                saveToolItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@saveToolItem/@listeners/@saveToolItemSelection/@GroovyAction
                  sname
                  GroovyAction
                  sisSynchronized
                  false
                  sthrowException
                  true
                  suseOtherAction
                  false
                  svarScope
                  Global
                  sdisableGlobalContext
                  false
                  Scode
#$@text#$@
import org.xmeta.ActionContext;
import org.xmeta.util.UtilString;

ActionContext newContext = new ActionContext();
newContext.put("parent", shell);
newContext.put("type", "dataObject");
newContext.put("explorerActions", actions);

def shellObj = world.getThing("xworker.ide.worldexplorer.swt.dialogs.OpenThingDialog/@shell");
def shell = shellObj.doAction("create", newContext);
shell.setText(UtilString.getString("res:res.w_exp:menuItemOpenThing:打开事物", actionContext));
shell.open();
/*
import org.xmeta.ActionContext;
import org.xmeta.util.UtilString;

ActionContext newContext = new ActionContext();
newContext.put("parent", shell);
newContext.put("type", "scriptObject");
newContext.put("explorerActions", actions);

def shellObj = world.getThing("xworker.ide.worldexplorer.swt.dialogs.OpenThingDialog/@shell");
def shell = shellObj.doAction("create", newContext);
shell.setText(UtilString.getString("res:res.w_exp:menuItemOpenAction:打开动作", actionContext));
shell.open();
*/
#$@text#$@
                  sinterpretationType
                  Action
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.lang.actions.Actions/@GroovyAction
                  sid
                  GroovyAction
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@specator
            sname
            specator
            stype
            SEPARATOR
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sth_createIndex
            false
            sth_mark
            false
            sid
            specator
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@workFlow1
            sname
            tasksItem
            stype
            PUSH
            simage
            taskImage
            stoolTiptext
            lang:d=后台任务管理&en=Background Tasks
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sth_createIndex
            false
            sth_mark
            false
            sid
            workFlow1
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@workFlow1/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sth_createIndex
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@workFlow1/@listeners/@workFlowToolItemSelection
                sname
                workFlowToolItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sth_createIndex
                false
                sth_mark
                false
                sid
                workFlowToolItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@workFlow1/@listeners/@workFlowToolItemSelection/@openTaskManager
                  sname
                  openTaskManager
                  scompositePath
                  xworker.ide.task.TaskManager/@mainCompostie
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_mark
                  false
                  sid
                  openTaskManager
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@monitorItem
            sname
            userTaskItem
            stype
            PUSH
            simage
            userTaskImage
            stoolTiptext
            lang:d=用户任务&en=User Tasks
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            monitorItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@monitorItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@monitorItem/@listeners/@monitorItemSelection
                sname
                monitorItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_mark
                false
                sid
                monitorItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@monitorItem/@listeners/@monitorItemSelection/@openMonitor
                  sname
                  openMonitor
                  stitle
                  lang:d=用户任务&en=User Tasks
                  scompositePath
                  xworker.app.userflow.swt.UserFlowTask/@progressComposite
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_mark
                  false
                  sid
                  openMonitor
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@messageCenterItem
            sname
            messageCenterItem
            stype
            PUSH
            simage
            icons/comments.png
            stoolTiptext
            lang:d=消息中心&en=Message Center
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            messageCenterItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@messageCenterItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sth_createIndex
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@messageCenterItem/@listeners/@workFlowToolItemSelection
                sname
                messageCenterlItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sth_createIndex
                false
                sth_mark
                false
                sid
                workFlowToolItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@messageCenterItem/@listeners/@workFlowToolItemSelection/@openTaskManager
                  sname
                  openMessageCenterManager
                  scompositePath
                  xworker.lang.system.message.MessageDescriptorViewer/@messageViewer
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_mark
                  false
                  sid
                  openTaskManager
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@resourceStatusItem
            sname
            resourceMonitorItem
            stype
            PUSH
            simage
            monitorImage
            stoolTiptext
            lang:d=资源监控&en=Resource Monitor
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_fileMonitor
            false
            sth_mark
            false
            sid
            resourceStatusItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@resourceStatusItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@resourceStatusItem/@listeners/@monitorItemSelection
                sname
                resouceStatusItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_mark
                false
                sid
                monitorItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@resourceStatusItem/@listeners/@monitorItemSelection/@openMonitor
                  sname
                  openResouceStatus
                  stitle
                  资源状态
                  scompositePath
                  xworker.app.resource.swt.ResourceStatusViewer/@mainComposite
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sen_label
                  Resource Status
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_fileMonitor
                  false
                  sth_mark
                  false
                  sid
                  openMonitor
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem
            sname
            resourceManagerItem
            stype
            DROP_DOWN
            simage
            dataObjectImage
            stoolTiptext
            lang:d=资源管理&en=Resources Manager
            senabled
            true
            slabel
            resourceManagerItem
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_fileMonitor
            false
            sth_mark
            false
            sid
            openFunctionsItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem/@listeners/@openFunctionsItemSelection
                sname
                dataObjectItemSelection
                stype
                Selection
                slabel
                openFunctionsItemSelection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                openFunctionsItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem/@listeners/@openFunctionsItemSelection/@ShowMenuByEventWidgets
                  sname
                  ShowMenuByEventWidgets
                  sdynamic
                  true
                  snewActionContext
                  true
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.swt.actions.MenuActions/@ShowMenuAlignControl
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_fileMonitor
                  false
                  sth_mark
                  false
                  sid
                  ShowMenuByEventWidgets
                    @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem/@listeners/@openFunctionsItemSelection/@ShowMenuByEventWidgets/@Menus
                    sname
                    Menus
                    sdescriptors
                    xworker.swt.actions.MenuActions/@ShowMenuAlignControl/@Menus
                    sinheritDescription
                    false
                    sth_createIndex
                    false
                    sth_registMyChilds
                    false
                    sth_registDisabled
                    false
                    sth_fileMonitor
                    false
                    sth_mark
                    false
                    sid
                    Menus
                      @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@openFunctionsItem/@listeners/@openFunctionsItemSelection/@ShowMenuByEventWidgets/@Menus/@Menu
                      sname
                      Menu
                      sthing
                      xworker.ide.worldexplorer.swt.resources.ResourceMenus
                      sregistType
                      child
                      sitemPrefix
                      resource
                      sdescriptors
                      xworker.swt.Widgets/@ThingRegistMenu
                      sinheritDescription
                      false
                      sth_createIndex
                      false
                      sth_registMyChilds
                      false
                      sth_registDisabled
                      false
                      sth_fileMonitor
                      false
                      sth_mark
                      false
                      sid
                      Menu
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@seperate2
            sname
            seperate2
            stype
            SEPARATOR
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_fileMonitor
            false
            sth_mark
            false
            sid
            seperate2
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@debugEditToolItem
            sname
            debugEditToolItem
            stype
            PUSH
            simage
            debugEditImage
            stoolTiptext
            编辑调试信息
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            debugEditToolItem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@debugEditToolItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@debugEditToolItem/@listeners/@debugEditToolItemSelection
                sname
                debugEditToolItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_mark
                false
                sid
                debugEditToolItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@debugEditToolItem/@listeners/@debugEditToolItemSelection/@openComposite
                  sname
                  openComposite
                  stitle
                  调试信息
                  scompositePath
                  xworker.ide.worldexplorer.swt.actions.DebugInfoEditor/@mainComposite
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_mark
                  false
                  sid
                  openComposite
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@specator3
            sname
            specator3
            stype
            SEPARATOR
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            specator3
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@functionToolitem
            sname
            functionToolitem
            stype
            PUSH
            simage
            functionImage
            stoolTiptext
            函数交互式编程
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            functionToolitem
              @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@functionToolitem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@functionToolitem/@listeners/@functionToolitemSelection
                sname
                functionToolitemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_mark
                false
                sid
                functionToolitemSelection
                  @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@functionToolitem/@listeners/@functionToolitemSelection/@run
                  sname
                  run
                  stitle
                  交互函数
                  scompositePath
                  xworker.ui.function.RunctionRunnerShell/@mainComposite
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_mark
                  false
                  sid
                  run
            @/@shell1/@mainComposite/@mainCoolBar/@mainCollItem/@mainToolBar/@projectTreeUI
            sname
            mainToolbarUI
            slabel
            主工具栏
            scommandIndex
            xworker.ide.worldexplorer.swt.help.commander.MainToolbar
            sen_label
            Main Toolbar
            sen_group
            Thing Explorer
            sdescriptors
            xworker.swt.Widgets/@InteractiveUI
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sgroup
            事物管理器
            sth_mark
            false
            sid
            projectTreeUI
      @/@shell1/@mainComposite/@mainCoolBar1
      sname
      rightCoolBar
      stype
      HORIZONTAL
      sBORDER
      false
      sFLAT
      true
      sH_SCROLL
      false
      sV_SCROLL
      false
      sNO_BACKGROUND
      false
      sNO_FOCUS
      false
      sNO_MERGE_PAINTS
      false
      sNO_REDRAW_RESIZE
      false
      sNO_RADIO_GROUP
      false
      sEMBEDDED
      false
      sDOUBLE_BUFFERED
      false
      scapture
      false
      senabled
      true
      sredraw
      true
      svisible
      true
      sdescriptors
      xworker.swt.Widgets/@CoolBar
      sid
      mainCoolBar1
        @/@shell1/@mainComposite/@mainCoolBar1/@mainCoolBarGridData
        sname
        mainCoolBarGridData
        sstyle
        FILL_HORIZONTAL
        shorizontalIndent
        0
        swidth
        300
        sheight
        -1
        shorizontalAlignment
        END
        sverticalAlignment
        CENTER
        shorizontalSpan
        1
        sverticalSpan
        1
        sgrabExcessHorizontalSpace
        false
        sgrabExcessVerticalSpace
        false
        slabel
        mainCoolBarGridData
        sdescriptors
        xworker.swt.Commons/@GridData
        sid
        mainCoolBarGridData
        @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem
        sname
        mainCollItem
        sDROP_DOWN
        false
        slabel
        mainCollItem
        sdescriptors
        xworker.swt.widgets.CoolBar/@CoolItem
        sid
        mainCollItem
          @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar
          sname
          rightMainToolBar
          stype
          HORIZONTAL
          sFLAT
          true
          sWRAP
          false
          sBORDER
          false
          sSHADOW_OUT
          false
          sRIGHT
          true
          slabel
          rightMainToolBar
          sdescriptors
          xworker.swt.widgets.CoolBar/@CoolItem/@ToolBar
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_mark
          false
          sid
          mainToolBar
            @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@commandAssistorItem
            sname
            commandAssistorItem
            stype
            PUSH
            simage
            guideImage
            stext
            label:xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@resources/@I18nResource/@helpSpriteButton
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            commandAssistorItem
              @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@commandAssistorItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@commandAssistorItem/@listeners/@openCommander
                sname
                openCommander
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_registDisabled
                false
                sth_mark
                false
                sid
                openCommander
                  @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@commandAssistorItem/@listeners/@openCommander/@openAssistor
                  sname
                  openAssistor
                  sexpression
                  @xworker.command.CommandAssistor@open()
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.lang.actions.Actions/@Ongl
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  openAssistor
            @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@systemMessageItem
            sname
            systemMessageItem
            stype
            PUSH
            simage
            messageImage
            stext
            label:xworker.ide.worldexplorer.swt.i18n.I18nResource/@SystemInfo/@systemMessageItem
            senabled
            true
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            systemMessageItem
              @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@systemMessageItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              listeners
                @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@systemMessageItem/@listeners/@systemMessageItemSelection
                sname
                systemMessageItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_registDisabled
                false
                sth_mark
                false
                sid
                systemMessageItemSelection
                  @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@systemMessageItem/@listeners/@systemMessageItemSelection/@openComposite
                  sname
                  openComposite
                  stitle
                  系统通知
                  scompositePath
                  xworker.notification.NotificationManager/@mainSashForm
                  ssync
                  false
                  sinterpretationType
                  Self
                  sattributeTemplate
                  false
                  schildsAttributeTemplate
                  false
                  svarScope
                  Local
                  sisSynchronized
                  false
                  sthrowException
                  true
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdisableGlobalContext
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.ide.worldexplorer.actions.ExplorerActions/@openComposite
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  openComposite
            @/@shell1/@mainComposite/@mainCoolBar1/@mainCollItem/@mainToolBar/@projectTreeUI
            sname
            projectTreeUI
            slabel
            帮助小精灵
            sregistThing
            xworker.command.CommandAssistorIndex
            sregistType
            child
            sen_label
            Help Sprite
            sen_group
            Thing Explorer
            sdescriptors
            xworker.swt.Widgets/@InteractiveUI
            sinheritDescription
            false
            sth_createIndex
            true
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sgroup
            事物管理器
            sth_mark
            false
            sid
            projectTreeUI
      @/@shell1/@mainComposite/@topSash
      sname
      topSash
      sstyle
      VERTICAL
      sSMOOTH
      false
      sweights
      80,20
      slabel
      topSash
      sdescriptors
      xworker.swt.Widgets/@SashForm
      sid
      topSash
        @/@shell1/@mainComposite/@topSash/@topSashGridData
        sname
        topSashGridData
        sstyle
        FILL_BOTH
        shorizontalIndent
        0
        swidth
        -1
        sheight
        -1
        shorizontalAlignment
        BEGINNING
        sverticalAlignment
        CENTER
        shorizontalSpan
        2
        sverticalSpan
        1
        sgrabExcessHorizontalSpace
        false
        sgrabExcessVerticalSpace
        false
        slabel
        topSashGridData
        sdescriptors
        xworker.swt.Commons/@GridData
        sid
        topSashGridData
        @/@shell1/@mainComposite/@topSash/@mainSash
        sname
        mainSash
        sstyle
        HORIZONTAL
        sSMOOTH
        false
        sweights
        20,60,20
        slabel
        mainSash
        sdescriptors
        xworker.swt.Widgets/@SashForm
        sid
        mainSash
          @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash
          sname
          leftSash
          sstyle
          HORIZONTAL
          sSMOOTH
          false
          slabel
          leftSash
          sdescriptors
          xworker.swt.Widgets/@SashForm
          sid
          leftSash
            @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder
            sname
            leftTabFolder
            sstyle
            TOP
            sBORDER
            true
            sFLAT
            false
            sCLOSE
            false
            sSINGLE
            false
            sMRUVisible
            false
            ssimple
            false
            sdisposeControlOnItemClosed
            true
            suseItemTopRightControl
            true
            sH_SCROLL
            false
            sV_SCROLL
            false
            sNO_BACKGROUND
            false
            sNO_FOCUS
            false
            sNO_MERGE_PAINTS
            false
            sNO_REDRAW_RESIZE
            false
            sNO_RADIO_GROUP
            false
            sEMBEDDED
            false
            sDOUBLE_BUFFERED
            false
            slabel
            leftTabFolder
            scapture
            false
            senabled
            true
            sredraw
            true
            spack
            false
            svisible
            true
            sdescriptors
            xworker.swt.Widgets/@CTabFolder
            sid
            leftCTablFolder
              @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab
              sname
              projectTreeTab
              stext
              res:res.w_exp:projectNavTree:项目导航
              sCLOSE
              false
              simage
              projectNavImage
              slabel
              projectTreeTab
              sdescriptors
              xworker.swt.custom.CTabFolder/@CTabItem
              sid
              projectTreeTab
                @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree
                sname
                projectTree
                sselectStyle
                SINGLE
                sV_SCROLL
                true
                sH_SCROLL
                true
                sCHECK
                false
                sFULL_SELECTION
                false
                sHIDE_SELECTION
                false
                sBORDER
                false
                slineVisible
                false
                smultipleColumns
                false
                sheaderVisible
                false
                ssortIndicator
                false
                smoveableColumns
                false
                sheadImages
                false
                ssubImages
                false
                slabel
                projectTree
                sdescriptors
                xworker.swt.Widgets/@Tree
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_mark
                false
                sid
                projectTree
                  @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@Resource
                  sname
                  resources
                  slabel
                  resources
                  sdescriptors
                  xworker.swt.Widgets/@Resource
                  sid
                  Resource
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@Resource/@projectImage
                    sname
                    projectImage
                    slabel
                    projectImage
                    stype
                    Image
                    simageFile
                    /xworker/ide/images/project.gif
                    sdescriptors
                    xworker.swt.util.Resource/@Image
                    sid
                    projectImage
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@Resource/@project1
                    sname
                    project1Image
                    slabel
                    project1Image
                    stype
                    Image
                    simageFile
                    /xworker/ide/images/project1.gif
                    sdescriptors
                    xworker.swt.util.Resource/@Image
                    sid
                    project1
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@Resource/@factoryImage
                    sname
                    factoryImage
                    slabel
                    factoryImage
                    stype
                    Image
                    simageFile
                    /xworker/ide/images/factory.gif
                    sdescriptors
                    xworker.swt.util.Resource/@Image
                    sid
                    factoryImage
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@Resource/@packageIamge
                    sname
                    packageImage
                    slabel
                    packageImage
                    stype
                    Image
                    simageFile
                    /xworker/ide/images/package.gif
                    sdescriptors
                    xworker.swt.util.Resource/@Image
                    sid
                    packageIamge
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@Resource/@dataObjectImage
                    sname
                    dataObjectImage
                    slabel
                    dataObjectImage
                    stype
                    Image
                    simageFile
                    /xworker/ide/images/dataObject.gif
                    sdescriptors
                    xworker.swt.util.Resource/@Image
                    sid
                    dataObjectImage
                  @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners
                  sname
                  listeners
                  slabel
                  listeners
                  sdescriptors
                  xworker.swt.events.Listeners/@listeners
                  sid
                  listeners
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeMenudetect
                    sname
                    projectTreeMenudetect
                    stype
                    MenuDetect
                    slabel
                    projectTreeMenudetect
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sid
                    projectTreeMenudetect
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeMenudetect/@ProjectTreeMenuDetect
                      sname
                      ProjectTreeMenuDetect
                      slabel
                      ProjectTreeMenuDetect
                      sisSynchronized
                      false
                      sthrowException
                      false
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
import org.xmeta.Thing;
import org.xmeta.ActionContext;

for(item in projectTreeMenu.getItems()){
    item.dispose();
}

//设置弹出菜单的变量
def treeItem = projectTree.getSelection()[0];

def data = treeItem.getData();
//log.info(data.type);
String menuPath = "";
switch(data.type){
    case "world":  
    case "workingSet": 
        menuPath = "xworker.ide.worldexplorer.swt.dataExplorerParts.ProjectTreeMenu/@shell/@projectComposite/@projectMenu";
        break;
    case "plugins":
    case "projects":
    case "virtuals":
        menuPath = "xworker.ide.worldexplorer.swt.dataExplorerParts.ProjectTreeMenu/@shell/@dataCenterComposite/@dataCenterMenu";
        break;
    case "thingManager":
        menuPath = "xworker.ide.worldexplorer.swt.dataExplorerParts.ProjectTreeMenu/@shell/@cactoryComposite/@facotyMenu";
        break;
    case "category":
        menuPath = "xworker.ide.worldexplorer.swt.dataExplorerParts.ProjectTreeMenu/@shell/@packageComposite/@packageMenu";
        break;
    case "thing":
        menuPath = "xworker.ide.worldexplorer.swt.dataExplorerParts.ProjectTreeMenu/@shell/@dataObjectComposite/@dataObjectMenuItem";
        break;
}

ActionContext newContext = new ActionContext();
newContext.put("parent", projectTreeMenu);
newContext.put("explorerActions", actions);
newContext.put("explorerActionContext", actionContext);
newContext.put("treeItem", treeItem);
newContext.put("projectTree", projectTree);

Thing menuObj = world.getThing(menuPath);
if(menuObj != null){
    for(child in menuObj.childs){
        if(child.name == "versionMenu"){
            continue;
        }
        child.doAction("create", newContext);
    }
}

projectTreeMenu.setData("menuContext", newContext);
return newContext;
#$@text#$@
                      sinterpretationType
                      Action
                      screateLocalVarScope
                      false
                      ssaveReturn
                      false
                      sdebugLog
                      false
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      ProjectTreeMenuDetect
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeSelection
                    sname
                    projectTreeSelection
                    stype
                    Selection
                    slabel
                    projectTreeSelection
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sid
                    projectTreeSelection
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeSelection/@GroovyAction
                      sname
                      GroovyAction
                      slabel
                      GroovyAction
                      sisSynchronized
                      false
                      sthrowException
                      false
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
import xworker.ide.assistor.Assistor;

import xworker.ide.worldexplorer.actions.ProjectTreeActions;

ProjectTreeActions.setSelectedIndex(projectTree.getSelection()[0].getData());

//println(projectTree.getSelection()[0].getData().getPath());
actions.doAction("openPackageViewer", ["index":projectTree.getSelection()[0].getData(), "projectTree":projectTree]);
actions.doAction("expandProjectTreeItem");

//通知辅助者触发事件
Assistor.projectTreeSelected(projectTree.getSelection()[0], projectTree.getSelection()[0].getData());
#$@text#$@
                      sinterpretationType
                      Action
                      screateLocalVarScope
                      false
                      ssaveReturn
                      false
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      GroovyAction
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeExpand
                    sname
                    projectTreeExpand
                    stype
                    Expand
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sinheritDescription
                    false
                    sth_createIndex
                    false
                    sth_registMyChilds
                    false
                    sth_mark
                    false
                    sid
                    projectTreeExpand
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeExpand/@JavaAction
                      sname
                      JavaAction
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      suseOuterJava
                      true
                      suseInnerJava
                      false
                      souterClassName
                      xworker.ide.worldexplorer.actions.ProjectTreeActions
                      smethodName
                      projectTreeExpand
                      sdisableGlobalContext
                      false
                      sattributeTemplate
                      false
                      sinterpretationType
                      Action
                      svarScope
                      Global
                      screateLocalVarScope
                      false
                      ssaveReturn
                      false
                      sdebugLog
                      false
                      sdescriptors
                      xworker.lang.actions.Actions/@JavaAction
                      sinheritDescription
                      false
                      sth_createIndex
                      false
                      sth_registMyChilds
                      false
                      sth_mark
                      false
                      sid
                      JavaAction
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeCollapse
                    sname
                    projectTreeCollapse
                    stype
                    Collapse
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sinheritDescription
                    false
                    sth_createIndex
                    false
                    sth_registMyChilds
                    false
                    sth_mark
                    false
                    sid
                    projectTreeCollapse
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@listeners/@projectTreeCollapse/@JavaAction
                      sname
                      JavaAction
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      suseOuterJava
                      true
                      suseInnerJava
                      false
                      souterClassName
                      xworker.ide.worldexplorer.actions.ProjectTreeActions
                      smethodName
                      projectTreeCollapse
                      sdisableGlobalContext
                      false
                      sattributeTemplate
                      false
                      sinterpretationType
                      Action
                      svarScope
                      Global
                      screateLocalVarScope
                      false
                      ssaveReturn
                      false
                      sdebugLog
                      false
                      sdescriptors
                      xworker.lang.actions.Actions/@JavaAction
                      sinheritDescription
                      false
                      sth_createIndex
                      false
                      sth_registMyChilds
                      false
                      sth_mark
                      false
                      sid
                      JavaAction
                  @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeMenu
                  sname
                  projectTreeMenu
                  sstyle
                  DROP_DOWN
                  sNO_RADIO_GROUP
                  false
                  salign
                  LEFT_TO_RIGHT
                  svisible
                  true
                  senabled
                  true
                  slabel
                  projectTreeMenu
                  sdescriptors
                  xworker.swt.Commons/@Menu
                  sid
                  projectTreeMenu
                  @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDragSource
                  sname
                  projectTreeDragSource
                  sDROP_NONE
                  false
                  sDROP_COPY
                  true
                  sDROP_MOVE
                  true
                  sDROP_LINK
                  true
                  sdescriptors
                  xworker.swt.widgets.Control/@DragSource
                  sid
                  projectTreeDragSource
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDragSource/@prjTxtTransfer
                    sname
                    prjTxtTransfer
                    stype
                    Text
                    sdescriptors
                    xworker.swt.dnd.DragSource/@Transfer
                    sid
                    prjTxtTransfer
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDragSource/@prjTreeDragStrat
                    sname
                    prjTreeDragStrat
                    stype
                    DragStart
                    sdescriptors
                    xworker.swt.dnd.DragSource/@Listener
                    sid
                    prjTreeDragStrat
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDragSource/@prjTreeDragStrat/@run
                      sname
                      run
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
import org.xmeta.Index;

def selection = projectTree.getSelection();
if (selection.length > 0) {
    def item = selection[0];
    if(item.getData().type != Index.TYPE_CATEGORY){
        event.doit = false;
    }else{
        event.doit = true;
    }
} else {
    event.doit = false;
}
#$@text#$@
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      run
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDragSource/@prjTreeSetData
                    sname
                    prjTreeSetData
                    stype
                    DragSetData
                    sdescriptors
                    xworker.swt.dnd.DragSource/@Listener
                    sid
                    prjTreeSetData
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDragSource/@prjTreeSetData/@run
                      sname
                      run
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
def item = projectTree.getSelection()[0];
def index = item.getData();
event.data = index.indexObject.thingManager.getName() + ":" + item.getData().getPath();
#$@text#$@
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      run
                  @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget
                  sname
                  projectTreeDrogTarget
                  sDROP_NONE
                  false
                  sDROP_COPY
                  true
                  sDROP_MOVE
                  true
                  sDROP_LINK
                  true
                  sdescriptors
                  xworker.swt.widgets.Control/@DropTarget
                  sid
                  projectTreeDrogTarget
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget/@prjTTextTransfer
                    sname
                    prjTTextTransfer
                    stype
                    Text
                    sdescriptors
                    xworker.swt.dnd.DropTarget/@Transfer
                    sid
                    prjTTextTransfer
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget/@prjTreeDragOver
                    sname
                    prjTreeDragOver
                    stype
                    DragOver
                    sdescriptors
                    xworker.swt.dnd.DropTarget/@Listener
                    sid
                    prjTreeDragOver
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget/@prjTreeDragOver/@run
                      sname
                      run
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
import org.eclipse.swt.dnd.DND;
import org.xmeta.Index;

event.feedback = DND.FEEDBACK_EXPAND | DND.FEEDBACK_SCROLL | DND.FEEDBACK_SELECT;;
if(event.item != null){
    //如果没有展开的节点，展开
    //actions.doAction("expandProjectTreeItem", ["itemForExpand":event.item]);
    
    if(event.item.getData().type == Index.TYPE_CATEGORY || event.item.getData().type == Index.TYPE_THINGMANAGER){
        event.detail = DND.DROP_MOVE;
    }else{
        event.detail = DND.DROP_NONE;
    }
}
#$@text#$@
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      run
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget/@prjTreeDrop
                    sname
                    prjTreeDrop
                    stype
                    Drop
                    sdescriptors
                    xworker.swt.dnd.DropTarget/@Listener
                    sid
                    prjTreeDrop
                      @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget/@prjTreeDrop/@run
                      sname
                      run
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
import org.eclipse.swt.SWT;

import org.xmeta.ActionContext;
import org.xmeta.ThingManager;

if(event.item != null){
    def srcPath = event.data;
    def srcName = srcPath;
    if(srcPath.lastIndexOf(".") != -1){
        srcName = srcPath.substring(srcPath.lastIndexOf(".") + 1);
    }else{
        srcName = srcPath.substring(srcPath.lastIndexOf(":") + 1);
    }
    def targetIndexObject = event.item.getData().getIndexObject();
    def targetCategory = targetIndexObject;
    if(targetIndexObject instanceof ThingManager){
        targetCategory = targetIndexObject.getCategory(null);
    }
    
    def targPath = targetCategory.getThingManager().getName() + ":" ;
    if(targetCategory.name == null || targetCategory.name == ""){
        targPath = targPath + srcName;
    }else{
        targPath = targPath + targetCategory.name + "." + srcName;
    }
    
    def ac = new ActionContext();
    ac.put("parent", shell);
    ac.put("srcPath", srcPath);
    ac.put("targPath", targPath);
    ac.put("sourceTreeItem", projectTree.getSelection()[0]);
    
    def shellThing = world.get("xworker.ide.worldexplorer.swt.dialogs.ThingRefactorDialog/@shell");
    def shell = shellThing.doAction("create", ac);
    shell.open();
    
    def display = shell.display;
    while (!shell.isDisposed()) {
        if (!display.readAndDispatch()) display.sleep();
    }
    
    if(ac.get("executed") == "true"){
        //如果原始目录已移除，那么删除项目树中间的节点        
        if(world.get(srcPath) == null && srcPath == projectTree.getSelection()[0].getData().path){
            projectTree.getSelection()[0].dispose();
        }
        projectTree.setSelection(event.item);
        
        actions.doAction("refreshProjectTree");
    }
}
#$@text#$@
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      run
                    @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeDrogTarget/@prjTreeTargetEffect
                    sname
                    prjTreeTargetEffect
                    stype
                    TreeDropTargetEffect
                    sdescriptors
                    xworker.swt.dnd.DropTarget/@DragSourceEffect
                    sid
                    prjTreeTargetEffect
                  @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@projectTreeTab/@projectTree/@projectTreeUI
                  sname
                  projectTreeUI
                  slabel
                  项目树
                  scommandIndex
                  xworker.ide.worldexplorer.swt.help.commander.ProjectTree
                  sen_label
                  Project Tree
                  sen_group
                  Thing Explorer
                  sdescriptors
                  xworker.swt.Widgets/@InteractiveUI
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sgroup
                  事物管理器
                  sth_mark
                  false
                  sid
                  projectTreeUI
              @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell1/@mainComposite/@topSash/@mainSash/@leftSash/@leftCTablFolder/@listeners/@leftTabFolderMouseDoubleClick
                sname
                leftTabFolderMouseDoubleClick
                stype
                MouseDoubleClick
                sref
                mainTabFolderMouseDoubleClick
                slabel
                leftTabFolderMouseDoubleClick
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                leftTabFolderMouseDoubleClick
          @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite
          sname
          contentComposite
          sBORDER
          false
          sH_SCROLL
          false
          sV_SCROLL
          false
          sNO_BACKGROUND
          false
          sNO_FOCUS
          false
          sNO_MERGE_PAINTS
          false
          sNO_REDRAW_RESIZE
          false
          sNO_RADIO_GROUP
          false
          sEMBEDDED
          false
          sDOUBLE_BUFFERED
          false
          slabel
          contentComposite
          scapture
          false
          senabled
          true
          sredraw
          true
          svisible
          true
          sdescriptors
          xworker.swt.Widgets/@Composite
          sid
          contentComposite
            @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@contentCompoisteFillLayout
            sname
            contentCompoisteFillLayout
            stype
            SWT.HORIZONTAL
            slabel
            contentCompoisteFillLayout
            sdescriptors
            xworker.swt.Layouts/@FillLayout
            sid
            contentCompoisteFillLayout
            @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder
            sname
            centerTabFolder
            sstyle
            TOP
            sBORDER
            true
            sFLAT
            false
            sCLOSE
            true
            sSINGLE
            false
            sMRUVisible
            false
            ssimple
            false
            sdisposeControlOnItemClosed
            false
            sH_SCROLL
            false
            sV_SCROLL
            false
            sNO_BACKGROUND
            false
            sNO_FOCUS
            false
            sNO_MERGE_PAINTS
            false
            sNO_REDRAW_RESIZE
            false
            sNO_RADIO_GROUP
            false
            sEMBEDDED
            false
            sDOUBLE_BUFFERED
            false
            slabel
            centerTabFolder
            scapture
            false
            senabled
            true
            sredraw
            true
            svisible
            true
            sdescriptors
            xworker.swt.Widgets/@CTabFolder
            sid
            centerTabFolder
              @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@listeners/@mainTabSelection
                sname
                mainTabSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_registDisabled
                false
                sth_mark
                false
                sid
                mainTabSelection
                  @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@listeners/@mainTabSelection/@GroovyAction
                  sname
                  GroovyAction
                  sisSynchronized
                  false
                  sthrowException
                  false
                  suseOtherAction
                  false
                  svarScope
                  Global
                  sdisableGlobalContext
                  false
                  Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

import xworker.ide.assistor.Assistor;

import xworker.ide.assistor.guide.actions.SelectProjectTree;

//上次的事物编辑器
def lastThingEditor = centerTabFolder.getData("currentThingEditor");
//println("mainTabSelection=" + lastThingEditor);
if(lastThingEditor != null){
    lastThingEditor.doAction("editorMainTabFocusouted");
    centerTabFolder.setData("currentThingEditor", null);
}

def outlineTree = event.item.getData("outlineTree");
if(outlineTree == null){
    outlineStackLayout.topControl = blankTree;
    outlineComposite.layout();
}else{
    outlineStackLayout.topControl = outlineTree;
    outlineComposite.layout();
    
    //通知辅助者选中了一个事物编辑器
    def thingEditorActions = event.item.getData("scripts");
    def thingEditorActionContext = event.item.getData("actionContext");
    if(thingEditorActions != null && thingEditorActionContext != null){
        Assistor.thingEditorSelected(event.item, thingEditorActionContext, thingEditorActions);        
        
        def isXmlEditor = thingEditorActions.doAction("isXmlEditor");
        //println("isXmlEditor=" + isXmlEditor);
        def editorCommandDomain =  null;
        if(isXmlEditor){
            editorCommandDomain = world.getThing("xworker.ide.worldexplorer.swt.command.XmlEditorCommandDomain");
        }else{
            editorCommandDomain = world.getThing("xworker.ide.worldexplorer.swt.command.ThingEditorCommandDomain");
        }
        
        Assistor.setCommandDomain(editorCommandDomain, thingEditorActionContext);
        
        //保存当前的模型编辑器
        centerTabFolder.setData("currentThingEditor", thingEditorActions);
        thingEditorActions.doAction("editorMainTabFocused");
    }
    
    def thing =  event.item.getData("thing");
    if(thing != null){
        SelectProjectTree.selectProject("thing", thing.getMetadata().getPath());
    }
}

return;

def selectThingManager(projectTree, thingManager){

}

//Tab上的事物路径，如果有，那么项目树选中该事物节点
def thingPath = event.item.getData("thingPath");
if(thingPath != null){
    String[] tps = thingPath.split("[:]");
    def project = world.getProject(tps[0]);
    if(project == null){
        return;
    }
    def thingManager = project.getThingManager(tps[1]);
    if(thingManager == null){
        return;
    }
    def thing = thingManager.getThing(tps[2]);
    if(thing == null){
        return;
    }
    
    def currentTreeItem = null;
    for(item in projectTree.getItems()){
        if(project.isPlugIn() && item.getData().getName() == "plug-ins"){
             currentTreeItem = item;
             break;
        }else if(!project.isPlugIn() && item.getData().getName() == "projects"){
             currentTreeItem = item;    
             break;
        }
    } 
    
    if(currentTreeItem == null) return;
    
    projectTree.setSelection(currentTreeItem);
    for(item in currentTreeItem.getItems()){
        if(item.getData().getName() == project.getName()){
             currentTreeItem = item;
             projectTree.setSelection(currentTreeItem);
             break;
        }    
    }
    
    if(currentTreeItem == null) return;
    projectTree.setSelection(currentTreeItem);
    for(item in currentTreeItem.getItems()){
        if(item.getData().getName() == thingManager.getName()){
             currentTreeItem = item;
             projectTree.setSelection(currentTreeItem);
             break;
        }    
    }
    
    String categoryName = thing.getMetadata().getCategory().getName();
    if(categoryName != null && categoryName != ""){
        String[] cs = categoryName.split("[.]");
        for(c in cs){
            def temItem = null;
            if(currentTreeItem.getItems() == 0){
                actions.doAction("expandProjectTreeItem");
            }
            for(item in currentTreeItem.getItems()){
                if(item.getData().getName() == c && item.getData().getType() == "category"){
                    temItem = item;
                    projectTree.setSelection(temItem);
                    break;
                }    
            }
            
            if(temItem == null){
                def treeItem = new TreeItem(projectTree, SWT.NONE);
                return;
            }else{
                currentTreeItem = temItem;
            }
        }
    }
}
#$@text#$@
                  sinterpretationType
                  Action
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.lang.actions.Actions/@GroovyAction
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  GroovyAction
                @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@listeners/@mainTabFolderMouseDoubleClick
                sname
                mainTabFolderMouseDoubleClick
                stype
                MouseDoubleClick
                slabel
                mainTabFolderMouseDoubleClick
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                mainTabFolderMouseDoubleClick
                  @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@listeners/@mainTabFolderMouseDoubleClick/@GroovyAction
                  sname
                  GroovyAction
                  slabel
                  GroovyAction
                  sisSynchronized
                  false
                  sthrowException
                  false
                  suseOtherAction
                  false
                  svarScope
                  Global
                  sdisableGlobalContext
                  false
                  Scode
#$@text#$@
def tabFolder = event.widget;

//如果是鼠标中键什么也不做
if(event.button == 2) return;

/*
switch(tabFolder){
    case leftTabFolder:
        if(tabFolder.getData("maxStatus") == "max"){
            def oldLeftSashWeights = leftSash.getData("oldWeights");
            leftSash.setWeights(oldLeftSashWeights);
        }else{
            def oldLeftSashWeights = leftSash.getWeights();
            leftSash.setData("oldWeights", oldLeftSashWeights);
            leftSash.setWeights([100] as int[]);
        }
        break;
        
    case rightTopTabFolder:
        if(tabFolder.getData("maxStatus") == "max"){
            def oldSashWeights = mainSash.getData("oldWeights");
            mainSash.setWeights(oldSashWeights);
        }else{
            def oldSashWeights = mainSash.getWeights();
            mainSash.setData("oldWeights", oldSashWeights);
            mainSash.setWeights([0,0, 100] as int[]);
        }
        break;
    case centerTabFolder:
        if(tabFolder.getData("maxStatus") == "max"){
            def oldSashWeights = mainSash.getData("oldWeights");
            mainSash.setWeights(oldSashWeights);
            println(oldSashWeights);
        }else{
            def oldSashWeights = mainSash.getWeights();
            mainSash.setData("oldWeights", oldSashWeights);
            println(oldSashWeights);
            mainSash.setWeights([0, 100, 0] as int[]);
        }
        break;
}*/

if(tabFolder.getData("maxStatus") == "max"){
    def oldWeights = mainSash.getData("oldWeights");
    mainSash.setWeights(oldWeights);
    
    def topWeights = topSash.getData("oldWeigths");
    if(topWeights != null){
        topSash.setWeights(topWeights);
    }
    tabFolder.setData("maxStatus", "normal");
}else{
    def topWeights = topSash.getWeights();
    topSash.setData("oldWeigths", topWeights);
    topSash.setWeights([100, 0] as int[]);
    
    def oldWeights = mainSash.getWeights();
    mainSash.setData("oldWeights", oldWeights);
    switch(tabFolder){
        case leftTabFolder:
            mainSash.setWeights([100, 0, 0] as int[]);
            break;
        case centerTabFolder:
            mainSash.setWeights([0, oldWeights[1], oldWeights[2]] as int[]);
            break;
        case rightTopTabFolder:
            mainSash.setWeights([0, 0, 100] as int[]);
            break;
    }
    tabFolder.setData("maxStatus", "max");
}
#$@text#$@
                  sinterpretationType
                  Action
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.lang.actions.Actions/@GroovyAction
                  sid
                  GroovyAction
              @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu
              sname
              centerTabFolderMenu
              sstyle
              POP_UP
              sNO_RADIO_GROUP
              false
              salign
              LEFT_TO_RIGHT
              slabel
              centerTabFolderMenu
              sdescriptors
              xworker.swt.Widgets/@Menu
              sid
              centerTabFolderMenu
                @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeSelfItem
                sname
                cn_closeSelfItem
                stext
                res:res.w_exp:centerTabClose:关闭
                sstyle
                PUSH
                sselected
                false
                senabled
                true
                slabel
                cn_closeSelfItem
                sdescriptors
                xworker.swt.widgets.Menu/@MenuItem
                sid
                cn_closeSelfItem
                  @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeSelfItem/@listeners
                  sname
                  listeners
                  slabel
                  listeners
                  sdescriptors
                  xworker.swt.events.Listeners/@listeners
                  sid
                  listeners
                    @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeSelfItem/@listeners/@cnTabMenuSelection
                    sname
                    cnTabMenuSelection
                    stype
                    Selection
                    slabel
                    cnTabMenuSelection
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sid
                    cnTabMenuSelection
                      @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeSelfItem/@listeners/@cnTabMenuSelection/@GroovyAction
                      sname
                      GroovyAction
                      sisSynchronized
                      false
                      sthrowException
                      true
                      suseOtherAction
                      false
                      svarScope
                      Global
                      sdisableGlobalContext
                      false
                      Scode
#$@text#$@
def currentItem = centerTabFolder.getSelection();
if(event.widget == cn_closeSelfItem){
    closeItem(currentItem);
}else if(event.widget == cn_closeOtherItem){
    closeOthers(centerTabFolder, currentItem);
}else if(event.widget == cnCloseAllItem){
    closeOthers(centerTabFolder, currentItem);
    closeItem(currentItem);
}

def closeOthers(centerTabFolder, item){
    for(it in centerTabFolder.getItems()){
        if(it != item){            
            closeItem(it);
        }
    }
}

def closeItem(item){
    if(item == null){
        return;
    }
    
    disposeItem(item);
    
    item.dispose();
}

def disposeItem(item){
    //销毁CtabItem相关的内容
    if(item.getControl() != null){
        try{
            item.getControl().dispose();
        }catch(Exception e){
        }
    }
    def outlineTree = item.getData("outlineTree");
    def childComposite = item.getData("childComposite");
    
    if(outlineTree != null){
        try{
             outlineTree.dispose();
        }catch(Exception e){
            e.printStackTrace();
        }
    }
    if(childComposite != null){
        try{
             childComposite.dispose();
        }catch(Exception e){
            e.printStackTrace();
        }
    }
    //item.dispose();   
}
#$@text#$@
                      sinterpretationType
                      Action
                      screateLocalVarScope
                      false
                      ssaveReturn
                      false
                      sdebugLog
                      false
                      sdescriptors
                      xworker.lang.actions.Actions/@GroovyAction
                      sid
                      GroovyAction
                @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeOtherItem
                sname
                cn_closeOtherItem
                stext
                res:res.w_exp:centerTabCloseOther:关闭其他
                sstyle
                PUSH
                sselected
                false
                senabled
                true
                slabel
                cn_closeOtherItem
                sdescriptors
                xworker.swt.widgets.Menu/@MenuItem
                sid
                cn_closeOtherItem
                  @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeOtherItem/@listeners
                  sname
                  listeners
                  slabel
                  listeners
                  sdescriptors
                  xworker.swt.events.Listeners/@listeners
                  sid
                  listeners
                    @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cn_closeOtherItem/@listeners/@cn_closeOteherSelectio
                    sname
                    cn_closeOteherSelectio
                    stype
                    Selection
                    sref
                    cnTabMenuSelection
                    slabel
                    cn_closeOteherSelectio
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sid
                    cn_closeOteherSelectio
                @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cnCloseAllItem
                sname
                cnCloseAllItem
                stext
                res:res.w_exp:centerTabCloseAll:关闭所有
                sstyle
                PUSH
                sselected
                false
                senabled
                true
                slabel
                cnCloseAllItem
                sdescriptors
                xworker.swt.widgets.Menu/@MenuItem
                sid
                cnCloseAllItem
                  @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cnCloseAllItem/@listeners
                  sname
                  listeners
                  slabel
                  listeners
                  sdescriptors
                  xworker.swt.events.Listeners/@listeners
                  sid
                  listeners
                    @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@centerTabFolderMenu/@cnCloseAllItem/@listeners/@cn_closeAllItemSelection
                    sname
                    cn_closeAllItemSelection
                    stype
                    Selection
                    sref
                    cnTabMenuSelection
                    slabel
                    cn_closeAllItemSelection
                    sdescriptors
                    xworker.swt.events.Listeners/@listeners/@Listener
                    sid
                    cn_closeAllItemSelection
              @/@shell1/@mainComposite/@topSash/@mainSash/@contentComposite/@centerTabFolder/@editorUI
              sname
              editorUI
              slabel
              工作区
              scommandIndex
              xworker.ide.worldexplorer.swt.help.commander.EditorTabFolder
              sen_label
              Working Area
              sen_group
              Thing Explorer
              sdescriptors
              xworker.swt.Widgets/@InteractiveUI
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sgroup
              事物管理器
              sth_mark
              false
              sid
              editorUI
          @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder
          sname
          rightTopTabFolder
          sstyle
          TOP
          sBORDER
          true
          sFLAT
          false
          sCLOSE
          false
          sSINGLE
          false
          sMRUVisible
          false
          ssimple
          false
          sdisposeControlOnItemClosed
          true
          suseItemTopRightControl
          true
          sH_SCROLL
          false
          sV_SCROLL
          false
          sNO_BACKGROUND
          false
          sNO_FOCUS
          false
          sNO_MERGE_PAINTS
          false
          sNO_REDRAW_RESIZE
          false
          sNO_RADIO_GROUP
          false
          sEMBEDDED
          false
          sDOUBLE_BUFFERED
          false
          slabel
          rightTopTabFolder
          scapture
          false
          senabled
          true
          sredraw
          true
          spack
          false
          svisible
          true
          sdescriptors
          xworker.swt.custom.CTabFolder
          sid
          rightTopTabFolder
            @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder/@outlineTab
            sname
            outlineTab
            stext
            res:res.w_exp:outlineNavTab:概要
            sCLOSE
            false
            simage
            outlineImage
            slabel
            outlineTab
            sdescriptors
            ,xworker.swt.custom.CTabFolder/@CTabItem
            sid
            outlineTab
              @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder/@outlineTab/@outlineComposite
              sname
              outlineComposite
              sBORDER
              false
              sH_SCROLL
              false
              sV_SCROLL
              false
              sNO_BACKGROUND
              false
              sNO_FOCUS
              false
              sNO_MERGE_PAINTS
              false
              sNO_REDRAW_RESIZE
              false
              sNO_RADIO_GROUP
              false
              sEMBEDDED
              false
              sDOUBLE_BUFFERED
              false
              slabel
              outlineComposite
              sdescriptors
              xworker.swt.Widgets/@Composite
              sid
              outlineComposite
                @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder/@outlineTab/@outlineComposite/@outlineStackLayout
                sname
                outlineStackLayout
                slabel
                outlineStackLayout
                sdescriptors
                xworker.swt.Layouts/@StackLayout
                sid
                outlineStackLayout
                @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder/@outlineTab/@outlineComposite/@blankTree
                sname
                blankTree
                sselectStyle
                SINGLE
                sV_SCROLL
                true
                sH_SCROLL
                true
                sCHECK
                false
                sFULL_SELECTION
                true
                sHIDE_SELECTION
                false
                sBORDER
                false
                slineVisible
                false
                smultipleColumns
                false
                sheaderVisible
                false
                ssortIndicator
                false
                smoveableColumns
                false
                sheadImages
                false
                ssubImages
                false
                slabel
                blankTree
                sdescriptors
                xworker.swt.Widgets/@Tree
                sid
                blankTree
            @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder/@listeners
            sname
            listeners
            slabel
            listeners
            sdescriptors
            xworker.swt.events.Listeners/@listeners
            sid
            listeners
              @/@shell1/@mainComposite/@topSash/@mainSash/@rightTopTabFolder/@listeners/@rightTopTabFolderMouseDoubleClcik
              sname
              rightTopTabFolderMouseDoubleClcik
              stype
              MouseDoubleClick
              sref
              mainTabFolderMouseDoubleClick
              slabel
              rightTopTabFolderMouseDoubleClcik
              sdescriptors
              xworker.swt.events.Listeners/@listeners/@Listener
              sid
              rightTopTabFolderMouseDoubleClcik
        @/@shell1/@mainComposite/@topSash/@bottomTabFolder
        sname
        bottomTabFolder
        sstyle
        TOP
        sBORDER
        true
        sFLAT
        false
        sCLOSE
        false
        sSINGLE
        false
        sMRUVisible
        false
        ssimple
        false
        sdisposeControlOnItemClosed
        true
        suseItemTopRightControl
        true
        sH_SCROLL
        false
        sV_SCROLL
        false
        sNO_BACKGROUND
        false
        sNO_FOCUS
        false
        sNO_MERGE_PAINTS
        false
        sNO_REDRAW_RESIZE
        false
        sNO_RADIO_GROUP
        false
        sEMBEDDED
        false
        sDOUBLE_BUFFERED
        false
        slabel
        bottomTabFolder
        scapture
        false
        senabled
        true
        sredraw
        true
        spack
        false
        svisible
        true
        sdescriptors
        xworker.swt.Widgets/@CTabFolder
        sid
        bottomTabFolder
          @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@consoleTabItem
          sname
          consoleTabItem
          slabel
          consoleTabItem
          stext
          res:res.w_exp:consoleTab:控制台
          simage
          monitorImage
          scomponent
          xworker.swt.component.components.ProcessManager
          scomponentVarName
          console
          sdescriptors
          xworker.swt.custom.CTabFolder/@ComponentItem
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          consoleTabItem
          @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@progressTabItem
          sname
          progressTabItem
          stext
          label:xworker.ide.worldexplorer.swt.i18n.I18nResource/@explorerMain/@ProgressTabItem
          stoolTipText
          label:xworker.ide.worldexplorer.swt.i18n.I18nResource/@explorerMain/@progressToolTip
          sCLOSE
          false
          simage
          progressImage
          sdescriptors
          xworker.swt.custom.CTabFolder/@CTabItem
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          progressTabItem
            @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@progressTabItem/@ExtendWidget
            sname
            ExtendWidget
            sextendWidgetPath
            xworker.ide.task.UserTaskManagerTabItem/@progressComposite
            snewActionContext
            true
            snewActionContextName
            progressTabContext
            sdescriptors
            xworker.swt.Widgets/@ExtendWidget
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_mark
            false
            sid
            ExtendWidget
          @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@CTabItem
          sname
          learningTabItem
          stext
          label:xworker.ide.worldexplorer.swt.i18n.I18nResource/@explorerMain/@Learning
          stoolTipText
          神经网络
          sCLOSE
          false
          simage
          aiLearningImage
          sdescriptors
          xworker.swt.custom.CTabFolder/@CTabItem
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_mark
          false
          sid
          CTabItem
            @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@CTabItem/@ExtendWidget
            sname
            ExtendWidget
            sextendWidgetPath
            xworker.ai.neural.manager.NeuralLearningManager/@mainCimposite
            snewActionContext
            true
            sdescriptors
            xworker.swt.Widgets/@ExtendWidget
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            ExtendWidget
          @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@colorerTabItem
          sname
          colorerTabItem
          sCLOSE
          false
          sdescriptors
          xworker.swt.custom.CTabFolder/@CTabItem
          sth_createIndex
          false
          sth_mark
          false
          sid
          colorerTabItem
            @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@colorerTabItem/@colorComposite
            sname
            colorComposite
            sBORDER
            false
            sH_SCROLL
            false
            sV_SCROLL
            false
            sNO_BACKGROUND
            false
            sNO_FOCUS
            false
            sNO_MERGE_PAINTS
            false
            sNO_REDRAW_RESIZE
            false
            sNO_RADIO_GROUP
            false
            sEMBEDDED
            false
            sDOUBLE_BUFFERED
            false
            scapture
            false
            senabled
            true
            sredraw
            true
            svisible
            true
            sdescriptors
            xworker.swt.Widgets/@Composite
            sth_createIndex
            false
            sth_mark
            false
            sid
            colorComposite
              @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@colorerTabItem/@colorComposite/@colorerText
              sname
              colorerText
              scodeName
              java
              scodeType
              java
              sWRAP
              false
              sdescriptors
              xworker.swt.Widgets/@CodeEditor
              sth_createIndex
              false
              sth_mark
              false
              sid
              colorerText
              @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@colorerTabItem/@colorComposite/@colorerCompositeFillLayout
              sname
              colorerCompositeFillLayout
              stype
              SWT.HORIZONTAL
              sdescriptors
              xworker.swt.Layouts/@FillLayout
              sth_createIndex
              false
              sth_mark
              false
              sid
              colorerCompositeFillLayout
          @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@listeners
          sname
          listeners
          slabel
          listeners
          sdescriptors
          xworker.swt.events.Listeners/@listeners
          sid
          listeners
            @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@listeners/@bottomTabFolderMouseDoubleClick
            sname
            bottomTabFolderMouseDoubleClick
            stype
            MouseDoubleClick
            slabel
            bottomTabFolderMouseDoubleClick
            sdescriptors
            xworker.swt.events.Listeners/@listeners/@Listener
            sid
            bottomTabFolderMouseDoubleClick
              @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@listeners/@bottomTabFolderMouseDoubleClick/@GroovyAction
              sname
              GroovyAction
              slabel
              GroovyAction
              sisSynchronized
              false
              sthrowException
              false
              suseOtherAction
              false
              svarScope
              Global
              Scode
#$@text#$@
//如果是鼠标中键什么也不做
if(event.button == 2) return;

if(bottomTabFolder.getData("maxStatus") == "max"){
    def topWeights = topSash.getData("oldWeigths");
    if(topWeights != null){
        topSash.setWeights(topWeights);
    }
    bottomTabFolder.setData("maxStatus", "normal");
}else{
    def topWeights = topSash.getWeights();
    topSash.setData("oldWeigths", topWeights);
    topSash.setWeights([0, 100] as int[]);
    bottomTabFolder.setData("maxStatus", "max");
}
#$@text#$@
              sdescriptors
              xworker.lang.actions.Actions/@GroovyAction
              sid
              GroovyAction
          @/@shell1/@mainComposite/@topSash/@bottomTabFolder/@TopRight
          sname
          TopRight
          sstyle
          RIGHT
          sWRAP
          false
          sdescriptors
          xworker.swt.custom.CTabFolder/@TopRight
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_mark
          false
          sid
          TopRight
    @/@shell1/@scripts
    sname
    actions
    slabel
    actions
    sdescriptors
    xworker.swt.Widgets/@actions
    sid
    scripts
      @/@shell1/@scripts/@openDataObject
      sname
      openThing
      slabel
      openThing
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import groovy.lang.Binding;

import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import xworker.ui.swt.SwtBorder;
import xworker.swt.events.SwtListener;
import xworker.ui.editor.OutlineTreeDragAndDrop;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

import java.util.HashMap;
import xworker.ide.assistor.Assistor;

import xworker.ide.assistor.guide.actions.SelectProjectTree;

if(actionContext.get("thing") != null){    
    def currentObj = actionContext.get("thing");
    def thing = currentObj.getRoot();
    def path = thing.metadata.path;
    //log.info(path);
    def tab = null;
    for(item in centerTabFolder.items){
        if(item.getData("tabPath") == path){
            tab = item;
        }
    }
       
    def editorContext = null;
    def editorActions = null;
    if(tab == null){
        //Tab不存在，创建新的Tab
        tab = new CTabItem(centerTabFolder, SWT.NONE);
        tab.setText(thing.getMetadata().getLabel());
        tab.setToolTipText(thing.metadata.path);     
        tab.setData("path", path);  
        tab.setData("tabPath", path); 
        //编辑事物的背景流程
        tab.setData("backgroundFlow", "xworker.ide.worldexplorer.swt.flows.ThingEditorBackgroundFlow");
       
        //事物编辑器的概要、子事物、编辑事物等界面定义
        def treeThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@outlineBrowser");
        //def childThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@propertiesComposite");
        def contentThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@rightComposite");
        def scriptThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@actions");
                
        ActionContext newContext = new ActionContext();
        newContext.put("contentTab", tab);
        newContext.put("explorerActions", actions);
        newContext.put("explorerContext", actionContext);
        newContext.put("utilBrowser", utilBrowser);
        newContext.put("parent", outlineComposite);
        newContext.put("outlineComposite", outlineComposite);
        newContext.put("outlineStackLayout", outlineStackLayout);
        
        def scripts = scriptThing.doAction("create", newContext);
        
        def outlineTree = treeThing.doAction("create", newContext);
        //OutlineTreeDragAndDrop.attach(outlineTree, newContext);
        
        //newContext.put("parent", childsComposite);
        //def childComposite = childThing.doAction("create", newContext);
        
        newContext.put("parent", centerTabFolder);
        def contentComposite = contentThing.doAction("create", newContext);        
        
        tab.setControl(contentComposite);
        tab.setData("outlineTree", outlineTree);
        //tab.setData("childComposite", childComposite);
        tab.setData("scripts", scripts);
        tab.setData("actionContext", newContext);
        tab.setData("thingPath", thing.metadata.path);
        tab.setData("thing", thing);
        if(actionContext.get("thingImage") != null){
            tab.setImage(thingImage);
        }
        
        //显示Tab
        centerTabFolder.setSelection(tab);
        outlineStackLayout.topControl = outlineTree;
        outlineComposite.layout();
        //childsCompositeStackLayout.topControl = childComposite;
        //childsComposite.layout();
        
        SwtBorder.attach(newContext.titleComposite);
        SwtBorder.attach(newContext.childTitleComposite);

        //显示数据对象
        scripts.doAction("setThing", ["thing":thing]);
        
        if(currentObj != thing){
            //此处要异步执行，因为ubuntu缘故setThing方法中有异步操作
            outlineTree.display.asyncExec({
                scripts.doAction("selectThing", ["thing":currentObj]);
            });
        }
        
        editorContext = newContext;
        editorActions = scripts;
    }else{
        centerTabFolder.setSelection(tab);
        outlineStackLayout.topControl = tab.getData("outlineTree");
        outlineComposite.layout();
        
        //childsCompositeStackLayout.topControl = tab.getData("childComposite");
        //childsComposite.layout();
           
        def scripts = tab.getData("scripts");        
        if(currentObj != thing){            
            scripts.doAction("selectThing", ["thing":currentObj]);
        }
        editorContext = scripts.actionContext;
        editorActions = scripts;
    }
    
    //通知辅助者选中了一个事物编辑器
     Assistor.thingEditorSelected(tab, editorContext, editorActions);
    
    SelectProjectTree.selectProject("thing", thing.getMetadata().getPath());
    return editorContext;
}
#$@text#$@
      Sdescription
#$@text#$@
<p>打开一个事物。</p>
<p>参数：thing。</p>
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openDataObject
        @/@shell1/@scripts/@openDataObject/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@openDataObject/@ins/@thing
          sname
          thing
          stype
          org.xmeta.Thing
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          thing
      @/@shell1/@scripts/@openPackageViewer
      sname
      openPackageViewer
      slabel
      openPackageViewer
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import groovy.lang.Binding;

import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import xworker.util.UtilData;
import xworker.util.UtilResource;
import org.xmeta.util.UtilString;
import xworker.swt.events.SwtListener;
import xworker.util.XWorkerUtils;
import xworker.swt.util.XWorkerTreeUtil;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

import java.util.HashMap;

def path = "categoryViewer";
def tab = null;
for(item in centerTabFolder.items){
    if(item.getData("path") == path){
        tab = item;
    }
}

if(tab == null){
    //Tab不存在，创建新的Tab
    tab = new CTabItem(centerTabFolder, SWT.NONE);
    tab.setText(UtilResource.getDefaultInstance().get("core", "categoryView", UtilString.getString("res:res.w_exp:categoryViewer:目录浏览", actionContext)));
    tab.setData("path", "categoryViewer");
        
    ActionContext newContext = new ActionContext();
    newContext.put("explorerActions", actions);
    newContext.put("explorerActionContext", actionContext);
    newContext.put("parent", centerTabFolder);
    newContext.put("tree", projectTree);
    newContext.put("projectTree", projectTree);
    
    Thing viewerObject = world.getThing("xworker.ide.worldexplorer.swt.util.PackageViewer/@shell/@packageCompoiste");
    def viewer = viewerObject.doAction("create", newContext);      
    
    //帮助页面
    newContext.put("parent", outlineComposite);
    Thing helpBrowserThing = world.getThing("xworker.ide.worldexplorer.swt.util.PackageViewer/@packageViewerHelpBrowser");
    def helpBrowser = helpBrowserThing.doAction("create", newContext);
    tab.setData("outlineTree", helpBrowser); //放入可以到最后删除
    
    tab.setControl(viewer);    
    tab.setData("actions", newContext.actions);

    def icon = XWorkerTreeUtil.getIcon(viewerObject, viewer, actionContext, true);
    if(icon != null){
        tab.setImage(icon);
    }
}
centerTabFolder.setSelection(tab);
def helpBrowser = tab.getData("outlineTree");
if(helpBrowser != null){
    outlineStackLayout.topControl = helpBrowser;
}else{
    outlineStackLayout.topControl = blankTree;
}
outlineComposite.layout();
//childsCompositeStackLayout.topControl = blankChildList;
//childsComposite.layout()

def actions = tab.getData("actions");
actions.actionContext.put("treeItem", projectTree.getSelection()[0]);
actions.doAction("refreshTable", ["index":projectTree.getSelection()[0].getData(), "refresh":true]);

//根据左边的选择显示概要的帮助文档
def index = projectTree.getSelection()[0].getData();
def indexType = index.getType();
def helpThing = null;
if(indexType == "world"){
    helpThing = world.getThing("xworker.ide.worldexplorer.swt.help.ProjectHelps/@World");
}else if(indexType == "workingSet"){
    helpThing = world.getThing("xworker.ide.worldexplorer.swt.help.ProjectHelps/@WorkingSet");
}else if(indexType == "thingManager"){
    helpThing = world.getThing("xworker.ide.worldexplorer.swt.help.ProjectHelps/@ThingManager");
}else if(indexType == "category"){
    helpThing = world.getThing("xworker.ide.worldexplorer.swt.help.ProjectHelps/@Category");
}
if(helpThing != null){
    def url = XWorkerUtils.getThingDescUrl(helpThing);
    helpBrowser.setUrl(url);
}
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openPackageViewer
      @/@shell1/@scripts/@expandProjectTreeItem
      sname
      expandProjectTreeItem
      slabel
      expandProjectTreeItem
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      suseOuterJava
      true
      souterClassName
      xworker.ide.worldexplorer.actions.ProjectTreeActions
      smethodName
      expandProjectTree
      sdisableGlobalContext
      false
      sattributeTemplate
      false
      sinterpretationType
      Action
      svarScope
      Global
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdescriptors
      xworker.lang.actions.Actions/@JavaAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      expandProjectTreeItem
      @/@shell1/@scripts/@refreshProjectTree
      sname
      refreshProjectTree
      slabel
      refreshProjectTree
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      suseOuterJava
      true
      souterClassName
      xworker.ide.worldexplorer.actions.ProjectTreeActions
      smethodName
      refreshProjectTree
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

def item = projectTree.getSelection()[0];
def data = item.getData();

//item.removeAll();
data.refresh();

if(true){
    def items = item.getItems();
    def itemIndex = 0;
    def itemRemoved = [];
    //如果当前节点没有子节点，那么打开子节点
    for(childIndex in data.childs){
        //项目导航不显示树
        if(childIndex.type == "thing") continue;
        
        if(itemIndex < items.length){
            if(items[itemIndex].getData().getName() == childIndex.getName()){
                itemIndex ++;
                continue;
            }else{
                while(itemIndex < items.length && items[itemIndex].getData().getName() < childIndex.getName()){
                    //节点已经被删除
                    itemRemoved.add(items[itemIndex]);
                    itemIndex ++;
               }
               
               if(itemIndex < items.length && items[itemIndex].getData().getName() == childIndex.getName()){
                   itemIndex ++;
                   continue;
               }else{
                   //新增节点
               }
           }         
        }
        
        TreeItem treeItem = new TreeItem(item, SWT.NONE, itemIndex);
        treeItem.setText(childIndex.label);
        treeItem.setData(childIndex);
        switch(childIndex.type){
            case "project":
                treeItem.setImage(project1Image);
                break;
            case "thingManager":
                treeItem.setImage(factoryImage);
                break;
            case "category":
                treeItem.setImage(packageImage);
                break;
            case "dataObjectImage":
                treeItem.setImage(dataObjectImage);
                break;
            case "workingSet":
                treeItem.setImage(project1Image);
                break;
        }
    }
    
    for(itemr in itemRemoved){
        itemr.dispose();
    }
}

//打开本节点关闭其他同级节点
def parentItem = item.getParentItem();
if(parentItem != null){
    for(titem in parentItem.getItems()){
         if(titem != item && titem.getExpanded()){
             //titem.setExpanded(false);
         }
    }
}
item.setExpanded(true);
#$@text#$@
      sattributeTemplate
      false
      sinterpretationType
      Action
      svarScope
      Global
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdescriptors
      xworker.lang.actions.Actions/@JavaAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      refreshProjectTree
      @/@shell1/@scripts/@refreshFunctionTree
      sname
      refreshFunctionTree
      slabel
      refreshFunctionTree
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

return;

functionTree.removeAll();
functionThing = world.getThing("xworker.ide.worldexplorer.swt.util.Function");
for(node in functionThing.childs){
    initTreeItem(functionTree, node);
}

def initTreeItem(treeItem, dataObj){
    TreeItem item = new TreeItem(treeItem, SWT.NONE);
    item.setData(dataObj);
    item.setText(dataObj.metadata.label);
    
    for(child in dataObj.childs){
        initTreeItem(item, child);
    }
}
#$@text#$@
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      refreshFunctionTree
      @/@shell1/@scripts/@openCompoisteAtTab
      sname
      openCompoisteAtTab
      slabel
      openCompoisteAtTab
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;
import org.xmeta.util.ActionContainer;

import xworker.swt.events.SwtListener;
import xworker.swt.util.XWorkerTreeUtil;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;
import org.eclipse.swt.widgets.Widget;

import java.util.HashMap;

if(actionContext.get("compositeThing") == null) return;

if(compositeThing instanceof String){
    compositeThing = world.getThing(compositeThing);
}

def path = actionContext.get("path");
if(path == null || path == ""){
    path = "openTab" + compositeThing.metadata.path;
}

def title = actionContext.get("title");
if(title == null){
    title = compositeThing.getMetadata().getLabel();
}
def tab = null;
for(item in centerTabFolder.items){
    if(item.getData("path") == path){
        tab = item;
    }
}

if(tab == null){
    //Tab不存在，创建新的Tab
    tab = new CTabItem(centerTabFolder, SWT.NONE);
    tab.setText(title);
    tab.setData("path", path);
    def image = getImage(actionContext, "thing", compositeThing);
    if(image != null){
        tab.setImage(image);
    }
        
    ActionContext newContext = new ActionContext();            
    newContext.put("tab", tab);
    newContext.put("explorerContext", actionContext);
    newContext.put("explorerActions", actions);
    newContext.put("parent", centerTabFolder);
    newContext.put("outlineComposite", outlineComposite);
    newContext.put("utilBrowser", utilBrowser);
    newContext.put("params", actionContext.get("params"));
    
    def viewer = compositeThing.doAction("create", newContext);      
    tab.setData("tabContext", newContext);
    tab.setData("actionContext", newContext);
    tab.setData("thing", compositeThing);
    tab.setControl(viewer);        

    def icon = XWorkerTreeUtil.getIcon(compositeThing, viewer, actionContext, true);
    if(icon != null){
        tab.setImage(icon);
    }
}

centerTabFolder.setSelection(tab);
def outlineTree = tab.getData("outlineTree");
if(outlineTree == null){
    outlineStackLayout.topControl = blankTree;
    outlineComposite.layout();
}else if(outlineTree instanceof Widget){
    outlineStackLayout.topControl = outlineTree;
    outlineComposite.layout();
}

//执行初始化方法，如果有名为actions的ActionContainer，那么执行它的ideInit方法。
def compositeContext = tab.getData("actionContext");
def compositeActions = compositeContext.get("actions");
if(compositeActions instanceof ActionContainer){
    compositeActions.doAction("ideInit", compositeContext, ["params": actionContext.get("params")]);
}
return tab;
#$@text#$@
      Sdescription
#$@text#$@
<p>打开一个Composite。</p>
<p>参数：title,</p>
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openCompoisteAtTab
        @/@shell1/@scripts/@openCompoisteAtTab/@ActionDefined
        sname
        ActionDefined
        sdescriptors
        xworker.lang.actions.Inout/@ActionDefined
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ActionDefined
          @/@shell1/@scripts/@openCompoisteAtTab/@ActionDefined/@getImage
          sname
          getImage
          sparent
          var:mainSash
          sthing
          var:thing
          sinterpretationType
          Self
          sattributeTemplate
          false
          schildsAttributeTemplate
          false
          svarScope
          Local
          sisSynchronized
          false
          sthrowException
          true
          screateLocalVarScope
          false
          ssaveReturn
          false
          sdisableGlobalContext
          false
          sdebugLog
          false
          sdescriptors
          xworker.swt.actions.CommonActions/@GetThingIcon
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          getImage
        @/@shell1/@scripts/@openCompoisteAtTab/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@openCompoisteAtTab/@ins/@compositeThing
          sname
          compositeThing
          stype
          org.xmeta.Thing
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          compositeThing
          @/@shell1/@scripts/@openCompoisteAtTab/@ins/@path
          sname
          path
          stype
          java.lang.String
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          path
          @/@shell1/@scripts/@openCompoisteAtTab/@ins/@title
          sname
          title
          stype
          java.lang.String
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          title
      @/@shell1/@scripts/@openUrl
      sname
      openUrl
      slabel
      openUrl
      sisSynchronized
      false
      sthrowException
      false
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
//打开浏览器
def viewObject = world.getThing("xworker.ide.worldexplorer.swt.util.WebBrowser/@shell/@mainComposite");
actions.doAction("openCompoisteAtTab", ["compositeThing":viewObject, "title":"Web Browser", "path":""]);

//获得WebBrowser的binding
for(item in centerTabFolder.getItems()){
    if(item.getData("path") == "openTab" + viewObject.metadata.path){
        def bin = item.getData("tabContext");
        bin.scripts.doAction("openUrl", ["url":url, "name":name, "path":""]);
        break;
    }
}
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openUrl
        @/@shell1/@scripts/@openUrl/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@openUrl/@ins/@url
          sname
          url
          stype
          java.lang.String
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          url
          @/@shell1/@scripts/@openUrl/@ins/@name
          sname
          name
          stype
          java.lang.String
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          name
      @/@shell1/@scripts/@openEditFlowThing
      sname
      openEditFlowThing
      slabel
      openEditFlowThing
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import groovy.lang.Binding;

import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import xworker.ui.swt.SwtBorder;
import xworker.swt.events.SwtListener;
import xworker.ui.editor.OutlineTreeDragAndDrop;
//import xworker.flow.ThingFlow;
//import xworker.flow.ThingFlowListener;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

import java.util.HashMap;

if(actionContext.get("flowRequest") != null){    
    def uirequest = actionContext.get("flowRequest");
    def tableItem = actionContext.get("tableItem");
    
    def currentObj = uirequest.thing;
    def thing = currentObj.getRoot();
    def thingFlow = uirequest.getThingFlow();
    def tabPath = thingFlow.getName() + thingFlow.getId();
    def path = thing.metadata.path;
    def slient = actionContext.get("slient");
    //log.info(path);
    def tab = null;
    for(item in centerTabFolder.items){
        if(item.getData("tabPath") == tabPath){
            tab = item;
        }
    }
       
    if(tab == null){
        if(slient == true) return;
        
        //Tab不存在，创建新的Tab
        tab = new CTabItem(centerTabFolder, SWT.NONE);
        tab.setText(thingFlow.getName() + "(" + thingFlow.getId() + ")");
        tab.setToolTipText(thing.metadata.path);     
        tab.setData("path", path);  
        tab.setData("tabPath", tabPath); 
        thingFlow.addThingFlowListener([
            start : {thingFlow0->
            },
            
            close : {thingFlow1->
                tab.getParent().getDisplay().asyncExec([
                    run : {                    
                        tab.dispose();
                    }] as Runnable);
            },
            
            nodeStart : {thingFlow2, flowNodeThing->
            },

            nodeClose : {thingFlow3, flowNodeThing1->
            },
            
            requestUI : {equest0->
            }
        ] as ThingFlowListener);
       
        def treeThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@outlineTree");
        def childThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@propertiesComposite");
        def contentThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@rightComposite");
        def scriptThing = world.getThing("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@actions");
        
        ActionContext newContext = new ActionContext();
        newContext.put("contentTab", tab);
        newContext.put("explorerActions", actions);
        newContext.put("explorerContext", actionContext);
        newContext.put("utilBrowser", utilBrowser);
        newContext.put("flowRequest", uirequest);
        newContext.put("tableItem", tableItem);
        newContext.put("parent", outlineComposite);
        newContext.put("thingFlow", uirequest.getThingFlow());
        newContext.put("currentRequestFinished", false);
        newContext.put("outlineComposite", outlineComposite);
        
        def scripts = scriptThing.doAction("create", newContext);
         
        def outlineTree = treeThing.doAction("create", newContext);
        OutlineTreeDragAndDrop.attach(outlineTree, newContext);
        
        newContext.put("parent", childsComposite);
        def childComposite = childThing.doAction("create", newContext);
        
        newContext.put("parent", centerTabFolder);
        def contentComposite = contentThing.doAction("create", newContext);       
        
        newContext.put("parent", newContext.get("contentComposite"));
        def flowEditCompositeObj = world.getThing("xworker.ide.worldexplorer.swt.flowwidgets.ThingEditBottomButtons");
        flowEditCompositeObj.doAction("create", newContext);
        
        contentComposite.layout();
        
        tab.setControl(contentComposite);
        tab.setData("outlineTree", outlineTree);
        tab.setData("childComposite", childComposite);
        tab.setData("scripts", scripts);
        tab.setData("actionContext", newContext);
        tab.setData("thingPath", thing.metadata.path);
        
        //显示Tab
        centerTabFolder.setSelection(tab);
        outlineStackLayout.topControl = outlineTree;
        outlineComposite.layout();
        childsCompositeStackLayout.topControl = childComposite;
        childsComposite.layout();
        
        SwtBorder.attach(newContext.titleComposite);
        SwtBorder.attach(newContext.childTitleComposite);

        //显示数据对象
        scripts.doAction("setThing", ["thing":thing]);
        
        if(currentObj != thing){
            scripts.doAction("selectThing", ["thing":currentObj]);
        }
        
        return newContext;
    }else{
        def tabActionContext = tab.getData("actionContext");
        if(slient == true && tabActionContext.get("currentRequestFinished") == false){
            return;
        }
        
        //选择事物流程已在的TAB
        centerTabFolder.setSelection(tab);
        outlineStackLayout.topControl = tab.getData("outlineTree");
        outlineComposite.layout();
        
        childsCompositeStackLayout.topControl = tab.getData("childComposite");
        childsComposite.layout();
        
        
		
		//查看当前正在执行的请求是否已经完成           
        if(tabActionContext.get("currentRequestFinished") == false && slient != true){
            MessageBox box = new MessageBox(centerTabFolder.getShell(), SWT.YES | SWT.NO | SWT.ICON_QUESTION);
            box.setText(UtilString.getString("res:res.w_exp:commonBoxTitle操作信息", actionContext));            
            box.setMessage(UtilString.getString("res:res.w_exp:askCancelRequsetHandle原先的请求还未处理完毕，要放弃原先的请求而处理新的请求吗？", actionContext));
            if(box.open() == SWT.NO){
                return;
            }
        }

        //设置编辑请求事物，并选择要编辑的节点
        def scripts = tab.getData("scripts");        
        if(currentObj.getRoot() != tabActionContext.get("currentThing").getRoot()){  
            scripts.doAction("setThing", ["thing": currentObj.getRoot()]);                     
        }
        scripts.doAction("selectThing", ["thing":currentObj]);        

        tabActionContext.put("flowRequest", uirequest);
        tabActionContext.put("tableItem", tableItem);
        
        if(tabActionContext.get("flowSaveButton") == null){
            tabActionContext.put("parent", tabActionContext.get("contentComposite"));
            def flowEditCompositeObj = world.getThing("xworker.ide.worldexplorer.swt.flowwidgets.ThingEditBottomButtons");
            flowEditCompositeObj.doAction("create", tabActionContext);            
            tabActionContext.get("contentComposite").layout();
            //log.info("xxx");
        }else{
            tabActionContext.flowActions.doAction("enableButtons");
        }
        return scripts.actionContext;
    }
}
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openEditFlowThing
      @/@shell1/@scripts/@doAction
      sname
      doAction
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Global
      Scode
#$@text#$@
import org.xmeta.Action;
import org.xmeta.ActionContext;

if(actionContext.get("action") == null) return;

if(action instanceof Action){
    ActionContext newContext = new ActionContext();            
    newContext.put("explorerContext", actionContext);
    newContext.put("explorerActions", actions);
    
    action.run(newContext); 
}
#$@text#$@
      Sdescription
#$@text#$@
<p>执行动作。</p>
<p>参数：&nbsp;action 。</p>
#$@text#$@
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      doAction
      @/@shell1/@scripts/@openTab
      sname
      openTab
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;
import org.xmeta.util.ActionContainer;

import xworker.swt.events.SwtListener;
import xworker.swt.util.XWorkerTreeUtil;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;
import org.eclipse.swt.widgets.Widget;

import java.util.HashMap;

if(compositeThing == null) return;

if(actionContext.get("path") == null || path == ""){
    path = "openTab" + compositeThing.metadata.path;
}
def tab = null;
for(item in centerTabFolder.items){
    if(item.getData("path") == path){
        tab = item;
    }
}

if(tab == null){
    //Tab不存在，创建新的Tab
    tab = new CTabItem(centerTabFolder, SWT.NONE);
    if(actionContext.get("title") == null || title == ""){
        title = compositeThing.metadata.name;
    }
    
    tab.setText(title);
    tab.setData("path", path);
        
    ActionContext newContext = new ActionContext();            
    newContext.put("tab", tab);
    newContext.put("explorerContext", actionContext);
    newContext.put("explorerActions", actions);
    newContext.put("parent", centerTabFolder);
    newContext.put("outlineComposite", outlineComposite);
    newContext.put("params", actionContext.get("params"));
    
    def viewer = compositeThing.doAction("create", newContext);      
    tab.setData("tabContext", newContext);
    tab.setData("thing", compositeThing);
    tab.setControl(viewer);        
    
    def icon = XWorkerTreeUtil.getIcon(compositeThing, viewer, actionContext, true);
    if(icon != null){
        tab.setImage(icon);
    }
}

centerTabFolder.setSelection(tab);
def outlineTree = tab.getData("outlineTree");
if(outlineTree == null){
    outlineStackLayout.topControl = blankTree;
    outlineComposite.layout();
}else if(outlineTree instanceof Widget){
    outlineStackLayout.topControl = outlineTree;
    outlineComposite.layout();
}

//执行初始化方法，如果有名为actions的ActionContainer，那么执行它的ideInit方法。
def compositeContext = tab.getData("tabContext");
def compositeActions = compositeContext.get("actions");
if(compositeActions instanceof ActionContainer){
    compositeActions.doAction("ideInit", compositeContext, ["params": actionContext.get("params")]);
}

/*
def childComposite = tab.getData("childComposite");
if(childComposite == null){
    childsCompositeStackLayout.topControl = blankChildList;
    childsComposite.layout()
}else if(childComposite instanceof Widget){
    childsCompositeStackLayout.topControl = childComposite;
    childsComposite.layout();
}*/

return tab;
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openTab
        @/@shell1/@scripts/@openTab/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@openTab/@ins/@compositeThing
          sname
          compositeThing
          stype
          org.xmeta.Thing
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          compositeThing
          @/@shell1/@scripts/@openTab/@ins/@path
          sname
          path
          stype
          java.lang.String
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          path
          @/@shell1/@scripts/@openTab/@ins/@title
          sname
          title
          stype
          java.lang.String
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          title
      @/@shell1/@scripts/@openTextFile
      sname
      openTextFile
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import xworker.swt.events.SwtListener;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;
import org.eclipse.swt.widgets.Widget;

import java.util.HashMap;

if(actionContext.get("file") == null) return;

def path = "textFile" + file.getAbsolutePath();
def tab = null;
for(item in centerTabFolder.items){
    if(item.getData("path") == path){
        tab = item;
    }
}

if(tab == null){
    //Tab不存在，创建新的Tab
    tab = new CTabItem(centerTabFolder, SWT.NONE);
    tab.setText(file.getName());
    tab.setData("path", path);
        
    ActionContext newContext = new ActionContext();            
    newContext.put("tab", tab);
    newContext.put("explorerContext", actionContext);
    newContext.put("explorerActions", actions);
    newContext.put("parent", centerTabFolder);
    newContext.put("utilBrowser", utilBrowser);
    newContext.put("outlineComposite", outlineComposite);
    
    def compositeThing = world.getThing("xworker.ide.worldexplorer.swt.editor.TextEditor/@shell/@mainComposite");
    def viewer = compositeThing.doAction("create", newContext);  
    newContext.actions.doAction("setFile", ["file":file]);    
    tab.setData("tabContext", newContext);
    tab.setData("actionContext", newContext);
    tab.setControl(viewer);        
}

centerTabFolder.setSelection(tab);
def outlineTree = tab.getData("outlineTree");
if(outlineTree == null){
    outlineStackLayout.topControl = blankTree;
    outlineComposite.layout();
}else if(outlineTree instanceof Widget){
    outlineStackLayout.topControl = outlineTree;
    outlineComposite.layout();
}

/*
def childComposite = tab.getData("childComposite");
if(childComposite == null){
    childsCompositeStackLayout.topControl = blankChildList;
    childsComposite.layout()
}else if(childComposite instanceof Widget){
    childsCompositeStackLayout.topControl = childComposite;
    childsComposite.layout();
}*/

return tab;
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      openTextFile
        @/@shell1/@scripts/@openTextFile/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@openTextFile/@ins/@file
          sname
          file
          stype
          java.io.File
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          file
      @/@shell1/@scripts/@startJetty
      sname
      startJetty
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.mortbay.jetty.Connector;
import org.mortbay.jetty.Server;
import org.mortbay.jetty.nio.SelectChannelConnector;
import org.mortbay.jetty.webapp.WebAppContext;

def globalConfig = world.getThing("xworker.ide.config..GlobalConfig");
def port = globalConfig.getInt("webPort", 9001);

def server = actionContext.get("jettyServer");
if(server != null) return;

try{
	def aserver = new Server();
    Connector connector=new SelectChannelConnector();
    connector.setPort(port);
    aserver.setConnectors([connector] as Connector[]);
    
    //根应用
    WebAppContext context = new WebAppContext(world.getPath() + "/webroot", "/");     	  
    context.setResourceBase(world.getPath() + "/webroot");
    context.setClassLoader(Thread.currentThread().getContextClassLoader());
    aserver.setHandler(context);
    
    //eclipse helper
    /*WebAppContext helpContext = new WebAppContext("webhelp", "/_help");     	  
    helpContext.setResourceBase("webhelp");
    helpContext.setClassLoader(Thread.currentThread().getContextClassLoader());
    aserver.addHandler(helpContext);*/

    aserver.setStopAtShutdown(true);
    
    new Thread(
        {
            aserver.start();
            aserver.join()
        } as Runnable
    ).start();    
    
    actionContext.getScope(0).put("jettyServer", aserver);
    startJettyMenuItem.setEnabled(false);
}catch(Exception e){
	e.printStackTrace();
}
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sid
      startJetty
      @/@shell1/@scripts/@getAllEditorRootControls
      sname
      getAllEditorRootControls
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
def controls = [];
for(item in centerTabFolder.getItems()){
    controls.add(item);    
}

return controls;
#$@text#$@
      sinterpretationType
      Action
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_mark
      false
      sid
      getAllEditorRootControls
      @/@shell1/@scripts/@getActiveEditorRootControl
      sname
      getActiveEditorRootControl
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      scode
      return centerTabFolder.getSelection();
      sinterpretationType
      Action
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_mark
      false
      sid
      getActiveEditorRootControl
      @/@shell1/@scripts/@refreshAllMenu
      sname
      refreshAllMenu
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import xworker.lang.util.FuntionsUtil;
import org.xmeta.ActionContext;

//清除基本菜单
int index = 0;
for(item in mainMenu.getItems()){
    //if(index != 0){
        item.dispose();
    //}
    
    index++;
}

def menuActionContext = new ActionContext();
menuActionContext.put("parent", shell);
menuActionContext.put("explorerShell", shell);
menuActionContext.put("explorerActionContext", actionContext);
menuActionContext.put("explorerContext", actionContext);
menuActionContext.put("explorerActions",actions);
menuActionContext.put("mainMenu", mainMenu);
FuntionsUtil.attachToMenu(mainMenu, menuActionContext);
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      refreshAllMenu
      @/@shell1/@scripts/@initProjectTreeItem
      sname
      initProjectTreeItem
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      suseOuterJava
      true
      souterClassName
      xworker.ide.worldexplorer.actions.ProjectTreeActions
      smethodName
      initProjectTreeItem
      sdisableGlobalContext
      false
      sattributeTemplate
      false
      sinterpretationType
      Action
      svarScope
      Local
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdescriptors
      xworker.lang.actions.Actions/@JavaAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      initProjectTreeItem
        @/@shell1/@scripts/@initProjectTreeItem/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@initProjectTreeItem/@ins/@index
          sname
          index
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          index
      @/@shell1/@scripts/@closeTab
      sname
      closeTab
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
if(actionContext.get("path") != null){
    for(item in centerTabFolder.items){
        if(item.getData("path") == path){            
            item.dispose();
        }
    }
}
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      closeTab
        @/@shell1/@scripts/@closeTab/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@closeTab/@ins/@path
          sname
          path
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          path
      @/@shell1/@scripts/@aliceLearn
      sname
      aliceLearn
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import bitoflife.chatterbean.aiml.AIMLParser;

//转化成XML
def xml = thing.doAction("toAiml", actionContext);
if(xml == null || xml.trim() == ""){
    log.info("toAiml is null, aimlThing=" + thing.getMetadata().getPath());
    return;
}

//分析器，分析
def parser = new AIMLParser();
def bin = new ByteArrayInputStream(xml.getBytes());
parser.parse(aliceBot.getGraphmaster(), bin);
#$@text#$@
      sdescription
      <p>AliceBot学习一个用事物编写聊天信息。</p>
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      aliceLearn
        @/@shell1/@scripts/@aliceLearn/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        ins
      @/@shell1/@scripts/@thingTab
      sname
      thingTab
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import groovy.lang.Binding;

import org.xmeta.World;
import org.xmeta.Thing;
import org.xmeta.ActionContext;

import xworker.ui.swt.SwtBorder;
import xworker.swt.events.SwtListener;
import xworker.ui.editor.OutlineTreeDragAndDrop;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.SelectionListener;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Tree;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

import java.util.HashMap;
import xworker.ide.assistor.Assistor;

import xworker.ide.assistor.guide.actions.SelectProjectTree;

if(actionContext.get("thing") != null){    
    def currentObj = actionContext.get("thing");
    def thing = getRoot(currentObj);//.getRoot();
    def path = "thingTab:" + thing.metadata.path;
    //log.info(path);
    def tab = null;
    for(item in centerTabFolder.items){
        if(item.getData("tabPath") == path){
            tab = item;
        }
    }
       
    def editorContext = null;
    def editorActions = null;
    if(tab == null){
        //Tab不存在，创建新的Tab
        tab = new CTabItem(centerTabFolder, SWT.NONE);
        tab.setText(thing.getMetadata().getLabel());
        tab.setToolTipText(thing.metadata.path);     
        tab.setData("path", path);  
        tab.setData("tabPath", path); 
        
        //创建新的变量上下文
        ActionContext newContext = new ActionContext();
        newContext.put("contentTab", tab);
        newContext.put("explorerActions", actions);
        newContext.put("explorerContext", actionContext);
        newContext.put("utilBrowser", utilBrowser);
        newContext.put("parent", outlineComposite);
        newContext.put("outlineComposite", outlineComposite);
        newContext.put("outlineStackLayout", outlineStackLayout);
        
        //创建outline
        def outlineTree = thing.doAction("createThingTabOutline", newContext);
        
        //创建内容
        newContext.put("parent", centerTabFolder);
        def contentComposite = thing.doAction("createThingTab", newContext);        
        def actions = newContext.get("actions");
        tab.setControl(contentComposite);
        tab.setData("outlineTree", outlineTree);
        tab.setData("actions", actions);
        tab.setData("actionContext", newContext);
        tab.setData("thingPath", thing.metadata.path);
        tab.setData("thing", thing);
        
        //选择事物
        if(actions != null){
            actions.doAction("selectThing", newContext, ["thing":currentObj]);
        }
        
        //显示Tab
        centerTabFolder.setSelection(tab);
        if(outlineTree != null){
            outlineStackLayout.topControl = outlineTree;
        }else{
            outlineStackLayout.topControl = blankTree;
        }
        outlineComposite.layout();
        
        return newContext;
    }else{
        centerTabFolder.setSelection(tab);
        if(tab.getData("outlineTree") != null){
            outlineStackLayout.topControl = tab.getData("outlineTree");
        }else{
            outlineStackLayout.topControl = blankTree;
        }
        outlineComposite.layout();
                   
        def actions = tab.getData("actions");        
        if(actions != null){            
            actions.doAction("selectThing", ["thing":currentObj]);
        }
        
        return tab.getData("actionContext");
    }
}

def getRoot(thing){
    if(thing.getBoolean("thingTabRoot")){
        return thing;
    }else{
        if(thing.getParent() != null){
            return getRoot(thing.getParent());
        }else{
            return thing;
        }
    }
}
#$@text#$@
      Sdescription
#$@text#$@
<p>在一个Tab上打开此事物。</p>

<p><strong>目的</strong></p>

<p>&nbsp;&nbsp;&nbsp; 通过事物的路径就能够定义某个功能。</p>

<p><strong>实现</strong></p>

<p>&nbsp;&nbsp; 使用新的变量上下文，事物的根节点用于创建Composite和Outline，创建后应该有一个actions的动作集合，可以调用selectThing方法选择其子节点。可以传入参数。</p>

<ul>
	<li><strong>Control createThingTabOutline(Composite parent)</strong><br />
	创建Outline部分。<br />
	&nbsp;</li>
	<li><strong>Composite createThingTab(Compostie parent)</strong><br />
	根事物的创建界面的方法。<br />
	&nbsp;</li>
	<li><strong>actions.doAction(&quot;selectThing&quot;, actionContext, [&quot;thingTabParams&quot;: xxxx])</strong><br />
	选择子节点，其中thingTabParams是传入的参数。</li>
</ul>

<p>&nbsp;</p>

<p>&nbsp;</p>
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_mark
      false
      sid
      thingTab
      @/@shell1/@scripts/@setProcess
      sname
      setProcess
      sactionContainer
      var:console
      saction
      setProcess
      svariables
      name,process
      sinterpretationType
      Self
      sattributeTemplate
      false
      schildsAttributeTemplate
      false
      svarScope
      Local
      sisSynchronized
      false
      sthrowException
      true
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdisableGlobalContext
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.ActionContainerAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_fileMonitor
      false
      sth_mark
      false
      sid
      setProcess
        @/@shell1/@scripts/@setProcess/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_fileMonitor
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@scripts/@setProcess/@ins/@name
          sname
          name
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          name
          @/@shell1/@scripts/@setProcess/@ins/@process
          sname
          process
          stype
          java.lang.Process
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_fileMonitor
          false
          sth_mark
          false
          sid
          process
      @/@shell1/@scripts/@restart
      sname
      restart
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
//一般是设置了语言之后的重新启动界面
actions.doAction("refreshAllMenu", actionContext);
/*
mainComposite.dispose();
def thing = world.getThing("xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@mainComposite");
actionContext.peek().put("parent", shell);
thing.doAction("create", actionContext);
shell.layout();*/
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sswitchResult
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_registDisabled
      false
      sth_noThingRegistViewer
      false
      sth_fileMonitor
      false
      sth_mark
      false
      sth_registQueryOnlySelf
      false
      sid
      restart
    @/@shell1/@assistorActions
    sname
    assistorActions
    sdescriptors
    xworker.swt.Widgets/@actions
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_mark
    false
    sid
    assistorActions
      @/@shell1/@assistorActions/@projectTreeSelected
      sname
      projectTreeSelected
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import xworker.ide.assistor.task.GetAssistThingStaticTask;

//println("projectTreeSelected");
return;

def thing = world.getThing("xworker.ide.IDE");
def datas = [:];
datas.put("thingForAssistor", thing);
datas.put("actionContextForAssistor", actionContext);
datas.put("type", "project");
datas.put("treeItem", treeItem);
datas.put("index", index);
datas.put("event", "projectTreeSelected");

def task = new GetAssistThingStaticTask(thing, assistorActions, actionContext, datas, GetAssistThingStaticTask.THING_ONLY);
assistorQueue.addTask(task);

assistorGuideItem.setText("刷新中");
assistorTemplateToolItem.setText("刷新中");
assitorNoteItem.setText("刷新中");
actionContext.getScope(0).put("assistorInfo", null);
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      projectTreeSelected
        @/@shell1/@assistorActions/@projectTreeSelected/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@assistorActions/@projectTreeSelected/@ins/@treeItem
          sname
          treeItem
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          treeItem
          @/@shell1/@assistorActions/@projectTreeSelected/@ins/@index
          sname
          index
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          index
      @/@shell1/@assistorActions/@thingEditorSelected
      sname
      thingEditorSelected
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import xworker.ide.assistor.task.GetAssistThingStaticTask;

//原有向导关闭，采用命令向导
return;

def datas = [:];
datas.put("thing", editorActionContext.get("thing"));
datas.put("editorActionContext", editorActionContext);
datas.put("editorAction", editorActions);
datas.put("tabItem", tabItem);
datas.put("event", "thingEditorSelected");

def task = new GetAssistThingStaticTask(editorActionContext.get("thing"), assistorActions, actionContext, datas);
assistorQueue.addTask(task);

assistorGuideItem.setText("刷新中");
assistorTemplateToolItem.setText("刷新中");
assitorNoteItem.setText("刷新中");
actionContext.getScope(0).put("assistorInfo", null);
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      thingEditorSelected
        @/@shell1/@assistorActions/@thingEditorSelected/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@assistorActions/@thingEditorSelected/@ins/@tabItem
          sname
          tabItem
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          tabItem
          @/@shell1/@assistorActions/@thingEditorSelected/@ins/@editorActionContxt
          sname
          editorActionContext
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          editorActionContxt
          @/@shell1/@assistorActions/@thingEditorSelected/@ins/@editorActions
          sname
          editorActions
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          editorActions
      @/@shell1/@assistorActions/@thingEditorClosed
      sname
      thingEditorClosed
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import xworker.ide.assistor.task.GetAssistThingStaticTask;

return;

def datas = [:];
datas.put("thing", editorActionContext.get("thing"));
datas.put("editorActionContext", editorActionContext);
datas.put("editorAction", editorActions);
datas.put("tabItem", tabItem);
datas.put("event", "thingEditorClosed");

def task = new GetAssistThingStaticTask(editorActionContext.get("thing"), assistorActions, actionContext, datas);
assistorQueue.addTask(task);

assistorGuideItem.setText("刷新中");
assistorTemplateToolItem.setText("刷新中");
assitorNoteItem.setText("刷新中");
actionContext.getScope(0).put("assistorInfo", null);
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      thingEditorClosed
        @/@shell1/@assistorActions/@thingEditorClosed/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@assistorActions/@thingEditorClosed/@ins/@tabItem
          sname
          tabItem
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          tabItem
          @/@shell1/@assistorActions/@thingEditorClosed/@ins/@editorActionContxt
          sname
          editorActionContext
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          editorActionContxt
          @/@shell1/@assistorActions/@thingEditorClosed/@ins/@editorActions
          sname
          editorActions
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          editorActions
      @/@shell1/@assistorActions/@thingEditorThingSelected
      sname
      thingEditorThingSelected
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import xworker.ide.assistor.task.GetAssistThingStaticTask;
import org.eclipse.swt.widgets.Display;

return;
//不支持其它线程下的事物选择
if(Display.getCurrent() != shell.getDisplay()){
    return;
}

def datas = [:];
datas.put("thing", thing);
datas.put("editorActionContext", editorActionContext);
datas.put("editorAction", editorActions);
datas.put("tabItem", tabItem);
datas.put("treeItem", treeItem);
datas.put("event", "thingEditorThingSelected");

def task = new GetAssistThingStaticTask(thing, assistorActions, actionContext, datas);
assistorQueue.addTask(task);

assistorGuideItem.setText("刷新中");
assistorTemplateToolItem.setText("刷新中");
assitorNoteItem.setText("刷新中");
actionContext.getScope(0).put("assistorInfo", null);
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      thingEditorThingSelected
        @/@shell1/@assistorActions/@thingEditorThingSelected/@ins
        sisValidate
        false
        sname
        ins
        sdescriptors
        xworker.lang.actions.Inout/@ins
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        ins
          @/@shell1/@assistorActions/@thingEditorThingSelected/@ins/@tabItem
          sname
          tabItem
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          tabItem
          @/@shell1/@assistorActions/@thingEditorThingSelected/@ins/@editorActionContxt
          sname
          editorActionContxt
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          editorActionContxt
          @/@shell1/@assistorActions/@thingEditorThingSelected/@ins/@editorActions
          sname
          editorActions
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          editorActions
          @/@shell1/@assistorActions/@thingEditorThingSelected/@ins/@thing
          sname
          thing
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          thing
          @/@shell1/@assistorActions/@thingEditorThingSelected/@ins/@treeItem
          sname
          treeItem
          stypeCheck
          false
          soptional
          true
          scheck
          false
          scheckLevel
          exception
          sdescriptors
          xworker.lang.actions.Inout/@ins/@param
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          treeItem
      @/@shell1/@assistorActions/@staticInfoChanged
      sname
      staticInfoChanged
      swidgetForDisplay
      shell
      stype
      async
      svariables
      infos,datas
      sinterpretationType
      Self
      sattributeTemplate
      false
      schildsAttributeTemplate
      false
      svarScope
      Local
      sisSynchronized
      false
      sthrowException
      true
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdisableGlobalContext
      false
      sdescriptors
      xworker.swt.actions.DisplayActions/@DisplayExec
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      staticInfoChanged
        @/@shell1/@assistorActions/@staticInfoChanged/@actions
        sname
        actions
        sdescriptors
        xworker.swt.actions.DisplayActions/@DisplayExec/@actions
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        actions
          @/@shell1/@assistorActions/@staticInfoChanged/@actions/@doAction
          sname
          doAction
          sisSynchronized
          false
          sthrowException
          true
          suseOtherAction
          false
          svarScope
          Local
          sdisableGlobalContext
          false
          Scode
#$@text#$@
return;

if(infos == null || infos.size() == 0){
    assistorGuideItem.setText("向导（0）");
    assistorTemplateToolItem.setText("模板（0）");
    assitorNoteItem.setText("笔记（0）");
}else{
    boolean guideHave = false;
    boolean templatehave = false;
    boolean notesHave = false;
    for(info in infos){
        if(info.getType() == "guide"){
            assistorGuideItem.setText("向导（" + info.getCount() + "）");
            guideHave = true;
        }else if(info.getType() == "template"){
            assistorTemplateToolItem.setText("模板（" + info.getCount() + "）");
            templatehave = true;
        }else if(info.getType() == "notes"){
            assitorNoteItem.setText("笔记（" + info.getCount() + "）");
            notesHave = true;
        }
    }
    
    if(!guideHave){
        assistorGuideItem.setText("向导（0）");
    }
    if(!templatehave){
        assistorTemplateToolItem.setText("模板（0）");
    }
    if(!notesHave){
        assitorNoteItem.setText("笔记（0）");
    }
    
    actionContext.getScope(0).put("assistorInfo", ["infos": infos, "datas": datas]);
}
#$@text#$@
          sinterpretationType
          Action
          screateLocalVarScope
          false
          ssaveReturn
          false
          sdebugLog
          false
          sdescriptors
          xworker.lang.actions.Actions/@GroovyAction
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_mark
          false
          sid
          doAction
      @/@shell1/@assistorActions/@createNewContext
      sname
      createNewContext
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Local
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.xmeta.ActionContext;
return;


ActionContext context = new ActionContext();
context.put("assistorEvent", datas.event);
if(datas.event != "projectTreeSelected"){
    def editorActionContext = datas.get("editorActionContext");
    context.put("parent", editorActionContext.coolBar.getShell());
    context.put("editorShell", editorActionContext.coolBar.getShell());
    context.put("explorerActions", editorActionContext.explorerActions);
    context.put("explorerContext", editorActionContext.explorerContext);
    context.put("thingContext", editorActionContext);
    context.put("utilBrowser", editorActionContext.utilBrowser);
    context.put("thing", editorActionContext.currentThing);
    context.put("currentThing", editorActionContext.currentThing);
    context.put("currentModelContext", editorActionContext.currentModelContext);
    context.put("currentModel", editorActionContext.currentModel);
    context.put("params", editorActionContext.params);
}else{
    context.put("explorerActions", actions);
    context.put("explorerContext", actionContext);
    context.put("thing", datas.get("thingForAssistor"));
}

return context;
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.lang.actions.Actions/@GroovyAction
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      createNewContext
    @/@shell1/@initCode1
    sname
    initCode
    slabel
    initCode
    sisSynchronized
    false
    sthrowException
    false
    suseOtherAction
    false
    svarScope
    Global
    sdisableGlobalContext
    false
    Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;
import org.eclipse.swt.custom.CTabFolder2Listener;
import org.eclipse.swt.custom.CTabFolderEvent;
import org.eclipse.swt.custom.StyleRange;

import org.xmeta.Action;
import org.xmeta.ActionContext;
import org.xmeta.Index;

import xworker.io.SystemIoRedirector;
import xworker.io.SystemIoRedirectorListener;
//import xworker.flow.ThingFlow;
//import xworker.flow.ThingFlowListener;
//import xworker.flow.UIRequestListener;
import xworker.util.UtilAction;
import xworker.util.UtilResource;
import org.xmeta.util.UtilString;
import xworker.swt.util.UtilBrowser;
import xworker.swt.util.SwtUtils;
import xworker.swt.design.Designer;
import xworker.ui.UIManager;
import xworker.ui.UIRequest;
import xworker.ide.SessionInitor;
import xworker.ide.assistor.Assistor;
import xworker.ide.assistor.utils.AssistorQueue;
import xworker.notification.NotificationManager;
import xworker.notification.SwtNotificationManagerListener;


//设置设计器的事物浏览器
Designer.setExplorerActions(shell.getDisplay(), actions);

def commonFeature = world.getThing("xworker.ide.worldexplorer.CommonFeatures");
commonFeature.doAction("init", actionContext);
//I18n资源
ref = UtilResource.getDefaultInstance();

//设置CTabFolder选中时的颜色
def selectedBackground = shell.getDisplay().getSystemColor(SWT.COLOR_BLUE);
//leftTabFolder.setSelectionBackground(selectedBackground);

Index index = Index.getInstance();
projectTree.setData(index);
for(subIndex in index.childs){
    actions.doAction("initProjectTreeItem", actionContext, 
        ["item": projectTree, "index": subIndex]);
    //TreeItem projectItem = new TreeItem(projectTree, SWT.NONE);
    //projectItem.setText(UtilString.getString("res:res.w_exp:" + index.getLabel() + ":" + index.getLabel(), actionContext));
    //projectItem.setData(index);
    //projectItem.setImage(projectImage);
}

//设置outlinetree，一个默认的空树，为了美观
outlineStackLayout.topControl = blankTree;
outlineComposite.layout();

//childsCompositeStackLayout.topControl = blankChildList;
//childsComposite.layout();

actions.doAction("refreshFunctionTree");
centerTabFolder.addCTabFolder2Listener(new ContentTabListener(outlineStackLayout, outlineComposite, blankTree));
//注册会话管理器
SessionInitor.initSessionTree(actionContext);

//colorer如果第一次是在非主线程里启动会程序会崩溃，因此先设置一个
colorerTabItem.dispose();

//添加系统输出和出入的重新定向
rListener = [
    read : {
        text ->
        if(actionContext.get("shell") == null){
            return;
        }
        innerRun = [
             run : {
                 consoleText.append(text);
                 if(SwtUtils.isRWT()){
                     if(consoleText.getCharCount() > 10000){
                         consoleText.setSelection(0,1000);
                         consoleText.clearSelection();
                     }
                 }else{
                     if(consoleText.getLineCount() > 3000){
                         //输出显示最多3000行
                         int offset = consoleText.getOffsetAtLine(500);
                         consoleText.replaceTextRange(0, offset, "");
                     }
                     
                     def offset = consoleText.getText().length();
                     consoleText.setCaretOffset(offset);
                     consoleText.setSelection(offset, offset);
                     consoleText.showSelection();
                 }
             }] as Runnable;
       shell.getDisplay().asyncExec(innerRun);
    },
    
    readLine : {
        line ->
        if(actionContext.get("shell") == null){
            return;
        }
        innerRun = [
             run : {
                 int lineOffset = consoleText.getText().length();
                 if(consoleText.getLineCount() > 3000){
                     //输出显示最多3000行
                     int offset = consoleText.getOffsetAtLine(100);
                     consoleText.replaceTextRange(0, offset, "");
                 }
                 consoleText.append(line + "\n");
                 
                 def offset = consoleText.getText().length();
                 consoleText.setCaretOffset(offset);
                 consoleText.setSelection(offset, offset);
                 consoleText.showSelection();
                        
                 if(line.startsWith("\tat ")){         
                     //判断是Exception的情况            
                     String clss = line.substring(4, line.indexOf("("));
                     clss = clss.substring(0, clss.lastIndexOf("."));
                               
                     //println clss;     
                     //为提高速度，始终显示                           
                     //def scriptObj = UtilAction.getActionThing(clss);
                     //if(scriptObj != null){
                     if(true){
                         //println clss;
                         try{
                             int start = 4;
                             int length = clss.length();
                             def colorBlue = shell.getDisplay().getSystemColor(SWT.COLOR_DARK_BLUE );
                             StyleRange range = new StyleRange(lineOffset + start, length, colorBlue, null);
                             range.underline = true;
                         
                             consoleText.setStyleRange(range);
                         }catch(Exception eeeee){
                         }
                     }
                     
                     return;
                 }
                 
                 int leftIndex = line.indexOf("(");
                 int rightIndex = line.indexOf(")");
                 int commerIndex = line.indexOf(":", leftIndex);
                 if(leftIndex != -1 && rightIndex != -1 && (commerIndex > leftIndex && commerIndex < rightIndex)){
                     //是Log4j的输出格式
                     def clss = line.substring(leftIndex + 1, commerIndex); 
                     //println clss;
                     //def scriptObj =  UtilAction.getActionThing(clss);
                     //if(scriptObj != null){
                     if(true){
                         //println clss;
                         try{
                             int start = leftIndex + 1;
                             int length = clss.length();
                             def colorBlue = shell.getDisplay().getSystemColor(SWT.COLOR_DARK_BLUE );
                             StyleRange range = new StyleRange(lineOffset + start, length, colorBlue, null);
                             range.underline = true;
                             consoleText.setStyleRange(range);
                         }catch(Exception eeeee){
                         }
                     }
                 }                 
             }
         ] as Runnable;
             
         shell.getDisplay().asyncExec(innerRun);
    }
] as SystemIoRedirectorListener;
//SystemIoRedirector.addListener(rListener);
binding.setVariable("sytemIOListener", rListener);

//启动助手
Assistor.setAssistor(assistorActions, actionContext);
AssistorQueue assistorQueue = new AssistorQueue();
actionContext.getScope(0).put("assistorQueue", assistorQueue);
actionContext.getScope(0).put("assistorInfo", null);
def assistorTask = world.getThing("xworker.ide.worldexplorer.swt.assistor.AssistorTask");
assistorTask.doAction("run", actionContext);

//选中默认节点
if(projectTree.getItems().length > 0){
    projectTree.select(projectTree.getItems()[0]);
    projectTreeSelection.handleEvent(null);
}

//启动welcome界面
def globalConfig = world.getThing("_local.xworker.config.GlobalConfig");
if(true){//globalConfig.getBoolean("showWelcomeOnStart")){
    def homeLabel = world.getThing("xworker.ide.worldexplorer.swt.i18n.TopicI18n/@main/@title").getMetadata().getLabel();
    actions.doAction("openCompoisteAtTab", actionContext, [
        "compositeThing":"xworker.ui.topic.TopicShell/@mainComposite",
        "path":"xworker.ui.topic.TopicShell/@mainComposite",
        "title":homeLabel
    ])
}

//菜单使用新的动作上下文
actions.doAction("refreshAllMenu", actionContext);

//系统通知加事件监听
def notifyListenerThing = world.getThing("xworker.notification.ExplorerMessageButtonListener");
def notifyListener = new SwtNotificationManagerListener(notifyListenerThing, actionContext);
NotificationManager.addListener(notifyListener);

//初始化关联导航
/*
def relationNavTableItem = new TableItem(relationNavTable, SWT.NONE);
def relationIndex = world.getThing("xworker.ide.relation.IdeRelationIndex");
relationNavTableItem.setText([relationIndex.metadata.label] as String[]);
relationNavTableItem.setData(relationIndex);*/

class ContentTabListener implements CTabFolder2Listener{
    def outlineStackLayout;
    def outlineComposite;
    def blankTree;
    def mainTabFolder;
    
    public ContentTabListener(layout, composite, blankTree){
        outlineStackLayout = layout;
        outlineComposite = composite;
        this.blankTree = blankTree;
    }
    
    public void close(CTabFolderEvent event){  
        def actionContext = event.item.getData("actionContext");     
        if(actionContext != null && actionContext.get("modified") == true){
            MessageBox box = new MessageBox(event.item.getParent().getShell(), SWT.YES | SWT.NO | SWT.CANCEL | SWT.ICON_QUESTION);
            box.setText(UtilString.getString("res:res.w_exp:commonBoxTitle:操作信息", actionContext));
            box.setMessage(UtilString.getString("res:res.w_exp:askCancelThingEdit:事物已更改，是否要保存当前事物?", actionContext));
            def result = box.open();
            if(result == SWT.OK){
                //actionContext.;
            }else if(result == SWT.CANCEL){
                event.doit = false;
                return;
            }
        }
        
        //销毁CtabItem相关的内容
        if(event.item.getControl() != null){
            event.item.getControl().dispose();
        }
        def outlineTree = event.item.getData("outlineTree");
        def childComposite = event.item.getData("childComposite");
        
        if(outlineTree == null) return;
        /*
        if(event.item.parent.getItems().length == 1){
            outlineStackLayout.topControl = blankTree;
            outlineComposite.layout();
        }*/
        if(outlineTree != null){
            outlineTree.dispose();
        }
        if(childComposite != null){
            childComposite.dispose();
        }
        try{
            event.item.dispose();   
        }catch(Exception e){
            log.info("Close TabItem error", e);
        }
    }
    
    public void maximize(CTabFolderEvent event) {
    }
    
    public void minimize(CTabFolderEvent event) {
    }

    public void restore(CTabFolderEvent event){   
    }
    
    public void showList(CTabFolderEvent event){   
    }
}
#$@text#$@
    sinterpretationType
    Action
    screateLocalVarScope
    false
    ssaveReturn
    false
    sdebugLog
    false
    sdescriptors
    xworker.swt.Widgets/@Code
    sid
    initCode1
    @/@shell1/@listeners
    sname
    listeners
    slabel
    listeners
    sdescriptors
    xworker.swt.events.Listeners/@listeners
    sid
    listeners
      @/@shell1/@listeners/@shellDispose
      sname
      shellDispose
      stype
      Dispose
      slabel
      shellDispose
      sdescriptors
      xworker.swt.events.Listeners/@listeners/@Listener
      sid
      shellDispose
        @/@shell1/@listeners/@shellDispose/@GroovyAction
        sname
        GroovyAction
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        scode
        shell.dispose();
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        GroovyAction
    @/@shell1/@explorerUI
    sname
    explorerUI
    slabel
    事物管理器
    sregistThing
    xworker.ide.worldexplorer.swt.SimpleExplorer/@shell1/@explorerUI
    sregistType
    notes
    Sdescription
#$@text#$@
<h2>事物管理器</h2>

<p>&nbsp;&nbsp;&nbsp; 事物管理器是XWorker的编辑和运行事物模型的平台，可以使用事物管理器开发和运行各种模型程序。</p>

<p>&nbsp;</p>
#$@text#$@
    sen_label
    Thing Explorer
    sen_group
    Thing Explorer
    sdescriptors
    xworker.swt.Widgets/@InteractiveUI
    sinheritDescription
    false
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sgroup
    事物管理器
    sth_mark
    false
    sid
    explorerUI
    @/@shell1/@25883
    sname
    RunAction
    sdescriptors
    xworker.swt.xworker.RunAction
    sinheritDescription
    false
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sth_mark
    false
    sid
    25883
    @/@shell1/@15770
    sname
    DataStores
    sdescriptors
    xworker.swt.Widgets/@DataStores
    sinheritDescription
    false
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sth_mark
    false
    sid
    15770
    @/@shell1/@4112
    sname
    DataStores
    sdescriptors
    xworker.swt.Widgets/@DataStores
    sinheritDescription
    false
    sth_author
    __designer_auto_manager__
    sth_createIndex
    false
    sth_registMyChilds
    false
    sth_registDisabled
    false
    sth_mark
    false
    sid
    4112
