^1524883681211
@
sname
DebugConsole
slabel
DebugConsole
sdescriptors
xworker.swt.widgets.Display
  @/@shell
  sname
  shell
  stext
  Debug Console
  sNO_TRIM
  false
  sCLOSE
  true
  sTITLE
  true
  sMIN
  true
  sMAX
  true
  sBORDER
  false
  sRESIZE
  true
  sON_TOP
  true
  sTOOL
  false
  sNO_FOCUS
  false
  swidth
  1024
  sheight
  768
  scenterScreen
  true
  spack
  false
  smaximized
  false
  sfullScreen
  false
  sdesign
  true
  sisIde
  false
  sdesignDefaultOpen
  false
  sexitOnDispose
  false
  sH_SCROLL
  false
  sV_SCROLL
  false
  sNO_BACKGROUND
  false
  sNO_MERGE_PAINTS
  false
  sNO_REDRAW_RESIZE
  false
  sNO_RADIO_GROUP
  false
  sEMBEDDED
  false
  sDOUBLE_BUFFERED
  false
  scapture
  false
  senabled
  true
  sredraw
  true
  svisible
  true
  sdescriptors
  xworker.swt.widgets.Display/@Shell
  sid
  shell
    @/@shell/@shellFillLayout
    sname
    shellFillLayout
    stype
    SWT.HORIZONTAL
    slabel
    shellFillLayout
    sdescriptors
    xworker.swt.Layouts/@FillLayout
    sid
    shellFillLayout
    @/@shell/@mainComposite
    sname
    mainComposite
    sBORDER
    false
    sH_SCROLL
    false
    sV_SCROLL
    false
    sNO_BACKGROUND
    false
    sNO_FOCUS
    false
    sNO_MERGE_PAINTS
    false
    sNO_REDRAW_RESIZE
    false
    sNO_RADIO_GROUP
    false
    sEMBEDDED
    false
    sDOUBLE_BUFFERED
    false
    scapture
    false
    senabled
    true
    sredraw
    true
    svisible
    true
    sdescriptors
    xworker.swt.Widgets/@Composite
    sid
    mainComposite
      @/@shell/@mainComposite/@mainCompositeGridLayout
      sname
      mainCompositeGridLayout
      snumColumns
      1
      smakeColumnsEqualWidth
      false
      smarginWidth
      0
      smarginHeight
      0
      smarginLeft
      0
      smarginTop
      0
      smarginRight
      0
      smarginBottom
      0
      shorizontalSpacing
      0
      sverticalSpacing
      0
      slabel
      mainCompositeGridLayout
      sdescriptors
      xworker.swt.Layouts/@GridLayout
      sid
      mainCompositeGridLayout
      @/@shell/@mainComposite/@resources
      sname
      resources
      slabel
      resources
      sdescriptors
      xworker.swt.Widgets/@Resource
      sid
      resources
        @/@shell/@mainComposite/@resources/@resumeImg
        sname
        resumeImg
        slabel
        resumeImg
        stype
        Image
        simageFile
        /xworker/ide/images/debug_resume.gif
        sdescriptors
        xworker.swt.util.Resource/@Image
        sid
        resumeImg
        @/@shell/@mainComposite/@resources/@suspendImg
        sname
        suspendImg
        slabel
        suspendImg
        stype
        Image
        simageFile
        /xworker/ide/images/debug_suspend.gif
        sdescriptors
        xworker.swt.util.Resource/@Image
        sid
        suspendImg
        @/@shell/@mainComposite/@resources/@stepoverImg
        sname
        stepoverImg
        slabel
        stepoverImg
        stype
        Image
        simageFile
        /xworker/ide/images/debug_stepover.gif
        sdescriptors
        xworker.swt.util.Resource/@Image
        sid
        stepoverImg
        @/@shell/@mainComposite/@resources/@stepoverImg1
        sname
        stepintoImg
        slabel
        stepintoImg
        stype
        Image
        simageFile
        /xworker/ide/images/debug_stepinto.gif
        sdescriptors
        xworker.swt.util.Resource/@Image
        sid
        stepoverImg1
        @/@shell/@mainComposite/@resources/@stepoverImg2
        sname
        stepreturnImg
        slabel
        stepreturnImg
        stype
        Image
        simageFile
        /xworker/ide/images/debug_stepreturn.gif
        sdescriptors
        xworker.swt.util.Resource/@Image
        sid
        stepoverImg2
        @/@shell/@mainComposite/@resources/@globalColor
        sname
        globalColor
        stype
        Color
        srgb
        "#00FF00"
        sdescriptors
        xworker.swt.util.Resource/@Color
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        globalColor
        @/@shell/@mainComposite/@resources/@localColor
        sname
        localColor
        stype
        Color
        srgb
        "#80FFFF"
        sdescriptors
        xworker.swt.util.Resource/@Color
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        localColor
        @/@shell/@mainComposite/@resources/@threadGroupImg
        sname
        threadGroupImg
        stype
        Image
        simageFile
        icons/cog.png
        sdescriptors
        xworker.swt.util.Resource/@Image
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        threadGroupImg
        @/@shell/@mainComposite/@resources/@threadGoImg
        sname
        threadGoImg
        stype
        Image
        simageFile
        icons/cog_go.png
        sdescriptors
        xworker.swt.util.Resource/@Image
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        threadGoImg
        @/@shell/@mainComposite/@resources/@threadDebugImg
        sname
        threadDebugImg
        stype
        Image
        simageFile
        icons/cog_edit.png
        sdescriptors
        xworker.swt.util.Resource/@Image
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        threadDebugImg
        @/@shell/@mainComposite/@resources/@traceImg
        sname
        traceGoImg
        stype
        Image
        simageFile
        icons/script_go.png
        sdescriptors
        xworker.swt.util.Resource/@Image
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        traceImg
        @/@shell/@mainComposite/@resources/@traceStopImg
        sname
        traceStopImg
        stype
        Image
        simageFile
        icons/script_delete.png
        sdescriptors
        xworker.swt.util.Resource/@Image
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_registDisabled
        false
        sth_mark
        false
        sid
        traceStopImg
      @/@shell/@mainComposite/@coolBar
      sname
      coolBar
      stype
      HORIZONTAL
      sBORDER
      false
      sFLAT
      false
      slabel
      coolBar
      sdescriptors
      xworker.swt.Widgets/@CoolBar
      sid
      coolBar
        @/@shell/@mainComposite/@coolBar/@coolItem
        sname
        coolItem
        sDROP_DOWN
        false
        slabel
        coolItem
        sdescriptors
        xworker.swt.widgets.CoolBar/@CoolItem
        sid
        coolItem
          @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar
          sname
          toolBar
          stype
          HORIZONTAL
          sFLAT
          true
          sWRAP
          false
          sBORDER
          false
          sSHADOW_OUT
          false
          sRIGHT
          false
          scapture
          false
          senabled
          true
          sredraw
          true
          svisible
          true
          slabel
          toolBar
          sdescriptors
          xworker.swt.widgets.CoolBar/@CoolItem/@ToolBar
          sid
          toolBar
            @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@refreshButton
            sname
            resumeButton
            stype
            PUSH
            simage
            resumeImg
            stoolTiptext
            Resume
            slabel
            resumeButton
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            refreshButton
              @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@refreshButton/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@refreshButton/@listeners/@refreshButtonSeleciton
                sname
                refreshButtonSeleciton
                stype
                Selection
                sref
                xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                slabel
                refreshButtonSeleciton
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                refreshButtonSeleciton
            @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@suspendButton
            sname
            suspendButton
            stype
            PUSH
            simage
            suspendImg
            stoolTiptext
            Suspend
            slabel
            suspendButton
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sid
            suspendButton
              @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@suspendButton/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@suspendButton/@listeners/@refreshButtonSeleciton
                sname
                suspendButtonSeleciton
                stype
                Selection
                sref
                xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                slabel
                refreshButtonSeleciton
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                refreshButtonSeleciton
            @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton1
            sname
            stepintoButton
            stype
            PUSH
            simage
            stepintoImg
            stoolTiptext
            Step Into
            senabled
            true
            slabel
            stepintoButton
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sid
            stepoverButton1
              @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton1/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton1/@listeners/@refreshButtonSeleciton
                sname
                stepoverButtonSeleciton
                stype
                Selection
                sref
                xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                slabel
                refreshButtonSeleciton
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                refreshButtonSeleciton
            @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton
            sname
            stepoverButton
            stype
            PUSH
            simage
            stepoverImg
            stoolTiptext
            Step Over
            slabel
            stepoverButton
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sid
            stepoverButton
              @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton/@listeners/@refreshButtonSeleciton
                sname
                stepoverButtonSeleciton
                stype
                Selection
                sref
                xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                slabel
                refreshButtonSeleciton
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                refreshButtonSeleciton
            @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton2
            sname
            stepreturnButton
            stype
            PUSH
            simage
            stepreturnImg
            stoolTiptext
            Step Over
            senabled
            true
            slabel
            stepreturnButton
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sid
            stepoverButton2
              @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton2/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@stepoverButton2/@listeners/@refreshButtonSeleciton
                sname
                stepoverButtonSeleciton
                stype
                Selection
                sref
                xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                slabel
                refreshButtonSeleciton
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                refreshButtonSeleciton
            @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@ToolItem
            sname
            traceToolItem
            stype
            PUSH
            simage
            traceImg
            stoolTiptext
            lang:d=打印或取消打印Treace&en=Print or disable print trace
            senabled
            false
            sdescriptors
            xworker.swt.widgets.ToolBar/@ToolItem
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            ToolItem
              @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@ToolItem/@listeners
              sname
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              listeners
                @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@ToolItem/@listeners/@traceToolItemSelection
                sname
                traceToolItemSelection
                stype
                Selection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_registDisabled
                false
                sth_mark
                false
                sid
                traceToolItemSelection
                  @/@shell/@mainComposite/@coolBar/@coolItem/@toolBar/@ToolItem/@listeners/@traceToolItemSelection/@GroovyAction
                  sname
                  GroovyAction
                  sisSynchronized
                  false
                  sthrowException
                  true
                  suseOtherAction
                  false
                  svarScope
                  Local
                  sdisableGlobalContext
                  false
                  Scode
#$@text#$@
import xworker.debug.DebugInfo;
import xworker.debug.Debuger;

def item = threadTree.getSelection()[0];
if(item == null){
    return;
}

def debugInfo = Debuger.getDebugInfo(item.getData());
debugInfo.setTrace(!debugInfo.isTrace());
if(debugInfo.isTrace()){
    traceToolItem.setImage(traceStopImg);
}else{
    traceToolItem.setImage(traceGoImg);
}
#$@text#$@
                  sinterpretationType
                  Action
                  screateLocalVarScope
                  false
                  ssaveReturn
                  false
                  sdebugLog
                  false
                  sdescriptors
                  xworker.lang.actions.Actions/@GroovyAction
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  GroovyAction
        @/@shell/@mainComposite/@coolBar/@coolBarGirdData
        sname
        coolBarGirdData
        sstyle
        FILL_HORIZONTAL
        shorizontalIndent
        0
        swidth
        -1
        sheight
        -1
        shorizontalAlignment
        BEGINNING
        sverticalAlignment
        CENTER
        shorizontalSpan
        1
        sverticalSpan
        1
        sgrabExcessHorizontalSpace
        false
        sgrabExcessVerticalSpace
        false
        slabel
        coolBarGirdData
        sdescriptors
        xworker.swt.Commons/@GridData
        sid
        coolBarGirdData
      @/@shell/@mainComposite/@mainComposite1
      sname
      mainComposite1
      sBORDER
      false
      sH_SCROLL
      false
      sV_SCROLL
      false
      sNO_BACKGROUND
      false
      sNO_FOCUS
      false
      sNO_MERGE_PAINTS
      false
      sNO_REDRAW_RESIZE
      false
      sNO_RADIO_GROUP
      false
      sEMBEDDED
      false
      sDOUBLE_BUFFERED
      false
      scapture
      false
      senabled
      true
      sredraw
      true
      svisible
      true
      sdescriptors
      xworker.swt.Widgets/@Composite
      sinheritDescription
      false
      sth_createIndex
      false
      sth_registMyChilds
      false
      sth_mark
      false
      sid
      mainComposite1
        @/@shell/@mainComposite/@mainComposite1/@mainComposite1GridData
        sname
        mainComposite1GridData
        sstyle
        FILL_BOTH
        shorizontalIndent
        0
        swidth
        -1
        sheight
        -1
        shorizontalAlignment
        BEGINNING
        sverticalAlignment
        CENTER
        shorizontalSpan
        1
        sverticalSpan
        1
        sgrabExcessHorizontalSpace
        false
        sgrabExcessVerticalSpace
        false
        sdescriptors
        xworker.swt.layout.LayoutDatas/@GridData
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        mainComposite1GridData
        @/@shell/@mainComposite/@mainComposite1/@mainComposite1Gridlayout
        sname
        mainComposite1Gridlayout
        smakeColumnsEqualWidth
        false
        smarginWidth
        5
        smarginHeight
        5
        smarginLeft
        0
        smarginTop
        0
        smarginRight
        0
        smarginBottom
        0
        shorizontalSpacing
        5
        sverticalSpacing
        5
        sdescriptors
        xworker.swt.Layouts/@GridLayout
        sinheritDescription
        false
        sth_createIndex
        false
        sth_registMyChilds
        false
        sth_mark
        false
        sid
        mainComposite1Gridlayout
        @/@shell/@mainComposite/@mainComposite1/@topSashForm
        sname
        topSashForm
        sstyle
        HORIZONTAL
        sSMOOTH
        false
        sweights
        30,70
        sBORDER
        false
        sH_SCROLL
        false
        sV_SCROLL
        false
        sNO_BACKGROUND
        false
        sNO_FOCUS
        false
        sNO_MERGE_PAINTS
        false
        sNO_REDRAW_RESIZE
        false
        sNO_RADIO_GROUP
        false
        sEMBEDDED
        false
        sDOUBLE_BUFFERED
        false
        scapture
        false
        senabled
        true
        sredraw
        true
        svisible
        true
        sdescriptors
        xworker.swt.Widgets/@SashForm
        sid
        topSashForm
          @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite
          sname
          threadTreeComposite
          sBORDER
          false
          sH_SCROLL
          false
          sV_SCROLL
          false
          sNO_BACKGROUND
          false
          sNO_FOCUS
          false
          sNO_MERGE_PAINTS
          false
          sNO_REDRAW_RESIZE
          false
          sNO_RADIO_GROUP
          false
          sEMBEDDED
          false
          sDOUBLE_BUFFERED
          false
          scapture
          false
          senabled
          true
          sredraw
          true
          svisible
          true
          sdescriptors
          xworker.swt.Widgets/@Composite
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_mark
          false
          sid
          threadTreeComposite
            @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@threadTreeCompositeGridLayout
            sname
            threadTreeCompositeGridLayout
            smakeColumnsEqualWidth
            false
            smarginWidth
            0
            smarginHeight
            0
            smarginLeft
            0
            smarginTop
            0
            smarginRight
            0
            smarginBottom
            0
            shorizontalSpacing
            5
            sverticalSpacing
            5
            sdescriptors
            xworker.swt.Layouts/@GridLayout
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            threadTreeCompositeGridLayout
            @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@threadTree
            sname
            threadTree
            sselectStyle
            SINGLE
            sV_SCROLL
            true
            sH_SCROLL
            true
            sCHECK
            false
            sFULL_SELECTION
            true
            sHIDE_SELECTION
            true
            sBORDER
            false
            slineVisible
            false
            smultipleColumns
            false
            sheaderVisible
            false
            ssortIndicator
            true
            smoveableColumns
            true
            sheadImages
            false
            ssubImages
            false
            scheckSelection
            false
            scapture
            false
            senabled
            true
            sredraw
            true
            svisible
            true
            slabel
            threadTree
            sdescriptors
            xworker.swt.Widgets/@Tree
            sid
            threadTree
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@threadTree/@listeners
              sname
              listeners
              slabel
              listeners
              sdescriptors
              xworker.swt.events.Listeners/@listeners
              sid
              listeners
                @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@threadTree/@listeners/@threadTreeSelection
                sname
                threadTreeSelection
                stype
                Selection
                sref
                xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                slabel
                threadTreeSelection
                sdescriptors
                xworker.swt.events.Listeners/@listeners/@Listener
                sid
                threadTreeSelection
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@threadTree/@threadTreeGridData
              sname
              threadTreeGridData
              sstyle
              FILL_BOTH
              shorizontalIndent
              0
              swidth
              -1
              sheight
              -1
              shorizontalAlignment
              BEGINNING
              sverticalAlignment
              CENTER
              shorizontalSpan
              1
              sverticalSpan
              1
              sgrabExcessHorizontalSpace
              false
              sgrabExcessVerticalSpace
              false
              sdescriptors
              xworker.swt.layout.LayoutDatas/@GridData
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              threadTreeGridData
            @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@infoComposite
            sname
            infoComposite
            sBORDER
            false
            sH_SCROLL
            false
            sV_SCROLL
            false
            sNO_BACKGROUND
            false
            sNO_FOCUS
            false
            sNO_MERGE_PAINTS
            false
            sNO_REDRAW_RESIZE
            false
            sNO_RADIO_GROUP
            false
            sEMBEDDED
            false
            sDOUBLE_BUFFERED
            false
            scapture
            false
            senabled
            true
            sredraw
            true
            svisible
            true
            sdescriptors
            xworker.swt.Widgets/@Composite
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            infoComposite
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@infoComposite/@infoCompositeGridData
              sname
              infoCompositeGridData
              sstyle
              FILL_HORIZONTAL
              shorizontalIndent
              0
              swidth
              -1
              sheight
              -1
              shorizontalAlignment
              BEGINNING
              sverticalAlignment
              CENTER
              shorizontalSpan
              1
              sverticalSpan
              1
              sgrabExcessHorizontalSpace
              false
              sgrabExcessVerticalSpace
              false
              sdescriptors
              xworker.swt.layout.LayoutDatas/@GridData
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              infoCompositeGridData
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@infoComposite/@infoCompostieRowLayout
              sname
              infoCompostieRowLayout
              sfill
              false
              sjustify
              false
              smarginWidth
              0
              smarginHeight
              0
              smarginLeft
              3
              smarginTop
              3
              smarginRight
              3
              smarginBottom
              3
              spack
              true
              sspacing
              3
              stype
              SWT.HORIZONTAL
              swrap
              true
              sdescriptors
              xworker.swt.Layouts/@RowLayout
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              infoCompostieRowLayout
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@infoComposite/@globalLabel
              sname
              globalLabel
              sBORDER
              false
              stype
              HORIZONTAL
              salignment
              LEFT
              stext
              全局变量栈
              sbackground
              globalColor
              scapture
              false
              senabled
              true
              sredraw
              true
              svisible
              true
              sdescriptors
              xworker.swt.Widgets/@Label
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              globalLabel
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@infoComposite/@loalLabel
              sname
              loalLabel
              sBORDER
              false
              stype
              HORIZONTAL
              salignment
              LEFT
              stext
              局部变量栈
              sbackground
              localColor
              scapture
              false
              senabled
              true
              sredraw
              true
              svisible
              true
              sdescriptors
              xworker.swt.Widgets/@Label
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              loalLabel
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@threadTreeComposite/@infoComposite/@infoLabel
              sname
              infoLabel
              sBORDER
              false
              stype
              HORIZONTAL
              salignment
              LEFT
              stext
              ssssssss
              scapture
              false
              senabled
              true
              sredraw
              true
              svisible
              true
              sdescriptors
              xworker.swt.Widgets/@Label
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              infoLabel
          @/@shell/@mainComposite/@mainComposite1/@topSashForm/@mainSashFormGridData
          sname
          mainSashFormGridData
          sstyle
          FILL_BOTH
          shorizontalIndent
          0
          swidth
          -1
          sheight
          -1
          shorizontalAlignment
          BEGINNING
          sverticalAlignment
          CENTER
          shorizontalSpan
          1
          sverticalSpan
          1
          sgrabExcessHorizontalSpace
          false
          sgrabExcessVerticalSpace
          false
          slabel
          mainSashFormGridData
          sdescriptors
          xworker.swt.layout.LayoutDatas/@GridData
          sid
          mainSashFormGridData
          @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1
          sname
          rightSashForm
          sstyle
          VERTICAL
          sSMOOTH
          false
          sweights
          30,70
          sBORDER
          false
          sH_SCROLL
          false
          sV_SCROLL
          false
          sNO_BACKGROUND
          false
          sNO_FOCUS
          false
          sNO_MERGE_PAINTS
          false
          sNO_REDRAW_RESIZE
          false
          sNO_RADIO_GROUP
          false
          sEMBEDDED
          false
          sDOUBLE_BUFFERED
          false
          scapture
          false
          senabled
          true
          sredraw
          true
          svisible
          true
          sdescriptors
          xworker.swt.Widgets/@SashForm
          sinheritDescription
          false
          sth_createIndex
          false
          sth_registMyChilds
          false
          sth_registDisabled
          false
          sth_mark
          false
          sid
          rightSashForm1
            @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder
            sname
            varTabFolder
            sstyle
            TOP
            sBORDER
            false
            sFLAT
            false
            sCLOSE
            false
            sSINGLE
            false
            sMRUVisible
            false
            ssimple
            false
            sH_SCROLL
            false
            sV_SCROLL
            false
            sNO_BACKGROUND
            false
            sNO_FOCUS
            false
            sNO_MERGE_PAINTS
            false
            sNO_REDRAW_RESIZE
            false
            sNO_RADIO_GROUP
            false
            sEMBEDDED
            false
            sDOUBLE_BUFFERED
            false
            scapture
            false
            senabled
            true
            sredraw
            true
            svisible
            true
            sdescriptors
            xworker.swt.Widgets/@CTabFolder
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            varTabFolder
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem
              sname
              varsTabItem
              stext
              变量
              sCLOSE
              false
              sdescriptors
              xworker.swt.custom.CTabFolder/@CTabItem
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              varsTabItem
                @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm
                sname
                varSashForm
                sstyle
                VERTICAL
                sSMOOTH
                false
                sweights
                40,20
                sBORDER
                false
                sH_SCROLL
                false
                sV_SCROLL
                false
                sNO_BACKGROUND
                false
                sNO_FOCUS
                false
                sNO_MERGE_PAINTS
                false
                sNO_REDRAW_RESIZE
                false
                sNO_RADIO_GROUP
                false
                sEMBEDDED
                false
                sDOUBLE_BUFFERED
                false
                scapture
                false
                senabled
                true
                sredraw
                true
                svisible
                true
                sdescriptors
                xworker.swt.Widgets/@SashForm
                sid
                rightSashForm
                  @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite
                  sname
                  dataTreeComposite
                  sBORDER
                  false
                  sH_SCROLL
                  false
                  sV_SCROLL
                  false
                  sNO_BACKGROUND
                  false
                  sNO_FOCUS
                  false
                  sNO_MERGE_PAINTS
                  false
                  sNO_REDRAW_RESIZE
                  false
                  sNO_RADIO_GROUP
                  false
                  sEMBEDDED
                  false
                  sDOUBLE_BUFFERED
                  false
                  scapture
                  false
                  senabled
                  true
                  sredraw
                  true
                  svisible
                  true
                  sdescriptors
                  xworker.swt.Widgets/@Composite
                  sid
                  dataTreeComposite
                    @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTreeCompositeGridData
                    sname
                    dataTreeCompositeGridLayout
                    snumColumns
                    2
                    smakeColumnsEqualWidth
                    false
                    smarginWidth
                    0
                    smarginHeight
                    0
                    smarginLeft
                    0
                    smarginTop
                    0
                    smarginRight
                    0
                    smarginBottom
                    0
                    shorizontalSpacing
                    0
                    sverticalSpacing
                    0
                    slabel
                    dataTreeCompositeGridLayout
                    sdescriptors
                    xworker.swt.Layouts/@GridLayout
                    sid
                    dataTreeCompositeGridData
                    @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree
                    sname
                    dataTree
                    sselectStyle
                    SINGLE
                    sV_SCROLL
                    true
                    sH_SCROLL
                    true
                    sCHECK
                    false
                    sFULL_SELECTION
                    true
                    sHIDE_SELECTION
                    true
                    sBORDER
                    true
                    slineVisible
                    true
                    smultipleColumns
                    true
                    sheaderVisible
                    true
                    ssortIndicator
                    true
                    smoveableColumns
                    true
                    sheadImages
                    false
                    ssubImages
                    false
                    scheckSelection
                    false
                    slabel
                    dataTree
                    sdescriptors
                    xworker.swt.Widgets/@Tree
                    sid
                    dataTree
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree/@fieldNameColumn
                      sname
                      fieldNameColumn
                      stext
                      Name
                      swidth
                      200
                      slabel
                      fieldNameColumn
                      sdescriptors
                      xworker.swt.widgets.Tree/@TreeColumn
                      sid
                      fieldNameColumn
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree/@fieldValueColumn
                      sname
                      fieldValueColumn
                      stext
                      Value
                      swidth
                      300
                      slabel
                      fieldValueColumn
                      sdescriptors
                      xworker.swt.widgets.Tree/@TreeColumn
                      sid
                      fieldValueColumn
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree/@fieldClassColumn
                      sname
                      fieldClassColumn
                      stext
                      Type
                      swidth
                      300
                      slabel
                      fieldClassColumn
                      sdescriptors
                      xworker.swt.widgets.Tree/@TreeColumn
                      sid
                      fieldClassColumn
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree/@listeners
                      sname
                      listeners
                      slabel
                      listeners
                      sdescriptors
                      xworker.swt.events.Listeners/@listeners
                      sid
                      listeners
                        @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree/@listeners/@dataTreeSelection
                        sname
                        dataTreeSelection
                        stype
                        Selection
                        sref
                        xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@eventHandler
                        slabel
                        dataTreeSelection
                        sdescriptors
                        xworker.swt.events.Listeners/@listeners/@Listener
                        sid
                        dataTreeSelection
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@dataTreeComposite/@dataTree/@dataTreeGridData
                      sname
                      dataTreeGridData
                      sstyle
                      FILL_BOTH
                      shorizontalIndent
                      0
                      swidth
                      -1
                      sheight
                      -1
                      shorizontalAlignment
                      BEGINNING
                      sverticalAlignment
                      CENTER
                      shorizontalSpan
                      2
                      sverticalSpan
                      1
                      sgrabExcessHorizontalSpace
                      false
                      sgrabExcessVerticalSpace
                      false
                      slabel
                      dataTreeGridData
                      sdescriptors
                      xworker.swt.layout.LayoutDatas/@GridData
                      sid
                      dataTreeGridData
                  @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@varsTabItem/@rightSashForm/@valueText
                  sname
                  valueText
                  sMOZILLA
                  false
                  slabel
                  valueText
                  sdescriptors
                  xworker.swt.Widgets/@Browser
                  sid
                  valueText
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem
              sname
              codeTabItem
              stext
              脚本
              sCLOSE
              false
              sdescriptors
              xworker.swt.custom.CTabFolder/@CTabItem
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              CTabItem
                @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite
                sname
                codeComposite
                sBORDER
                false
                sH_SCROLL
                false
                sV_SCROLL
                false
                sNO_BACKGROUND
                false
                sNO_FOCUS
                false
                sNO_MERGE_PAINTS
                false
                sNO_REDRAW_RESIZE
                false
                sNO_RADIO_GROUP
                false
                sEMBEDDED
                false
                sDOUBLE_BUFFERED
                false
                scapture
                false
                senabled
                true
                sredraw
                true
                svisible
                true
                sdescriptors
                xworker.swt.Widgets/@Composite
                sinheritDescription
                false
                sth_createIndex
                false
                sth_registMyChilds
                false
                sth_registDisabled
                false
                sth_mark
                false
                sid
                codeComposite
                  @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@codeCompositeGridLayout
                  sname
                  codeCompositeGridLayout
                  smakeColumnsEqualWidth
                  false
                  smarginWidth
                  5
                  smarginHeight
                  5
                  smarginLeft
                  0
                  smarginTop
                  0
                  smarginRight
                  0
                  smarginBottom
                  0
                  shorizontalSpacing
                  5
                  sverticalSpacing
                  5
                  sdescriptors
                  xworker.swt.Layouts/@GridLayout
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  codeCompositeGridLayout
                  @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@codeText1
                  sname
                  codeText
                  sstyle
                  MULTI
                  sH_SCROLL
                  true
                  sV_SCROLL
                  true
                  sWRAP
                  false
                  sREAD_ONLY
                  false
                  sPASSWORD
                  false
                  sSEARCH
                  false
                  sCANCEL
                  false
                  sBORDER
                  false
                  salign
                  LEFT
                  scapture
                  false
                  senabled
                  true
                  sredraw
                  true
                  svisible
                  true
                  sdescriptors
                  xworker.swt.Widgets/@Text
                  sinheritDescription
                  false
                  sth_createIndex
                  false
                  sth_registMyChilds
                  false
                  sth_registDisabled
                  false
                  sth_mark
                  false
                  sid
                  codeText1
                    @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@codeText1/@codeTextGridData
                    sname
                    codeTextGridData
                    sstyle
                    FILL_BOTH
                    shorizontalIndent
                    0
                    swidth
                    -1
                    sheight
                    -1
                    shorizontalAlignment
                    BEGINNING
                    sverticalAlignment
                    CENTER
                    shorizontalSpan
                    1
                    sverticalSpan
                    1
                    sgrabExcessHorizontalSpace
                    false
                    sgrabExcessVerticalSpace
                    false
                    sdescriptors
                    xworker.swt.Commons/@GridData
                    sinheritDescription
                    false
                    sth_createIndex
                    false
                    sth_registMyChilds
                    false
                    sth_registDisabled
                    false
                    sth_mark
                    false
                    sid
                    codeTextGridData
                  @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191
                  sname
                  buttonComposite
                  sBORDER
                  false
                  sH_SCROLL
                  false
                  sV_SCROLL
                  false
                  sNO_BACKGROUND
                  false
                  sNO_FOCUS
                  false
                  sNO_MERGE_PAINTS
                  false
                  sNO_REDRAW_RESIZE
                  false
                  sNO_RADIO_GROUP
                  false
                  sEMBEDDED
                  false
                  sDOUBLE_BUFFERED
                  false
                  scapture
                  false
                  senabled
                  true
                  sredraw
                  true
                  svisible
                  true
                  sdescriptors
                  xworker.swt.Widgets/@Composite
                  sid
                  16191
                    @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16192
                    sname
                    buttonCompositeGridData
                    sstyle
                    FILL_HORIZONTAL
                    shorizontalIndent
                    0
                    swidth
                    -1
                    sheight
                    -1
                    shorizontalAlignment
                    END
                    sverticalAlignment
                    CENTER
                    shorizontalSpan
                    1
                    sverticalSpan
                    1
                    sgrabExcessHorizontalSpace
                    false
                    sgrabExcessVerticalSpace
                    false
                    sdescriptors
                    xworker.swt.layout.LayoutDatas/@GridData
                    sid
                    16192
                    @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16193
                    sname
                    buttonCompositeRowLayout
                    sfill
                    false
                    sjustify
                    false
                    smarginWidth
                    0
                    smarginHeight
                    0
                    smarginLeft
                    3
                    smarginTop
                    3
                    smarginRight
                    3
                    smarginBottom
                    3
                    spack
                    true
                    sspacing
                    3
                    stype
                    SWT.HORIZONTAL
                    swrap
                    true
                    sdescriptors
                    xworker.swt.Layouts/@RowLayout
                    sid
                    16193
                    @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16194
                    sname
                    runButton
                    stext
                    label:xworker.swt.xwidgets.prototypes.ActionContextViewerShell/@resources/@I18nResource/@runButton
                    stype
                    SWT.PUSH
                    sflat
                    false
                    sborder
                    false
                    sselected
                    false
                    scapture
                    false
                    senabled
                    true
                    sredraw
                    true
                    svisible
                    true
                    sdescriptors
                    xworker.swt.Widgets/@Button
                    sth_createIndex
                    false
                    sid
                    16194
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16194/@16195
                      sname
                      RowData
                      sexclude
                      false
                      swidth
                      80
                      sheight
                      -1
                      sdescriptors
                      xworker.swt.layout.LayoutDatas/@RowData
                      sth_createIndex
                      false
                      sid
                      16195
                      @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16194/@16196
                      sname
                      Listeners
                      sdescriptors
                      xworker.swt.widgets.Widget/@Listeners
                      sth_createIndex
                      false
                      sid
                      16196
                        @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16194/@16196/@16197
                        sname
                        runButtonSelection
                        stype
                        Selection
                        sdescriptors
                        xworker.swt.events.Listeners/@listeners/@Listener
                        sth_createIndex
                        false
                        sid
                        16197
                          @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@varTabFolder/@CTabItem/@codeComposite/@16191/@16194/@16196/@16197/@GroovyAction
                          sname
                          GroovyAction
                          sisSynchronized
                          false
                          sthrowException
                          true
                          suseOtherAction
                          false
                          svarScope
                          Local
                          sdisableGlobalContext
                          false
                          Scode
#$@text#$@
import xworker.actions.GroovyAction;

def thing = world.getThing("xworker.ide.worldexplorer.swt.dialogs.GroovyScriptDialog/@scripts/@temp");

//执行代码
thing.set("code", codeText.getText());
if(actionContext.get("actionContextForView") != null){
    thing.getAction().run(actionContextForView);
}else{
    thing.getAction().run(actionContext);
}
#$@text#$@
                          sinterpretationType
                          Action
                          screateLocalVarScope
                          false
                          ssaveReturn
                          false
                          sdebugLog
                          false
                          sdescriptors
                          xworker.lang.actions.Actions/@GroovyAction
                          sinheritDescription
                          false
                          sth_createIndex
                          false
                          sth_registMyChilds
                          false
                          sth_registDisabled
                          false
                          sth_mark
                          false
                          sid
                          GroovyAction
            @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@thingEditorCompoiste
            sname
            thingEditorComposite
            sBORDER
            false
            sH_SCROLL
            false
            sV_SCROLL
            false
            sNO_BACKGROUND
            false
            sNO_FOCUS
            false
            sNO_MERGE_PAINTS
            false
            sNO_REDRAW_RESIZE
            false
            sNO_RADIO_GROUP
            false
            sEMBEDDED
            false
            sDOUBLE_BUFFERED
            false
            scapture
            false
            senabled
            true
            sredraw
            true
            svisible
            true
            sdescriptors
            xworker.swt.Widgets/@Composite
            sinheritDescription
            false
            sth_createIndex
            false
            sth_registMyChilds
            false
            sth_registDisabled
            false
            sth_mark
            false
            sid
            thingEditorCompoiste
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@thingEditorCompoiste/@thingEditor
              sname
              thingEditor
              stitle
              true
              sdescriptors
              xworker.swt.Widgets/@ThingEditor
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              thingEditor
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@thingEditorCompoiste/@thingEditorBlankComposite
              sname
              thingEditorBlankComposite
              sBORDER
              false
              sH_SCROLL
              false
              sV_SCROLL
              false
              sNO_BACKGROUND
              false
              sNO_FOCUS
              false
              sNO_MERGE_PAINTS
              false
              sNO_REDRAW_RESIZE
              false
              sNO_RADIO_GROUP
              false
              sEMBEDDED
              false
              sDOUBLE_BUFFERED
              false
              scapture
              false
              senabled
              true
              sredraw
              true
              svisible
              true
              sdescriptors
              xworker.swt.Widgets/@Composite
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              thingEditorBlankComposite
              @/@shell/@mainComposite/@mainComposite1/@topSashForm/@rightSashForm1/@thingEditorCompoiste/@thingEditorStackLayout
              sname
              thingEditorStackLayout
              stopControl
              thingEditorBlankComposite
              sdescriptors
              xworker.swt.Layouts/@StackLayout
              sinheritDescription
              false
              sth_createIndex
              false
              sth_registMyChilds
              false
              sth_registDisabled
              false
              sth_mark
              false
              sid
              thingEditorStackLayout
      @/@shell/@mainComposite/@actions
      sname
      actions
      slabel
      actions
      sdescriptors
      xworker.swt.Widgets/@actions
      sid
      actions
        @/@shell/@mainComposite/@actions/@eventHandler
        sname
        eventHandler
        slabel
        eventHandler
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;
import org.eclipse.swt.widgets.TreeItem;

import org.xmeta.ActionContext;
import org.xmeta.Bindings;
import org.xmeta.Thing;
import org.xmeta.Action;

import xworker.debug.DebugInfo;
import xworker.debug.Debuger;
import xworker.swt.ActionContainer;

if(actionContext.openActionButton != null){
    openActionButton.setEnabled(false);
}

if(event.widget == dataTree){
    def item = dataTree.getSelection()[0];
    def value = item.getData();
    if(value != null){
        if(value instanceof Thing){
            openValueUrl("do?sc=xworker.ide.worldexplorer.swt.http.ThingDoc/@desc&thing=" + value.metadata.path, false);
        }else{
            try{
                valueText.setText("<pre>" + value + "</pre>");
            }catch(Throwable t){
                valueText.setText("<pre>" + value.getClass() + "</pre>");
            }
        }
        
        if(item.getItems().length == 0){
            def action = world.getAction("xworker.ide.debug.swt.DebugConsole/@shell/@mainComposite/@actions/@initDataTree");
            action.run(actionContext, [
                    "treeItem":item, "value": value, "context":[:]
                ]);
            
            //initDataTree(item, value, [:], actionContext, actions);
        }
    }else{
        valueText.setText("");
    }
    return;
}

if(actionContext.get("threadTree") == null){
    return;
}

if(event.widget == threadTree){
    //println("init threadTree clicked");
    dataTree.removeAll();
    valueText.setText("");
    //infoLabel.setText("dddd");
    
    //设置调试按钮的状态
    def threadTreeItem = getThreadTreeItem(threadTree.getSelection()[0]);
    def thread = threadTreeItem != null ? threadTreeItem.getData() : null;
    if(thread != null && !thread.isAlive()){
        //线程已死
        threadTreeItem.dispose();
        setEditorThing(null);
        return;
    }
    
    def debugInfo = threadTreeItem != null ? Debuger.getDebugInfo(threadTreeItem.getData()) : null;
    if(debugInfo != null && debugInfo instanceof DebugInfo){
        //代码辅助
        if(debugInfo.acitonContext != null){
            //codeAssistor.initCache(debugInfo.acitonContext);
        }
        
        //调试状态
        switch(debugInfo.actionStatus){
            case DebugInfo.ACTION_STATUS_INIT:
                infoLabel.setText("init");
                break;
            case DebugInfo.ACTION_STATUS_SUCCESS:
                infoLabel.setText("success");
                break;
            case DebugInfo.ACTION_STATUS_EXCEPTION:
                infoLabel.setText("exception");
                break;
        }
        traceToolItem.setEnabled(true);
        if(debugInfo.status == DebugInfo.STATUS_RUNNING){
            resumeButton.setEnabled(false);
            suspendButton.setEnabled(true);
            stepoverButton.setEnabled(false);
            stepintoButton.setEnabled(false);
            stepreturnButton.setEnabled(false);
        }else if(debugInfo.isWaitting()){
            resumeButton.setEnabled(true);
            suspendButton.setEnabled(false);
            stepoverButton.setEnabled(true);
            stepintoButton.setEnabled(true);
            stepreturnButton.setEnabled(true);
        }else{
            resumeButton.setEnabled(true);
            suspendButton.setEnabled(false);
            stepoverButton.setEnabled(false);
            stepintoButton.setEnabled(false);
            stepreturnButton.setEnabled(false);
        }

        //traceToolItem图标
        if(debugInfo.isTrace()){
            traceToolItem.setImage(traceStopImg);
        }else{
            traceToolItem.setImage(traceGoImg);
        }
    }else{
        if(actionContext.get("resumeButton") != null){
            resumeButton.setEnabled(false);
            suspendButton.setEnabled(false);
            stepoverButton.setEnabled(false);
            traceToolItem.setEnabled(false);
        }
    }
    
    def context = [:];
    def data = threadTree.getSelection()[0].getData();  
    if(data instanceof Bindings){
        //设置调用者
        def caller = data.getCaller();
        if(caller != null){
            if(caller instanceof Thing){
                //thingViewer.doAction("setThing", actionContext, ["thing": caller]);               
                setEditorThing(caller);
            }else if(caller instanceof Action){
                //thingViewer.doAction("setThing", actionContext, ["thing": caller.getThing()]);
                setEditorThing(caller.getThing());
            }
        }else{
            //thingViewer.doAction("setThing", actionContext, ["thing": null]);          
            setEditorThing(null);
        }
        
        def keys = [];
        for(key in data.keySet()){
            def added = false;       
            for(int i =0; i<keys.size(); i++){            
                if(key < keys.get(i)){
                    keys.add(i, key);
                    added = true;
                    break;
                }        }
            if(!added){
                keys.add(key);
            }        
        }
                
        for(key in keys){
            def value = data.get(key);
            def vcls = value != null ? value.class : "";
            def v = "";
            try{
                v = "" + value;
            }catch(Throwable t){
                v = vcls;
            }
            def treeItem = new TreeItem(dataTree, SWT.NONE);
            treeItem.setText([key, v, "" + vcls] as String[]);
            treeItem.setData(value);
            
            initDataTree(treeItem, value, context, actionContext, actions);
        }
    }else{
        initDataTree(dataTree, data, context, actionContext, actions);
        setEditorThing(null);
    }
}else if(event.widget == resumeButton){
    def threadTreeItem = getThreadTreeItem(threadTree.getSelection()[0]);
    def debugInfo = threadTreeItem != null ? Debuger.getDebugInfo(threadTreeItem.getData()) : null;
    
    threadTreeItem.removeAll();
    if(actionContext.get("resumeButton") != null){ //为兼容ActionContextViewer等，其他情况下可能没有按钮        
        resumeButton.setEnabled(false);
        suspendButton.setEnabled(false);
        stepoverButton.setEnabled(false);
        
        debugInfo.status = DebugInfo.STATUS_RUNNING;
        debugInfo.nextAction = 0;
        debugInfo.finish();
    }
}else if(event.widget == stepoverButton){
    def threadTreeItem = getThreadTreeItem(threadTree.getSelection()[0]);
    def debugInfo = threadTreeItem != null ? Debuger.getDebugInfo(threadTreeItem.getData()) : null;    
    
    threadTreeItem.removeAll();    
    resumeButton.setEnabled(false);
    suspendButton.setEnabled(false);
    stepoverButton.setEnabled(false);

    debugInfo.nextAction = DebugInfo.STEP_OVER;
    debugInfo.finish();
}else if(event.widget == stepintoButton){
    def threadTreeItem = getThreadTreeItem(threadTree.getSelection()[0]);
    def debugInfo = threadTreeItem != null ? Debuger.getDebugInfo(threadTreeItem.getData()) : null;    
    
    threadTreeItem.removeAll();    
    resumeButton.setEnabled(false);
    suspendButton.setEnabled(false);
    stepoverButton.setEnabled(false);

    debugInfo.nextAction = DebugInfo.STEP_INTO;
    debugInfo.finish();
}else if(event.widget == stepreturnButton){
    def threadTreeItem = getThreadTreeItem(threadTree.getSelection()[0]);
    def debugInfo = threadTreeItem != null ? Debuger.getDebugInfo(threadTreeItem.getData()) : null;    
    
    threadTreeItem.removeAll();    
    resumeButton.setEnabled(false);
    suspendButton.setEnabled(false);
    stepoverButton.setEnabled(false);

    debugInfo.nextAction = DebugInfo.STEP_RETURN;
    debugInfo.finish();
}else if(event.widget == suspendButton){
    def threadTreeItem = getThreadTreeItem(threadTree.getSelection()[0]);
    def debugInfo = threadTreeItem != null ? Debuger.getDebugInfo(threadTreeItem.getData()) : null;
    if(debugInfo != null){
        resumeButton.setEnabled(true);
        suspendButton.setEnabled(false);
        
        debugInfo.status = DebugInfo.STATUS_DEBUG;
        debugInfo.nextAction = 0;
    }
}

//返回与线程绑定的调试信息
def getThreadTreeItem(treeItem){
    if(treeItem == null){
        return null;
    }
    
    def data = treeItem.getData();
    if(data instanceof Thread){
        return treeItem;
    }else if(data instanceof ThreadGroup){
        return null;
    }else{
        return getThreadTreeItem(treeItem.parentItem);
    }
}

//初始化数据树节点
def initDataTree(treeItem, value, context, actionContext, actions){
    actions.doAction("initDataTree", actionContext, [
        "treeItem":treeItem, "value": value, "context":context
    ]);
    return;   
}

def addChild(childs, child){
    for(int i=0; i<childs.size(); i++){
        def c = childs.get(i);
        if(child.name < c.name){
            childs.add(i, child);
            return;
        }else if(child.name == c.name){
            childs.set(i, child);
            return;
        }
    }
    
    childs.add(child);
}

def openValueUrl(url, isOuterUrl){
    if(isOuterUrl){
        valueText.setUrl(url);
    }else{
        def globalCfg = world.getThing("_local.xworker.config.GlobalConfig");
        valueText.setUrl(globalCfg.webUrl + url);
    }
}

//设置编辑的事物
def setEditorThing(thing){
    if(thing == null){
        thingEditorStackLayout.topControl = thingEditorBlankComposite;
    }else{
        thingEditor.editorActions.doAction("setThing", actionContext, ["thing": thing.getRoot()]);
        thingEditor.editorActions.doAction("selectThing", actionContext, ["thing": thing]);
        thingEditorStackLayout.topControl = thingEditor.mainComposite;
    }
    
    thingEditorComposite.layout();
}
#$@text#$@
        sinterpretationType
        Action
        screateLocalVarScope
        false
        ssaveReturn
        false
        sdebugLog
        false
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        eventHandler
        @/@shell/@mainComposite/@actions/@refresh
        sname
        refresh
        slabel
        refresh
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

ThreadGroup root = Thread.currentThread().getThreadGroup().getParent();
while (root.getParent() != null) {
    root = root.getParent();
}

threadTree.removeAll();
def treeItem = new TreeItem(threadTree, SWT.NONE);
treeItem.setText(root.name);
treeItem.setData(root);
visit(root, threadTree, treeItem);
treeItem.setExpanded(true);

def visit(group, tree, item){
    int numThreads = group.activeCount();
    Thread[] threads = new Thread[numThreads*2];
    numThreads = group.enumerate(threads, false);
    
    // Enumerate each thread in `group'
    for (i in 0..numThreads-1) {
        def thread = threads[i];
        def subItem = new TreeItem(item, SWT.NONE);
        subItem.setData(thread);
        subItem.setText(thread.name);
        subItem.setImage(threadGoImg);
    }
    
    // Get thread subgroups of `group'
    int numGroups = group.activeGroupCount();
    ThreadGroup[] groups = new ThreadGroup[numGroups*2];
    numGroups = group.enumerate(groups, false);
    
    // Recursively visit each subgroup
    if(numGroups > 0){
        for (i in 0..numGroups-1) {
            def subGroup = groups[i]
            def subItem = new TreeItem(item, SWT.NONE);
            subItem.setData(subGroup);
            subItem.setText(subGroup.name);
            visit(groups[i], tree, subItem);
            subItem.setExpanded(true);
        }
    }
}
#$@text#$@
        sinterpretationType
        Action
        screateLocalVarScope
        false
        ssaveReturn
        false
        sdebugLog
        false
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        refresh
        @/@shell/@mainComposite/@actions/@setDebugInfo
        sname
        setDebugInfo
        slabel
        setDebugInfo
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

import org.xmeta.Bindings;

import xworker.debug.Debuger;

//调试按钮失效
resumeButton.setEnabled(false);
suspendButton.setEnabled(false);
stepoverButton.setEnabled(false);
stepintoButton.setEnabled(false);
stepreturnButton.setEnabled(false);

def treeItem = actions.doAction("initThreadTreeItem", actionContext);
if(treeItem != null){
    def topTreeItem = treeItem;
    if(treeItem.getItems().length > 0){
        treeItem = treeItem.getItems()[0];
    }
    threadTree.setSelection(treeItem);
    threadTree.setTopItem(topTreeItem);
    actions.doAction("eventHandler", actionContext, ["event": ["widget": threadTree]]);
}
#$@text#$@
        sinterpretationType
        Action
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        setDebugInfo
        @/@shell/@mainComposite/@actions/@initThreadTreeItem
        sname
        initThreadTreeItem
        slabel
        initThreadTreeItem
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

import org.xmeta.Thing;
import org.xmeta.Action;
import org.xmeta.Bindings;

import xworker.debug.Debuger;

def treeItem = getTreeItem(threadTree, thread);
def debugInfo = Debuger.getDebugInfo(thread);
def debugActionContext = debugInfo.acitonContext;
def scopes = debugInfo.bindings;
treeItem.removeAll();
treeItem.setData("debugInfo", debugInfo);

for(int i=scopes.size() - 1; i>=0; i--){
    def bindings = scopes.get(i);
    def name = "stack-" + i;
    def caller = bindings.getCaller();
    if(caller != null){
        if(caller instanceof Thing){
            name = caller.getMetadata().getLabel() + " (" + caller.getThingName() + ")";
        }else if(caller instanceof Action){
            name = caller.getThing().getMetadata().getLabel() + " (" + caller.getThing().getThingName() + ")";
        }
    }
    createBindingTree(treeItem, bindings, name, i);
}

return treeItem;

//创建一个bindings的树节点
def createBindingTree(treeItem, bindings, name, index){
    if(!(bindings instanceof Bindings)){
        return;
    }
    
    def item = new TreeItem(treeItem, SWT.NONE);
    item.setText([name] as String[]);
    item.setData(bindings);
    
    if(index == 0){
        item.setBackground(globalColor);
    }else if(bindings.isVarScopeFlag()){
        item.setBackground(localColor);
    }
    
    //caller
    //def callerItem = new TreeItem(item, SWT.NONE);
    //callerItem.setText("caller");
    //callerItem.setData(bindings.getCaller());
    
    /*
    def contexts = bindings.getContexts();
    for(key in contexts.keySet()){
        def contextItem = new TreeItem(item, SWT.NONE);
        contextItem.setText(key.metadata.label);
        contextItem.setData(key);
        
        def ac = contexts.get(key);
        def scps = ac.getScopes();
        for(int i=scps.size() - 1; i>=0; i--){
            def bds = scps.get(i);
            createBindingTree(contextItem, bds, "stack-" + i);
        }
    }*/
}

//获取指定线程对应的树节点，如果没有那么创建一个数节点
def getTreeItem(threadTree, thread){
    def trs = [];
    def treeItem = null;
    def obj = thread;
    while(treeItem == null){
        treeItem = findTreeItem(threadTree, obj);
        if(treeItem == null){
            trs.add(obj);
            if(obj instanceof Thread){
                obj = obj.getThreadGroup();
            }else{
                obj = obj.getParent();
            }            
        }
    }

    if(trs.size() > 0){
        for(int i=trs.size() - 1; i>=0; i--){
            treeItem = new TreeItem(treeItem, SWT.NONE);
            treeItem.setText(trs.get(i).name);
            treeItem.setData(trs.get(i));
        }
    }    
    
    return treeItem;
}

// 根据数据内容查找对应的树节点
def findTreeItem(treeItem, data){
    for(item in treeItem.getItems()){
        if(item.getData() == data){
            return item;
        }
        
        def itm = findTreeItem(item, data);
        if(itm != null){
            return itm;
        }
    }
    
    return null;
}
#$@text#$@
        sinterpretationType
        Action
        screateLocalVarScope
        false
        ssaveReturn
        false
        sdebugLog
        false
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        initThreadTreeItem
        @/@shell/@mainComposite/@actions/@initDataTree
        sname
        initDataTree
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;
import org.eclipse.swt.widgets.TreeItem;

import org.xmeta.ActionContext;
import org.xmeta.Bindings;
import org.xmeta.Thing;

import xworker.debug.DebugInfo;
import xworker.debug.Debuger;
import xworker.swt.ActionContainer;

try{
    if(value == null || value.getClass() == null){
        return;
    }
    
    if(context.get(value) != null){
        return;
    }
    context.put(value, value);
    
    def childs = [];
    def fields = value.getClass().fields;
    for(field in fields){
        def child = [:];
        child.name = field.name;
        child.type = "field";
        child.classType = field.getGenericType();
        child.field = field;
        child.value = field.get(value);
        addChild(childs, child);
    }
    
    def methods = value.getClass().methods;
    for(method in methods){
        if(method.name.startsWith("get") && method.getParameterTypes().length == 0){            
            try{
                def name = method.name.substring(3,4).toLowerCase() + method.name.substring(4, method.name.length());
                if(name == null){
                    log.info("name is null " + method.name);
                    continue;
                }

                def child = [:];
                child.name = name;
                child.type ="method";
                child.method = method;
                child.classType = method.getReturnType();
                            
                child.value = method.invoke(value, [] as Object[]);                
                addChild(childs, child);            
            }catch(Throwable e){
                //log.info("get mehtod error " + method.name);
            }
        }
    }

    if(value instanceof ActionContext){
        /*def scopes = value.getScopes();
        for(int i=scopes.size -1; i>=0; i--){
            def child = [:];
            child.name = "stack-" + i;
            child.value = scopes.get(i);
            child.classType = Bindings.class;
            child.type = "field";
            childs.add(child);
            //addChild(childs, child); 
        }*/
    }else if(value instanceof ActionContainer){
        def athing = value.getThing();
        if(athing != null){
            for(acThing in value.getThing().getChilds()){
                def child = [:];
                child.name = acThing.name;
                child.value = acThing;
                child.classType = Thing.class;
                child.type = "field";
                addChild(childs, child);  
            }
        }
    }else if(value instanceof Map){
        def child = [:];
        child.name = "size";
        child.value = value.size();
        child.classType = "int";
        child.type = "field";
        addChild(childs, child);  
        
        for(key in value.keySet()){
            child = [:];
            child.name = "" + key;
            child.value = value.get(key);
            child.type = "field";
            child.type = child.value != null ? child.class : "";
            addChild(childs, child);  
        }
    }else if(value instanceof List || value.class.name.startsWith("[")){
        def child = [:];
        if(value instanceof List){
            child.name = "size";
            child.value = value.size();
        }else{
            child.name = "length";
            child.value = value.length;
        }
        child.classType = "int";
        child.type = "field";
        addChild(childs, child);  
        
        def index = 0;
        for(v in value){
            child = [:];
            child.name = "" + index;
            while(child.name.length() < 4){
                child.name = "0" + child.name;
            }
            index++;
            child.value = v;
            child.type = "field";
            child.type = child.value != null ? child.class : "";
            addChild(childs, child);  
        }
    }
    
    for(child in childs){
        try{            
            def v = child.value;
            def c = child.classType;

            try{
                v = "" + v.toString();
            }catch(Throwable e){
                v = child.classType;
            }
            def item = new TreeItem(treeItem, SWT.NONE);
            item.setText([child.name, "" + v, "" + c] as String[]);
            item.setData(child.value);
                        
            if(child.value != null){      
                if(child.value instanceof Class){
                    continue;
                }      
                //initDataTree(item, child.value, context);
            }
        }catch(Throwable e){
            log.info("init data item error " + child.name);
        }
    }
}catch(Throwable t){
    t.printStackTrace();
}

def addChild(childs, child){
    for(int i=0; i<childs.size(); i++){
        def c = childs.get(i);
        if(child.name < c.name){
            childs.add(i, child);
            return;
        }else if(child.name == c.name){
            childs.set(i, child);
            return;
        }
    }
    
    childs.add(child);
}
#$@text#$@
        sinterpretationType
        Action
        screateLocalVarScope
        false
        ssaveReturn
        false
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        initDataTree
          @/@shell/@mainComposite/@actions/@initDataTree/@ins
          sisValidate
          false
          sname
          ins
          slabel
          ins
          sdescriptors
          xworker.lang.actions.Inout/@ins
          sid
          ins
            @/@shell/@mainComposite/@actions/@initDataTree/@ins/@treeItem
            sname
            treeItem
            stypeCheck
            false
            soptional
            true
            scheck
            false
            scheckLevel
            exception
            sdescriptors
            xworker.lang.actions.Inout/@ins/@param
            sid
            treeItem
            @/@shell/@mainComposite/@actions/@initDataTree/@ins/@value
            sname
            value
            stypeCheck
            false
            soptional
            true
            scheck
            false
            scheckLevel
            exception
            sdescriptors
            xworker.lang.actions.Inout/@ins/@param
            sid
            value
            @/@shell/@mainComposite/@actions/@initDataTree/@ins/@context
            sname
            context
            stypeCheck
            false
            soptional
            true
            scheck
            false
            scheckLevel
            exception
            sdescriptors
            xworker.lang.actions.Inout/@ins/@param
            sid
            context
      @/@shell/@mainComposite/@init
      sname
      init
      slabel
      init
      sisSynchronized
      false
      sthrowException
      true
      suseOtherAction
      false
      svarScope
      Global
      sdisableGlobalContext
      false
      Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;

import xworker.debug.Debuger;
import xworker.debug.DebugInfo;
import xworker.debug.DebugConsole;

infoLabel.setText("");
ThreadGroup root = Thread.currentThread().getThreadGroup().getParent();
while (root.getParent() != null) {
    root = root.getParent();
}

threadTree.removeAll();
def treeItem = new TreeItem(threadTree, SWT.NONE);
treeItem.setText(root.name);
treeItem.setData(root);
treeItem.setImage(threadGroupImg);
visit(root, threadTree, treeItem, actions);
treeItem.setExpanded(true);

//启动debugConsole，定时查看线程的状态
def debugConsole = new DebugConsole(actionContext);
new Thread(debugConsole, "DebugConsole Thread Checker").start();

def visit(group, tree, item, actions){
    int numThreads = group.activeCount();
    Thread[] threads = new Thread[numThreads*2];
    numThreads = group.enumerate(threads, false);
    
    // Enumerate each thread in `group'
    for (i in 0..numThreads-1) {
        def thread = threads[i];
        def subItem = new TreeItem(item, SWT.NONE);
        subItem.setData(thread);
        subItem.setText(thread.name);
        subItem.setImage(threadGoImg);
        
        def debugInfo = Debuger.getDebugInfo(thread);
        if(debugInfo != null){
           //如果当前线程是调试状态且没有初始化堆栈节点，那么初始化          
           if(debugInfo.status == DebugInfo.STATUS_DEBUG && debugInfo.isWaitting()){
               actions.doAction("initThreadTreeItem", ["thread": thread]);
           }
        }
    }
    
    // Get thread subgroups of `group'
    int numGroups = group.activeGroupCount();
    ThreadGroup[] groups = new ThreadGroup[numGroups*2];
    numGroups = group.enumerate(groups, false);
    
    // Recursively visit each subgroup
    if(numGroups > 0){
        for (i in 0..numGroups-1) {
            def subGroup = groups[i]
            def subItem = new TreeItem(item, SWT.NONE);
            subItem.setData(subGroup);
            subItem.setText(subGroup.name);
            subItem.setImage(threadGroupImg);
            visit(groups[i], tree, subItem, actions);
            subItem.setExpanded(true);
        }
    }
}
#$@text#$@
      sinterpretationType
      Action
      screateLocalVarScope
      false
      ssaveReturn
      false
      sdebugLog
      false
      sdescriptors
      xworker.swt.Widgets/@Code
      sid
      init
    @/@shell/@Listeners
    sname
    Listeners
    slabel
    Listeners
    sdescriptors
    xworker.swt.widgets.Widget/@Listeners
    sid
    Listeners
      @/@shell/@Listeners/@shellClose
      sname
      shellClose
      stype
      Close
      slabel
      shellClose
      sdescriptors
      xworker.swt.events.Listeners/@listeners/@Listener
      sid
      shellClose
        @/@shell/@Listeners/@shellClose/@GroovyAction
        sname
        GroovyAction
        sisSynchronized
        false
        sthrowException
        true
        suseOtherAction
        false
        svarScope
        Global
        sdisableGlobalContext
        false
        Scode
#$@text#$@
import xworker.debug.Debuger;
import xworker.debug.DebugInfo;
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.MessageBox;

def debugging = false;
def isCurrentThread = false;
for(childItem in threadTree.getItems()){
    if(hasDebugThread(childItem)){
        debugging = true;
        break;
    }
}	

for(childItem in threadTree.getItems()){
    if(currentThreadDebug(childItem)){
        isCurrentThread = true;
        break;
    }
}

if(isCurrentThread){
    MessageBox box = new MessageBox(shell, SWT.ICON_WARNING | SWT.CANCEL );
    box.setText("操作提示");
    box.setMessage("当前线程正在调试中，不能关闭!");
    box.open();
    event.doit = false;
    
    return false;
}

if(debugging){
    MessageBox box = new MessageBox(shell, SWT.ICON_WARNING | SWT.CANCEL );
    box.setText("操作提示");
    box.setMessage("还有正在调试的线程，不能关闭!");
    event.doit = false;
    box.open();
    
    return false;
//    if(SWT.CANCEL == box.open()){
//        event.doit = false;
//    }
}

return true;

def currentThreadDebug(treeItem){
    def data = treeItem.getData();
    if(data instanceof Thread){
        def debugInfo = Debuger.getDebugInfo(data);
        if(debugInfo.status == DebugInfo.STATUS_DEBUG){
            if(data == Thread.currentThread()){
                return true;
            }else{
                return false;
            }
        }
        
    }else if(data instanceof ThreadGroup){
        for(childItem in treeItem.getItems()){
            if(currentThreadDebug(childItem)){
                return true;
            }
        }
    }
    
    return false;
}

def hasDebugThread(treeItem){
    def data = treeItem.getData();
    if(data instanceof Thread){
        def debugInfo = Debuger.getDebugInfo(data);
        if(debugInfo.status == DebugInfo.STATUS_DEBUG){
            return true;
        }
    }else if(data instanceof ThreadGroup){
        for(childItem in treeItem.getItems()){
            if(hasDebugThread(childItem)){
                return true;
            }
        }
    }
    
    return false;
}
#$@text#$@
        sinterpretationType
        Action
        screateLocalVarScope
        false
        ssaveReturn
        false
        sdescriptors
        xworker.lang.actions.Actions/@GroovyAction
        sid
        GroovyAction
