%1565859071816
@
sname=shell
stext=lang:d=系统通知&en=System Notification
sNO_TRIM=false
sCLOSE=true
sTITLE=true
sMIN=true
sMAX=true
sBORDER=false
sRESIZE=true
sON_TOP=false
sTOOL=false
sNO_FOCUS=false
swidth=1024
sheight=768
scenterScreen=true
spack=false
smaximized=false
sfullScreen=false
sdesign=true
sisIde=false
sdesignDefaultOpen=false
sexitOnDispose=false
sH_SCROLL=false
sV_SCROLL=false
sNO_BACKGROUND=false
sNO_MERGE_PAINTS=false
sNO_REDRAW_RESIZE=false
sNO_RADIO_GROUP=false
sEMBEDDED=false
sDOUBLE_BUFFERED=false
slabel=NotificationManager
scapture=false
senabled=true
sredraw=true
svisible=true
sdescriptors=xworker.swt.widgets.Shell
sinheritDescription=false
sth_createIndex=false
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@shellFillLayout
  sname=shellFillLayout
  stype=SWT.HORIZONTAL
  sdescriptors=xworker.swt.Layouts/@FillLayout
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=shellFillLayout
  @/@mainSashForm
  sname=mainSashForm
  sstyle=HORIZONTAL
  sSMOOTH=false
  sweights=30,70
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  slabel=系统通知
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sen_label=System Notification
  sdescriptors=xworker.swt.Widgets/@SashForm
  sinheritDescription=false
  sth_createIndex=true
  sth_registThing=child|xworker.swt.app.Views
  sth_registMyChilds=false
  sth_registDisabled=false
  sgroup=xworker.ide
  sicon=icons/email.png
  sth_fileMonitor=false
  sth_mark=false
  sid=mainSashForm
    @/@mainSashForm/@resources
    sname=resources
    sdescriptors=xworker.swt.Widgets/@Resource
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=resources
      @/@mainSashForm/@resources/@colorPrimary
      sname=color_primary
      stype=Color
      srgb="#428BCA"
      sdescriptors=xworker.swt.util.Resource/@Color
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=colorPrimary
      @/@mainSashForm/@resources/@color_success
      sname=color_success
      stype=Color
      srgb="#DFF0D8"
      sdescriptors=xworker.swt.util.Resource/@Color
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=color_success
      @/@mainSashForm/@resources/@color_info
      sname=color_info
      stype=Color
      srgb="#D9EDEA"
      sdescriptors=xworker.swt.util.Resource/@Color
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=color_info
      @/@mainSashForm/@resources/@color_warning
      sname=color_warning
      stype=Color
      srgb="#FCF8E3"
      sdescriptors=xworker.swt.util.Resource/@Color
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=color_warning
      @/@mainSashForm/@resources/@color_danger
      sname=color_danger
      stype=Color
      srgb="#F2DEDE"
      sdescriptors=xworker.swt.util.Resource/@Color
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=color_danger
      @/@mainSashForm/@resources/@color_urgent
      sname=color_urgent
      stype=Color
      srgb="#FF0000"
      sdescriptors=xworker.swt.util.Resource/@Color
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=color_urgent
      @/@mainSashForm/@resources/@boldFont
      sname=boldFont
      stype=Font
      sfontData="|10|1|#000000"
      sdescriptors=xworker.swt.util.Resource/@Font
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=boldFont
      @/@mainSashForm/@resources/@normalFont
      sname=normalFont
      stype=Font
      sfontData="|10|0|#000000"
      sdescriptors=xworker.swt.util.Resource/@Font
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=normalFont
      @/@mainSashForm/@resources/@image_primary
      sname=image_primary
      stype=Image
      simageFile=icons/user.png
      sdescriptors=xworker.swt.util.Resource/@Image
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=image_primary
      @/@mainSashForm/@resources/@image_success
      sname=image_success
      stype=Image
      simageFile=icons/user_green.png
      sdescriptors=xworker.swt.util.Resource/@Image
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=image_success
      @/@mainSashForm/@resources/@image_info
      sname=image_info
      stype=Image
      simageFile=icons/user_gray.png
      sdescriptors=xworker.swt.util.Resource/@Image
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=image_info
      @/@mainSashForm/@resources/@image_warning
      sname=image_warning
      stype=Image
      simageFile=icons/user_orange.png
      sdescriptors=xworker.swt.util.Resource/@Image
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=image_warning
      @/@mainSashForm/@resources/@image_danger
      sname=image_danger
      stype=Image
      simageFile=icons/user_red.png
      sdescriptors=xworker.swt.util.Resource/@Image
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=image_danger
      @/@mainSashForm/@resources/@image_urgent
      sname=image_urgent
      stype=Image
      simageFile=icons/user_go.png
      sdescriptors=xworker.swt.util.Resource/@Image
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=image_urgent
    @/@mainSashForm/@eventsComposite
    sname=eventsComposite
    sBORDER=true
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=eventsComposite
      @/@mainSashForm/@eventsComposite/@eventsCompositeGridLayout
      sname=eventsCompositeGridLayout
      smakeColumnsEqualWidth=false
      smarginWidth=5
      smarginHeight=5
      smarginLeft=0
      smarginTop=0
      smarginRight=0
      smarginBottom=0
      shorizontalSpacing=5
      sverticalSpacing=5
      sdescriptors=xworker.swt.Layouts/@GridLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=eventsCompositeGridLayout
      @/@mainSashForm/@eventsComposite/@eventsTable
      sname=eventsTable
      sselectStyle=SINGLE
      sV_SCROLL=true
      sH_SCROLL=true
      sCHECK=false
      sFULL_SELECTION=true
      sHIDE_SELECTION=true
      sBORDER=false
      slineVisible=true
      smultipleColumns=true
      sheaderVisible=true
      ssortIndicator=true
      smoveableColumns=true
      sheadImages=false
      ssubImages=false
      sVIRTUAL=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Table
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=eventsTable
        @/@mainSashForm/@eventsComposite/@eventsTable/@DataStore
        sname=DataStore
        sattachToParent=true
        sloadBackground=false
        sautoLoad=false
        sautoSave=false
        spaging=extend
        spageSize=50
        sstoreSortField=_extend
        sstoreSortDir=ASC
        seditable=extend
        seditmethod=extend
        sdescriptors=xworker.swt.widgets.Table/@DataStore
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=DataStore
          @/@mainSashForm/@eventsComposite/@eventsTable/@DataStore/@dataObjects
          sname=dataObjects
          sdescriptors=xworker.app.view.swt.data.DataStore/@DataObjects
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=dataObjects
            @/@mainSashForm/@eventsComposite/@eventsTable/@DataStore/@dataObjects/@AbstractDataObject
            sname=AbstractDataObject
            seditCols=2
            spaging=false
            snoTotalCount=false
            spagineByCursor=false
            sreadUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@read
            screateUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@create
            supdateUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@update
            sdestroyUrl=do?sc=xworker.app.view.extjs.server.DataObjectStore/@destroy
            LstoreAutoDestroy=false
            sstoreAutoLoad=false
            LstoreAutoSave=true
            LstoreBatch=true
            LstorePruneModifiedRecords=false
            LstoreRemoteSort=false
            LstoreRestful=false
            sstoreRoot='rows'
            sstoreSuccessProperty='success'
            sstoreTotalProperty='totalCount'
            sstoreMessageProperty='msg'
            sgridEditable=false
            sgridEditType=cell
            sformReadUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@read
            sformCreateUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@create
            sformUpdateUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@update
            sformDestroyUrl=do?sc=xworker.app.view.extjs.server.DataObjectForm/@delete
            spaging_afterPageText=页 共
            spaging_beforePageText=第
            Lpaging_displayInfo=false
            spaging_displayMsg=第{0}-第{1}条，共{2}条
            spaging_emptyMsg=没有数据
            spaging_firstText=首页
            spaging_lastText=最后一页
            spaging_nextText=下一页
            Lpaging_prependButtons=false
            spaging_prevText=上一页
            spaging_refreshText=刷新
            sgridColumnLocking=false
            sgridLockText='锁定'
            sgridUnlockText='解锁'
            scolumnGroup=false
            sgridCheckable=false
            sgridRowNumber=false
            sgridGrouping=false
            sgridGroupTextTpl='{text} ({[values.rs.length]} 条)'
            sgridRowExpander=false
            sautoGenerateId=false
            sidGenerateType=action
            sidAction=generateId
            sstoreSortDir=ASC
            sautoInit=false
            sautoInitAction=beforeCreate
            scacheRelation=false
            scacheRelationMaxSize=1000
            scacheRelationReadnone=false
            safterCreated=false
            sonLoaded=false
            sbeforeUpdate=false
            safterUpdated=false
            sbeforeDelete=false
            safterDeleted=false
            safterQueryed=false
            sshowUserTask=false
            sdescriptors=xworker.dataObject.DataObjects/@AbstractDataObject
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=AbstractDataObject
              @/@mainSashForm/@eventsComposite/@eventsTable/@DataStore/@dataObjects/@AbstractDataObject/@name
              sname=name
              slabel=名称
              stype=string
              soptional=true
              skey=false
              sdataField=true
              sviewField=true
              sreadField=true
              screateEditor=true
              seditEditor=true
              sviewEditor=true
              sgridEditor=true
              squeryEditor=true
              sreadOnly=false
              seditable=true
              sdisabled=false
              sshowLabel=true
              slabelAlign=right
              slabelVAlign=baseline
              svalidateAllowBlank=true
              LvalidateOnBlur=true
              LallowDecimals=true
              LallowNegative=true
              sshowInTable=true
              sgridWidth=250
              sdisplayRelationLabel=false
              sgridFixed=false
              sgridHidden=false
              sgridHideable=true
              sgridSortable=false
              scolumnLocked=false
              sgridGroupable=true
              sgridMenuDisabled=false
              sgridResizable=true
              sen_label=Name
              sdescriptors=xworker.dataObject.AbstractDataObject/@attribute
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=name
              @/@mainSashForm/@eventsComposite/@eventsTable/@DataStore/@dataObjects/@AbstractDataObject/@createTime
              sname=createTime
              slabel=创建时间
              stype=string
              soptional=true
              skey=false
              sdataField=true
              sviewField=true
              sreadField=true
              screateEditor=true
              seditEditor=true
              sviewEditor=true
              sgridEditor=true
              squeryEditor=true
              sreadOnly=false
              seditable=true
              sdisabled=false
              sshowLabel=true
              slabelAlign=right
              slabelVAlign=baseline
              svalidateAllowBlank=true
              LvalidateOnBlur=true
              LallowDecimals=true
              LallowNegative=true
              sshowInTable=true
              sdisplayRelationLabel=false
              sgridFixed=false
              sgridHidden=false
              sgridHideable=true
              sgridSortable=false
              scolumnLocked=false
              sgridGroupable=true
              sgridMenuDisabled=false
              sgridResizable=true
              sen_label=Create Time
              sdescriptors=xworker.dataObject.AbstractDataObject/@attribute
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=createTime
              @/@mainSashForm/@eventsComposite/@eventsTable/@DataStore/@dataObjects/@AbstractDataObject/@expireTime
              sname=expireTime
              slabel=失效时间
              stype=string
              soptional=true
              skey=false
              sdataField=true
              sviewField=true
              sreadField=true
              screateEditor=true
              seditEditor=true
              sviewEditor=true
              sgridEditor=true
              squeryEditor=true
              sreadOnly=false
              seditable=true
              sdisabled=false
              sshowLabel=true
              slabelAlign=right
              slabelVAlign=baseline
              svalidateAllowBlank=true
              LvalidateOnBlur=true
              LallowDecimals=true
              LallowNegative=true
              sshowInTable=true
              sdisplayRelationLabel=false
              sgridFixed=false
              sgridHidden=false
              sgridHideable=true
              sgridSortable=false
              scolumnLocked=false
              sgridGroupable=true
              sgridMenuDisabled=false
              sgridResizable=true
              sen_label=Expired Time
              sdescriptors=xworker.dataObject.AbstractDataObject/@attribute
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=expireTime
        @/@mainSashForm/@eventsComposite/@eventsTable/@eventsTableGridData
        sname=eventsTableGridData
        sstyle=FILL_BOTH
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=BEGINNING
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=eventsTableGridData
        @/@mainSashForm/@eventsComposite/@eventsTable/@Listeners
        sname=Listeners
        sdescriptors=xworker.swt.widgets.Widget/@Listeners
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=Listeners
          @/@mainSashForm/@eventsComposite/@eventsTable/@Listeners/@eventsTableSelection
          sname=eventsTableSelection
          stype=Selection
          sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=eventsTableSelection
            @/@mainSashForm/@eventsComposite/@eventsTable/@Listeners/@eventsTableSelection/@GroovyAction
            sname=GroovyAction
            sisSynchronized=false
            sthrowException=true
            suseOtherAction=false
            svarScope=Local
            sdisableGlobalContext=false
            Scode=
#$@text#$@
import org.xmeta.ActionContext;
import xworker.notification.NotificationManager;
import org.eclipse.swt.custom.CTabItem;
import org.eclipse.swt.SWT;

//获取事件
def ev = event.item.getData();

//设置字体和已阅
if(ev.isViewed() == false){
    ev.setViewed();
    event.item.setFont(normalFont);
    
    //通知消息变更
    NotificationManager.fireUpdateEvent(ev);
}

//到界面
def have = false;
for(item in mainTabFolder.getItems()){
    if(item.getData() == ev){
        have = true;
        mainTabFolder.setSelection(item);
        break;
    }
}
if(!have){
    /*    
    notification继承Message，Message在create时会使用新的变量上下文
    def ac = new ActionContext();
    ac.put("parent", mainTabFolder);
    ac.put("notification", ev);
    ac.put("parentContext", actionContext);
    ac.put("messageContext", ev.actionContext);
    ac.putAll(ev.getVariables());*/
    
    def item = new CTabItem(mainTabFolder, SWT.NONE);
    item.setText(ev.getLabel());
    item.setData(ev);
    
    actionContext.put("parent", mainTabFolder);
    ev.getMessage().putVariable("notification", ev);
    def control = ev.getMessage().create(actionContext);
    item.setControl(control);
    mainTabFolder.setSelection(item);
    
    //def control = ev.thing.doAction("create", ac);

}
#$@text#$@
            sinterpretationType=Action
            screateLocalVarScope=false
            ssaveReturn=false
            sdebugLog=false
            sdescriptors=xworker.lang.actions.Actions/@GroovyAction
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=GroovyAction
      @/@mainSashForm/@eventsComposite/@1312
      sname=buttonComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sid=1312
        @/@mainSashForm/@eventsComposite/@1312/@1313
        sname=buttonCompositeGridData
        sstyle=FILL_HORIZONTAL
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=END
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sid=1313
        @/@mainSashForm/@eventsComposite/@1312/@1314
        sname=buttonCompositeRowLayout
        sfill=false
        sjustify=false
        smarginWidth=0
        smarginHeight=0
        smarginLeft=3
        smarginTop=3
        smarginRight=3
        smarginBottom=3
        spack=true
        sspacing=3
        stype=SWT.HORIZONTAL
        swrap=true
        sdescriptors=xworker.swt.Layouts/@RowLayout
        sid=1314
        @/@mainSashForm/@eventsComposite/@1312/@1315
        sname=clearReadedButton
        stext=lang:d=清空已读消息&en=Clear Readed Notification
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=1315
          @/@mainSashForm/@eventsComposite/@1312/@1315/@1317
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=1317
            @/@mainSashForm/@eventsComposite/@1312/@1315/@1317/@1318
            sname=clearReadedButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=1318
              @/@mainSashForm/@eventsComposite/@1312/@1315/@1317/@1318/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import xworker.notification.NotificationManager;

for(notification in NotificationManager.getNotifications()){
    if(notification.isViewed()){
        NotificationManager.removeNotification(notification);
    }
}
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
    @/@mainSashForm/@mainTabFolder
    sname=mainTabFolder
    sstyle=TOP
    sBORDER=true
    sFLAT=false
    sCLOSE=true
    sSINGLE=false
    sMRUVisible=false
    ssimple=false
    sdisposeControlOnItemClosed=true
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@CTabFolder
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=mainTabFolder
    @/@mainSashForm/@actions
    sname=actions
    sdescriptors=xworker.swt.Widgets/@actions
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=actions
      @/@mainSashForm/@actions/@eventAdded
      sname=eventAdded
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;

//创建
actions.doAction("createEventItem", actionContext, "index", 0);
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=eventAdded
      @/@mainSashForm/@actions/@eventRemoved
      sname=eventRemoved
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
for(item in eventsTable.getItems()){
    if(item.getData() == notification){
        item.dispose();
        break;
    }
}

for(item in mainTabFolder.getItems()){
    if(item.getData() == notification){
        item.getControl().dispose();
        item.dispose();
        break;
    }
}
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=eventRemoved
      @/@mainSashForm/@actions/@createEventItem
      sname=createEventItem
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;

//创建条目
def item = null;
if(actionContext.get("index") != null){
    item = new TableItem(eventsTable, SWT.NONE, index);
}else{
    item = new TableItem(eventsTable, SWT.NONE);
}
item.setText(notification.getTableLabels());
item.setData(notification);

//设置颜色
def level = notification.getLevel();
def color = actionContext.get("color_" + level);
if(color != null){
    item.setBackground(color);
}

def image = actionContext.get("image_" + level);
if(image != null){
    item.setImage(image);
}

//设置字体，粗体未阅读
if(notification.isViewed()){
    item.setFont(normalFont);
}else{
    item.setFont(boldFont);
}
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=createEventItem
      @/@mainSashForm/@actions/@ideInit
      sname=ideInit
      sunimplementedException=false
      sdescriptors=xworker.lang.actions.Actions/@NOOP
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=ideInit
      @/@mainSashForm/@actions/@updated
      sname=updated
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
for(item in eventsTable.getItems()){
    def notification = item.getData();
    item.setText(notification.getTableLabels());
}
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=updated
      @/@mainSashForm/@actions/@doInit
      sname=doInit
      sunimplementedException=false
      sdescriptors=xworker.lang.actions.Actions/@NOOP
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=doInit
      @/@mainSashForm/@actions/@getSimpleTitle
      sname=getSimpleTitle
      sunimplementedException=false
      sdescriptors=xworker.lang.actions.Actions/@NOOP
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=getSimpleTitle
      @/@mainSashForm/@actions/@getTitle
      sname=getTitle
      sunimplementedException=false
      sdescriptors=xworker.lang.actions.Actions/@NOOP
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=getTitle
      @/@mainSashForm/@actions/@getOutline
      sname=getOutline
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
//println "getOutline=" + actionContext.get("outlineBrowser");
return outlineBrowser;
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=getOutline
      @/@mainSashForm/@actions/@isDirty
      sname=isDirty
      sunimplementedException=false
      sdescriptors=xworker.lang.actions.Actions/@NOOP
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=isDirty
    @/@mainSashForm/@init
    sname=init
    sisSynchronized=false
    sthrowException=true
    suseOtherAction=false
    svarScope=Local
    sdisableGlobalContext=false
    Scode=
#$@text#$@
import xworker.notification.NotificationManager;
import xworker.notification.SwtNotificationManagerListener;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;

//显示已有的事件列表
def notifications = NotificationManager.getNotifications();
for(notification in notifications){
    //创建
    actions.doAction("createEventItem", actionContext, "notification",notification, "index", null);
}

//添加事件监听
def listenerThing = world.getThing("xworker.notification.NotificationManagerListener");
def listener = new SwtNotificationManagerListener(listenerThing, actionContext);
NotificationManager.addListener(listener);
_g.put("notificationManagerListener", listener);

//创建Outline
createOutline(actionContext);

//println "outlineBrowser=" + actionContext.get("outlineBrowser");
#$@text#$@
    sinterpretationType=Action
    screateLocalVarScope=false
    ssaveReturn=false
    sdebugLog=false
    sdescriptors=xworker.swt.widgets.Widget/@Code
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=init
      @/@mainSashForm/@init/@ActionDefined
      sname=ActionDefined
      sdescriptors=xworker.lang.actions.Inout/@ActionDefined
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=ActionDefined
        @/@mainSashForm/@init/@ActionDefined/@createOutline
        sname=createOutline
        soutlineBrowserUrl=descurl:xworker.notification.NotificationManager/@mainSashForm/@systemEvent
        snewActionContext=false
        sinterpretationType=Self
        sattributeTemplate=false
        schildsAttributeTemplate=false
        svarScope=Local
        sisSynchronized=false
        sthrowException=true
        suseOtherAction=false
        screateLocalVarScope=false
        ssaveReturn=false
        sdisableGlobalContext=false
        sdebugLog=false
        sdescriptors=xworker.swt.app.AppActions/@CreateOutline
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_fileMonitor=false
        sth_mark=false
        sid=createOutline
    @/@mainSashForm/@systemEvent
    sname=systemEvent
    sregistThing=xworker.notification.NotificationManager/@mainSashForm/@systemEvent
    sregistType=notes
    spriority=0
    Sdescription=
#$@text#$@
<h1>系统通知</h1>

<p>&nbsp;&nbsp;&nbsp;&nbsp;系统通知一般是一些需要用户及时处理的信息。</p>

<h2>过期时间</h2>

<p>&nbsp;&nbsp;&nbsp; 系统通知有过期时间，过期的通知会自动删除。如果通知的过期时间设置为&lt;=0，那么表示永不过期。</p>
#$@text#$@
    sdescriptors=xworker.swt.Widgets/@InteractiveUI
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=systemEvent
    @/@mainSashForm/@RunAction
    sname=RunAction
    sdescriptors=xworker.swt.widgets.Widget/@RunAction
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_fileMonitor=false
    sth_mark=false
    sid=RunAction
      @/@mainSashForm/@RunAction/@CheckUrgentTask
      sname=CheckUrgentTask
      slabel=检查紧急通知的任务
      sgroup=xworker.system.notification
      senable=true
      scallback=false
      scallbackCancel=false
      ssingleInstance=false
      ssaveAsGlobalVar=false
      sschedule=true
      speriod=30000
      sfixedRate=false
      stimeUnit=MILLISECONDS
      sfixTime=false
      scalculatePassCount=false
      sinterpretationType=Self
      sattributeTemplate=false
      schildsAttributeTemplate=false
      svarScope=Local
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      screateLocalVarScope=false
      ssaveReturn=false
      sdisableGlobalContext=false
      sdebugLog=false
      sdescriptors=xworker.lang.actions.Actions/@Task
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_fileMonitor=false
      sth_mark=false
      sid=CheckUrgentTask
        @/@mainSashForm/@RunAction/@CheckUrgentTask/@actions
        sname=actions
        sdescriptors=xworker.lang.task.Task/@actions1
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_fileMonitor=false
        sth_mark=false
        sid=actions
          @/@mainSashForm/@RunAction/@CheckUrgentTask/@actions/@doTask
          sname=doTask
          swidgetForDisplay=var:mainSashForm
          stype=async
          scancelTaskOnWidgetDisposed=true
          sinterpretationType=Self
          sattributeTemplate=false
          schildsAttributeTemplate=false
          svarScope=Local
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          screateLocalVarScope=false
          ssaveReturn=false
          sdisableGlobalContext=false
          sdebugLog=false
          sdescriptors=xworker.swt.actions.DisplayActions/@DisplayExec
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_fileMonitor=false
          sth_mark=false
          sid=doTask
            @/@mainSashForm/@RunAction/@CheckUrgentTask/@actions/@doTask/@actions
            sname=actions
            sdescriptors=xworker.swt.actions.DisplayActions/@DisplayExec/@actions
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_fileMonitor=false
            sth_mark=false
            sid=actions
              @/@mainSashForm/@RunAction/@CheckUrgentTask/@actions/@doTask/@actions/@doAction
              sname=doAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import xworker.notification.NotificationManager;

def hasUrgent = false;
def notis = NotificationManager.getNotifications();
for(not in notis){
    if(not.isViewed() == false && not.getLevel() == "urgent"){
        hasUrgent = true;
        break;
    }
}

if(hasUrgent){
   sysNotify​(actionContext);
}
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_fileMonitor=false
              sth_mark=false
              sid=doAction
                @/@mainSashForm/@RunAction/@CheckUrgentTask/@actions/@doTask/@actions/@doAction/@ActionDefined
                sname=ActionDefined
                sdescriptors=xworker.lang.actions.Inout/@ActionDefined
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_fileMonitor=false
                sth_mark=false
                sid=ActionDefined
                  @/@mainSashForm/@RunAction/@CheckUrgentTask/@actions/@doTask/@actions/@doAction/@ActionDefined/@notify​
                  sname=sysNotify​
                  stitle=XWorker
                  stheme=YELLOW_THEME
                  stext=lang:d=有紧急的系统消息未处理！&en=Emergency system messages not processed!
                  sinterpretationType=Self
                  sattributeTemplate=false
                  schildsAttributeTemplate=false
                  svarScope=Local
                  sisSynchronized=false
                  sthrowException=true
                  suseOtherAction=false
                  screateLocalVarScope=false
                  ssaveReturn=false
                  sdisableGlobalContext=false
                  sdebugLog=false
                  sdescriptors=xworker.swt.model.NebulaActions/@notify​
                  sinheritDescription=false
                  sth_createIndex=false
                  sth_registMyChilds=false
                  sth_registDisabled=false
                  sth_fileMonitor=false
                  sth_mark=false
                  sid=notify​
