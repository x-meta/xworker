^1468164968114
@
sname
shell
stext
Template
sstyle
APPLICATION_MODAL
sNO_TRIM
false
sCLOSE
true
sTITLE
true
sMIN
true
sMAX
true
sBORDER
false
sRESIZE
true
sON_TOP
false
sTOOL
false
sNO_FOCUS
false
swidth
850
sheight
640
scenterScreen
true
spack
false
smaximized
false
sfullScreen
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
slabel
ThingExamleTemplateSelector
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sdescriptors
xworker.swt.widgets.Shell,xworker.swt.widgets.Display/@Shell
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
@/@FillLayout
sname
FillLayout
stype
SWT.HORIZONTAL
slabel
FillLayout
sdescriptors
xworker.swt.Layouts/@FillLayout
sid
FillLayout
@/@mainComposite
sname
mainComposite
sBORDER
true
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sdescriptors
xworker.swt.Widgets/@Composite
sid
mainComposite
@/@mainComposite/@templateComposite
sname
templateComposite
sBORDER
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sdescriptors
xworker.swt.Widgets/@Composite
sid
templateComposite
@/@mainComposite/@templateComposite/@templateGridLayout
sname
templateGridLayout
smakeColumnsEqualWidth
false
smarginWidth
5
smarginHeight
5
smarginLeft
0
smarginTop
0
smarginRight
0
smarginBottom
0
shorizontalSpacing
5
sverticalSpacing
5
slabel
templateGridLayout
sdescriptors
xworker.swt.Layouts/@GridLayout
sid
templateGridLayout
@/@mainComposite/@templateComposite/@templateWordsEditor
sname
templateWordsEditor
sdescriptors
xworker.swt.Widgets/@ThingEditor
sid
templateWordsEditor
@/@mainComposite/@templateComposite/@templateWordsEditor/@templteWorldEditorGridData
sname
templteWorldEditorGridData
sstyle
FILL_BOTH
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
BEGINNING
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
sxw_cl_global
false
slabel
templteWorldEditorGridData
sdescriptors
xworker.swt.Commons/@GridData
sid
templteWorldEditorGridData
@/@mainComposite/@templateComposite/@templateButtonComposite
sname
templateButtonComposite
sBORDER
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sdescriptors
xworker.swt.Widgets/@Composite
sid
templateButtonComposite
@/@mainComposite/@templateComposite/@templateButtonComposite/@templateButtonCompositeGridData
sname
templateButtonCompositeGridData
sstyle
FILL_HORIZONTAL
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
END
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
slabel
templateButtonCompositeGridData
sdescriptors
xworker.swt.layout.LayoutDatas/@GridData
sid
templateButtonCompositeGridData
@/@mainComposite/@templateComposite/@templateButtonComposite/@templateButtonCompositeRowLayout
sname
templateButtonCompositeRowLayout
sfill
false
sjustify
false
smarginWidth
0
smarginHeight
0
smarginLeft
3
smarginTop
3
smarginRight
3
smarginBottom
3
spack
true
sspacing
3
stype
SWT.HORIZONTAL
swrap
true
slabel
templateButtonCompositeRowLayout
sdescriptors
xworker.swt.Layouts/@RowLayout
sid
templateButtonCompositeRowLayout
@/@mainComposite/@templateComposite/@templateButtonComposite/@applyTemplateButton
sname
applyTemplateButton
stext
应用模板
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
slabel
applyTemplateButton
sdescriptors
xworker.swt.Widgets/@Button
sid
applyTemplateButton
@/@mainComposite/@templateComposite/@templateButtonComposite/@applyTemplateButton/@Listeners
sname
Listeners
slabel
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
sid
Listeners
@/@mainComposite/@templateComposite/@templateButtonComposite/@applyTemplateButton/@Listeners/@applyTemplateButtonSelection
sname
applyTemplateButtonSelection
stype
Selection
slabel
applyTemplateButtonSelection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
sid
applyTemplateButtonSelection
@/@mainComposite/@templateComposite/@templateButtonComposite/@applyTemplateButton/@Listeners/@applyTemplateButtonSelection/@GroovyAction
sname
GroovyAction
sisSynchronized
false
sthrowException
false
suseOtherAction
false
svarScope
Global
sdisableGlobalContext
false
Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.MessageBox;

//获取事物编辑器所在的变量上下文ac
def ui = commander.getActionContext().get("ui");
def thingContext = ui.getActionContext();

if(actionContext.get("template") == null){
    log.info("template is null");
    return;
}

def data = templateWordsEditor.editorActions.doAction("getThing");

//取模板
def templateThing = template;
//log.info(templateThing.metadata.path);
def proccessedThing = templateThing.doAction("process", actionContext, ["data":data]);

if(proccessedThing != null){
    def thing = thingContext.currentThing;
    thing.paste(proccessedThing);
    thing.save();
        
    thingContext.actions.doAction("selectThing", ["thing":thing]);

    //刷新编辑概要树
    def action = world.getAction("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@outlineTree/@popMenu/@refreshMenuItem/@listeners/@refreshMenuSelection/@GroovyAction");
    action.run(thingContext);
    
    MessageBox box = new MessageBox(templateComposite.getShell(), SWT.OK | SWT.ICON_INFORMATION);
    box.setText(world.getThing("xworker.ide.worldexplorer.swt.i18n.I18nResource/@common/@operateMessageTitle").metadata.label);
    box.setMessage("模板应用成功！");
    box.open();
}else{
    MessageBox box = new MessageBox(templateComposite.getShell(), SWT.OK | SWT.ICON_INFORMATION);
    box.setText(world.getThing("xworker.ide.worldexplorer.swt.i18n.I18nResource/@common/@operateMessageTitle").metadata.label);
    box.setMessage("模板为空，没有粘贴数据！");
    box.open();
}
#$@text#$@
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sdebugLog
false
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
sid
GroovyAction
@/@mainComposite/@templateComposite/@templateButtonComposite/@cancelTemplateButton
sname
viewExampleButton
stext
查看示例
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
slabel
cancelTemplateButton
sdescriptors
xworker.swt.Widgets/@Button
sid
cancelTemplateButton
@/@mainComposite/@templateComposite/@templateButtonComposite/@cancelTemplateButton/@Listeners
sname
Listeners
slabel
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
sid
Listeners
@/@mainComposite/@templateComposite/@templateButtonComposite/@cancelTemplateButton/@Listeners/@cancelTemplateButtonSelection
sname
cancelTemplateButtonSelection
stype
Selection
slabel
cancelTemplateButtonSelection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
sid
cancelTemplateButtonSelection
@/@mainComposite/@templateComposite/@templateButtonComposite/@cancelTemplateButton/@Listeners/@cancelTemplateButtonSelection/@GroovyAction
sname
GroovyAction
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Global
sdisableGlobalContext
false
Scode
#$@text#$@
mainCompositeStackLayout.topControl = exampleComposite;
mainComposite.layout();
#$@text#$@
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sdebugLog
false
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
sid
GroovyAction
@/@mainComposite/@exampleComposite
sname
exampleComposite
sBORDER
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sdescriptors
xworker.swt.Widgets/@Composite
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
exampleComposite
@/@mainComposite/@exampleComposite/@exampleGridLayout
sname
exampleGridLayout
smakeColumnsEqualWidth
false
smarginWidth
5
smarginHeight
5
smarginLeft
0
smarginTop
0
smarginRight
0
smarginBottom
0
shorizontalSpacing
5
sverticalSpacing
5
sdescriptors
xworker.swt.Layouts/@GridLayout
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
exampleGridLayout
@/@mainComposite/@exampleComposite/@exampleGroup
sname
exampleGroup
stext
示例
sstyle
SHADOW_ETCHED_IN
sBORDER
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sdescriptors
xworker.swt.Widgets/@Group
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
exampleGroup
@/@mainComposite/@exampleComposite/@exampleGroup/@exampleGroupFillLayout
sname
exampleGroupFillLayout
stype
SWT.HORIZONTAL
sxw_cl_global
false
sdescriptors
xworker.swt.Layouts/@FillLayout
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
exampleGroupFillLayout
@/@mainComposite/@exampleComposite/@exampleGroup/@exampleGroupGridData
sname
exampleGroupGridData
sstyle
FILL_BOTH
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
BEGINNING
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
sxw_cl_global
false
sdescriptors
xworker.swt.layout.LayoutDatas/@GridData
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
exampleGroupGridData
@/@mainComposite/@exampleComposite/@3238
sname
buttonComposite
sBORDER
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sdescriptors
xworker.swt.Widgets/@Composite
sid
3238
@/@mainComposite/@exampleComposite/@3238/@3239
sname
buttonCompositeGridData
sstyle
FILL_HORIZONTAL
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
END
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
sdescriptors
xworker.swt.layout.LayoutDatas/@GridData
sid
3239
@/@mainComposite/@exampleComposite/@3238/@3240
sname
buttonCompositeRowLayout
sfill
false
sjustify
false
smarginWidth
0
smarginHeight
0
smarginLeft
3
smarginTop
3
smarginRight
3
smarginBottom
3
spack
true
sspacing
3
stype
SWT.HORIZONTAL
swrap
true
sdescriptors
xworker.swt.Layouts/@RowLayout
sid
3240
@/@mainComposite/@exampleComposite/@3238/@3241
sname
useTemplateButton
stext
使用模板
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sdescriptors
xworker.swt.Widgets/@Button
sth_createIndex
false
sid
3241
@/@mainComposite/@exampleComposite/@3238/@3241/@3242
sname
RowData
sexclude
false
swidth
80
sheight
-1
sdescriptors
xworker.swt.layout.LayoutDatas/@RowData
sth_createIndex
false
sid
3242
@/@mainComposite/@exampleComposite/@3238/@3241/@3243
sname
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
sth_createIndex
false
sid
3243
@/@mainComposite/@exampleComposite/@3238/@3241/@3243/@3244
sname
useTemplateSelection
stype
Selection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
sth_createIndex
false
sid
3244
@/@mainComposite/@exampleComposite/@3238/@3241/@3243/@3244/@GroovyAction
sname
GroovyAction
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.MessageBox;

def g = actionContext.g();
if(g.get("template") == null){
    //模板不存在，直接粘贴事物
    if(g.get("example") == null){
         //示例也不存在
         def box = new MessageBox(mainComposite.getShell(), SWT.ICON_WARNING | SWT.OK);
         box.setText("粘贴示例");
         box.setMessage("没有设置示例，不能粘贴！");
         box.open();
         return;
    }
    
    //获取事物编辑器所在的变量上下文ac
    def ui = commander.getActionContext().get("ui");
    def thingContext = ui.getActionContext();
    
    //粘贴示例到事物
    def thing = thingContext.currentThing;
    if(pasteType == "child"){
        thing.addChild(example.detach());
    }else{
        thing.paste(example.detach());
    }
    thing.save();
        
    thingContext.actions.doAction("selectThing", ["thing":thing]);

    //刷新编辑概要树
    def action = world.getAction("xworker.ide.worldexplorer.swt.dataExplorerParts.ThingEditor/@outlineTree/@popMenu/@refreshMenuItem/@listeners/@refreshMenuSelection/@GroovyAction");
    action.run(thingContext);
    
    MessageBox box = new MessageBox(templateComposite.getShell(), SWT.OK | SWT.ICON_INFORMATION);
    box.setText(world.getThing("xworker.ide.worldexplorer.swt.i18n.I18nResource/@common/@operateMessageTitle").metadata.label);
    box.setMessage("示例粘贴成功！");
    box.open();
}else{
    //使用模板
    mainCompositeStackLayout.topControl = templateComposite;
    mainComposite.layout();
}
#$@text#$@
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sdebugLog
false
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
GroovyAction
@/@mainComposite/@mainCompositeStackLayout
sname
mainCompositeStackLayout
stopControl
exampleComposite
slabel
mainCompositeStackLayout
sdescriptors
xworker.swt.Layouts/@StackLayout
sid
mainCompositeStackLayout
@/@mainComposite/@init
sname
init
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Global
sdisableGlobalContext
false
Scode
#$@text#$@
import org.xmeta.ActionContext;
import org.xmeta.Thing;
import xworker.util.XWorkerUtils;

//======设置模板,data是设置事物===========================
def template = world.getThing(data.getString("templatePath"));
if(template == null){
    template = data.getThing("Template@0");
}

//显示模板
if(template != null){
    def worldDescriptor = template.getThing("InputThing@0");
    if(worldDescriptor != null){
        Thing words = new Thing(worldDescriptor.metadata.path);
        templateWordsEditor.editorActions.doAction("setThing", ["thing":words]);        
    }else{
        Thing words = new Thing();
        templateWordsEditor.editorActions.doAction("setThing", ["thing":words]);        
    }
    actionContext.g().put("template", template);   
}else{
    //log.info("tempalte is null");
    actionContext.g().put("template", null);
    useTemplateButton.setText("粘贴示例");
}

//====初始化示例================
def example = world.getThing(data.getString("examplePath"));
if(example == null){
    def examples = data.getThing("Examples@0");
    if(examples != null && examples.getChilds().size() > 0){
        example = examples.getChilds().get(0);
    }
}

//显示示例
actionContext.g().put("example", example);
if(example != null){
    def type = data.getString("exampleType");
    def ac = new ActionContext();
    ac.put("parent", exampleGroup);
    
    if(type == "composite"){
        //创建面板    
        //example.doAction("create", ac);
        def demoSwt = new Thing("xworker.swt.xwidgets.DemoSWT");
        demoSwt.put("composite", example.getMetadata().getPath());
        demoSwt.doAction("create", ac);
    }else if(type == "webControl" || type == "url"){
        //创建浏览器
        def bthing = world.getThing("xworker.command.selectors.ThingExamleTemplateSelector/@browser");
        bthing.doAction("create", ac);
        def url = "";
        if(type == "webControl"){
            url = XWorkerUtils.getThingDescUrl(example);
        }else{
            url = data.getString("xworker.command.CommandActions/@CrreateDataObjectSelector1/@thingPath");
        }
        ac.browser.setUrl(url);
    }else{
         //默认当作是事物编辑器
         def thingEditor = new Thing("xworker.swt.Widgets/@ThingEditor");
         thingEditor.set("thingPath", example.getMetadata().getPath());
         thingEditor.doAction("create", ac);
    }     
}else{
    //log.info("example is null");   
}

mainCompositeStackLayout.topControl = exampleComposite;
mainComposite.layout();
#$@text#$@
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sdebugLog
false
sdescriptors
xworker.swt.Widgets/@Code
sid
init
@/@browser
sname
browser
sMOZILLA
false
sWEBKIT
false
sjavascriptEnabled
true
sdescriptors
xworker.swt.Widgets/@Browser
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
browser
@/@browser/@UtilBrowser
sname
UtilBrowser
sdescriptors
xworker.swt.browser.Browser/@UtilBrowser
sinheritDescription
false
sth_createIndex
false
sth_registMyChilds
false
sth_registDisabled
false
sth_mark
false
sid
UtilBrowser
