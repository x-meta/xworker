%1624260403501
@
sname=ShellMenu
slabel=菜单
stype=composite
sgroup=1000|窗口
sicon=icons/application.png
sstyledTextForInsert=parentContext.parentContext.codeText
suseTargetThingDoc=false
sen_label=Menu
sen_group=1000|Shell
sdescriptors=xworker.content.QuickContent
sinheritDescription=false
sth_createIndex=true
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@composite
  sname=composite
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.content.QuickContent/@Composite
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=composite
    @/@composite/@resources
    sname=resources
    sdescriptors=xworker.swt.Widgets/@Resource
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=resources
      @/@composite/@resources/@I18nResource
      sname=I18nResource
      sdescriptors=xworker.swt.util.Resource/@I18nResource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=I18nResource
        @/@composite/@resources/@I18nResource/@okButton
        sname=okButton
        slabel=确定
        sen_label=Ok
        sdescriptors=xworker.lang.util.I18nResource/@resource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=okButton
        @/@composite/@resources/@I18nResource/@saveButton
        sname=saveButton
        slabel=保存
        sen_label=Save
        sdescriptors=xworker.lang.util.I18nResource/@resource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=saveButton
        @/@composite/@resources/@I18nResource/@removeButton
        sname=removeButton
        slabel=删除
        sen_label=Delete
        sdescriptors=xworker.lang.util.I18nResource/@resource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=removeButton
    @/@composite/@selectMenuDescriptorCompsoite
    sname=selectDescriptorComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=selectMenuDescriptorCompsoite
      @/@composite/@selectMenuDescriptorCompsoite/@GridLayout
      sname=GridLayout
      smakeColumnsEqualWidth=false
      smarginWidth=5
      smarginHeight=5
      smarginLeft=0
      smarginTop=0
      smarginRight=0
      smarginBottom=0
      shorizontalSpacing=5
      sverticalSpacing=5
      sdescriptors=xworker.swt.Layouts/@GridLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=GridLayout
      @/@composite/@selectMenuDescriptorCompsoite/@createMenuLabel
      sname=createMenuLabel
      sBORDER=false
      stype=HORIZONTAL
      salignment=LEFT
      stext=lang:d=创建菜单&en=Create new menu
      scapture=false
      senabled=true
      sfont="|10|1|#000000"
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Label
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=createMenuLabel
        @/@composite/@selectMenuDescriptorCompsoite/@createMenuLabel/@GridData
        sname=GridData
        sstyle=FILL_HORIZONTAL
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=BEGINNING
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=GridData
      @/@composite/@selectMenuDescriptorCompsoite/@thingRegist
      sname=thingRegist
      sthing=xworker.swt.Menus
      sregistType=child
      sparent=false
      ssearchByKeywords=true
      sshowContent=true
      scontentDisplayType=Composite
      sshowDescBrowser=false
      sdescBrowserRight=false
      sautoLoad=true
      scache=true
      sdescritporForNewThing=xworker.lang.MetaDescriptor3
      sdescritporChilds=false
      sdescriptors=xworker.swt.Widgets/@ThingRegistSelector
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingRegist
        @/@composite/@selectMenuDescriptorCompsoite/@thingRegist/@thingRegistGridData
        sname=thingRegistGridData
        sstyle=FILL_BOTH
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=BEGINNING
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=thingRegistGridData
        @/@composite/@selectMenuDescriptorCompsoite/@thingRegist/@actions
        sname=actions
        sdescriptors=xworker.swt.xworker.ThingRegistSelector/@actions1
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=actions
          @/@composite/@selectMenuDescriptorCompsoite/@thingRegist/@actions/@selected
          sname=selected
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          svarScope=Local
          sdisableGlobalContext=false
          Scode=
#$@text#$@
if(actionContext.get("selectButton") == null){
    return;
}
if(thing == null){
    selectButton.setEnabled(false);
}else{
    selectButton.setEnabled(true);
}
#$@text#$@
          sinterpretationType=Action
          screateLocalVarScope=false
          ssaveReturn=false
          sdebugLog=false
          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=selected
      @/@composite/@selectMenuDescriptorCompsoite/@1030
      sname=buttonComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sid=1030
        @/@composite/@selectMenuDescriptorCompsoite/@1030/@1031
        sname=buttonCompositeGridData
        sstyle=FILL_HORIZONTAL
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=END
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sid=1031
        @/@composite/@selectMenuDescriptorCompsoite/@1030/@1032
        sname=buttonCompositeRowLayout
        sfill=false
        sjustify=false
        smarginWidth=0
        smarginHeight=0
        smarginLeft=3
        smarginTop=3
        smarginRight=3
        smarginBottom=3
        spack=true
        sspacing=3
        stype=SWT.HORIZONTAL
        swrap=true
        sdescriptors=xworker.swt.Layouts/@RowLayout
        sid=1032
        @/@composite/@selectMenuDescriptorCompsoite/@1030/@1033
        sname=selectButton
        stext=lang:d=选择&en=Select
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=false
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=1033
          @/@composite/@selectMenuDescriptorCompsoite/@1030/@1033/@1034
          sname=RowData
          sexclude=false
          swidth=80
          sheight=-1
          sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
          sth_createIndex=false
          sid=1034
          @/@composite/@selectMenuDescriptorCompsoite/@1030/@1033/@1035
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=1035
            @/@composite/@selectMenuDescriptorCompsoite/@1030/@1033/@1035/@1036
            sname=selectButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=1036
              @/@composite/@selectMenuDescriptorCompsoite/@1030/@1033/@1035/@1036/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import org.xmeta.Thing;

//获取描述者
def desc = thingRegist.doAction("getThing", actionContext);
def thing = new Thing(desc.getMetadata().getPath());

//设置新的事物进入编辑
thingEditor.editorActions.doAction("setThing", actionContext, "thing", thing);
stackLayout.topControl = editorComposite;
composite.layout();

actionContext.g().put("menuThing", thing);
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
    @/@composite/@editorComposite
    sname=editorComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=editorComposite
      @/@composite/@editorComposite/@editorCompositeGridLayout
      sname=editorCompositeGridLayout
      smakeColumnsEqualWidth=false
      smarginWidth=5
      smarginHeight=5
      smarginLeft=0
      smarginTop=0
      smarginRight=0
      smarginBottom=0
      shorizontalSpacing=5
      sverticalSpacing=5
      sdescriptors=xworker.swt.Layouts/@GridLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=editorCompositeGridLayout
      @/@composite/@editorComposite/@thingEditor
      sname=thingEditor
      stitle=true
      suseRootThing=false
      sdescriptors=xworker.swt.Widgets/@ThingEditor
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingEditor
        @/@composite/@editorComposite/@thingEditor/@thingEditorGridData
        sname=thingEditorGridData
        sstyle=FILL_BOTH
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=BEGINNING
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.Commons/@GridData
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=thingEditorGridData
      @/@composite/@editorComposite/@2402
      sname=buttonComposite
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Composite
      sid=2402
        @/@composite/@editorComposite/@2402/@2403
        sname=buttonCompositeGridData
        sstyle=FILL_HORIZONTAL
        shorizontalIndent=0
        swidth=-1
        sheight=-1
        shorizontalAlignment=END
        sverticalAlignment=CENTER
        shorizontalSpan=1
        sverticalSpan=1
        sgrabExcessHorizontalSpace=false
        sgrabExcessVerticalSpace=false
        sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
        sid=2403
        @/@composite/@editorComposite/@2402/@2404
        sname=buttonCompositeRowLayout
        sfill=false
        sjustify=false
        smarginWidth=0
        smarginHeight=0
        smarginLeft=3
        smarginTop=3
        smarginRight=3
        smarginBottom=3
        spack=true
        sspacing=3
        stype=SWT.HORIZONTAL
        swrap=true
        sdescriptors=xworker.swt.Layouts/@RowLayout
        sid=2404
        @/@composite/@editorComposite/@2402/@2405
        sname=saveButton
        stext=label:xworker.swtshare.p2017.p06.p15.ShellMenu/@composite/@resources/@I18nResource/@saveButton
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=2405
          @/@composite/@editorComposite/@2402/@2405/@2406
          sname=RowData
          sexclude=false
          swidth=80
          sheight=-1
          sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
          sth_createIndex=false
          sid=2406
          @/@composite/@editorComposite/@2402/@2405/@2407
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=2407
            @/@composite/@editorComposite/@2402/@2405/@2407/@2408
            sname=saveButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=2408
              @/@composite/@editorComposite/@2402/@2405/@2407/@2408/@GroovyAction
              sname=GroovyAction
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              svarScope=Local
              sdisableGlobalContext=false
              Scode=
#$@text#$@
import xworker.swt.design.InjectableComposite;

//获取编辑的菜单
thingEditor.editorActions.doAction("save");

//设置菜单
InjectableComposite.setMenu(menuThing, actionContext);
#$@text#$@
              sinterpretationType=Action
              screateLocalVarScope=false
              ssaveReturn=false
              sdebugLog=false
              sdescriptors=xworker.lang.actions.Actions/@GroovyAction
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=GroovyAction
        @/@composite/@editorComposite/@2402/@2409
        sname=removeButton
        stext=label:xworker.swtshare.p2017.p06.p15.ShellMenu/@composite/@resources/@I18nResource/@removeButton
        stype=SWT.PUSH
        sflat=false
        sborder=false
        sselected=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Button
        sth_createIndex=false
        sid=2409
          @/@composite/@editorComposite/@2402/@2409/@2410
          sname=RowData
          sexclude=false
          swidth=80
          sheight=-1
          sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
          sth_createIndex=false
          sid=2410
          @/@composite/@editorComposite/@2402/@2409/@2411
          sname=Listeners
          sdescriptors=xworker.swt.widgets.Widget/@Listeners
          sth_createIndex=false
          sid=2411
            @/@composite/@editorComposite/@2402/@2409/@2411/@2412
            sname=removeButtonSelection
            stype=Selection
            sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
            sth_createIndex=false
            sid=2412
              @/@composite/@editorComposite/@2402/@2409/@2411/@2412/@confirm
              sname=confirm
              sshell=ognl:removeButton.getShell()
              sicon=ICON_QUESTION
              sbuttons=OK | CANCEL
              stitle=lang:d=删除菜单&en=Remove Menu
              smessage=lang:d=确实要删除菜单吗？&en=Are you sure to remove the menu?
              sinterpretationType=Self
              sattributeTemplate=false
              schildsAttributeTemplate=false
              svarScope=Local
              sisSynchronized=false
              sthrowException=true
              suseOtherAction=false
              screateLocalVarScope=false
              ssaveReturn=false
              sdisableGlobalContext=false
              sdebugLog=false
              sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=confirm
                @/@composite/@editorComposite/@2402/@2409/@2411/@2412/@confirm/@actions
                sname=actions
                sdescriptors=xworker.lang.actions.SelfAction/@actions1
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=actions
                  @/@composite/@editorComposite/@2402/@2409/@2411/@2412/@confirm/@actions/@ok
                  sname=ok
                  sisSynchronized=false
                  sthrowException=true
                  suseOtherAction=false
                  svarScope=Local
                  sdisableGlobalContext=false
                  Scode=
#$@text#$@
def ui = parentContext.parentContext.ui;
def thing = ui.getThing().getData("thing");
println(thing);
#$@text#$@
                  sinterpretationType=Action
                  screateLocalVarScope=false
                  ssaveReturn=false
                  sdebugLog=false
                  sdescriptors=xworker.lang.actions.Actions/@GroovyAction
                  sinheritDescription=false
                  sth_createIndex=false
                  sth_registMyChilds=false
                  sth_registDisabled=false
                  sth_mark=false
                  sid=ok
    @/@composite/@stackLayout
    sname=stackLayout
    stopControl=editorComposite
    sdescriptors=xworker.swt.Layouts/@StackLayout
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=stackLayout
    @/@composite/@init
    sname=init
    sisSynchronized=false
    sthrowException=true
    suseOtherAction=false
    svarScope=Local
    sdisableGlobalContext=false
    Scode=
#$@text#$@
//获取InteractiveUI
def ui = parentContext.parentContext.ui;

//获取事物
def thing = ui.getControl().getData("thing");
def menuc = thing.getThing("Menu@0");
def menu = null;
if(menuc != null && menuc.getChilds().size() > 0){
    menu = menuc.getChilds().get(0);
}
if(menu == null){
    stackLayout.topControl = selectDescriptorComposite;
    composite.layout();
}else{
    thingEditor.editorActions.doAction("setThing", ["thing":menu]);
    stackLayout.topControl = editorComposite;
    composite.layout();
    
    actionContext.g().put("menuThing", menu);
}
#$@text#$@
    sinterpretationType=Action
    screateLocalVarScope=false
    ssaveReturn=false
    sdebugLog=false
    sdescriptors=xworker.swt.widgets.Widget/@Code
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=init
