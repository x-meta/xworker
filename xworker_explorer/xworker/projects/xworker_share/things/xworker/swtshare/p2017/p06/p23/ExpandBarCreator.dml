%1528447802716
@
sname=ExpandBarCreator
slabel=ExpandBar
sgroup=-1400|Widgets,-1600|常用.-1500|容器
sen_group=-1400|Widgets,-1600|Common.-1500|Container
sdescriptors=xworker.swt.design.InjectableControl
sinheritDescription=false
sth_createIndex=true
sth_registThing=control|xworker.swt.design.DesignToolControlIndex
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@Control
  sname=Control
  sdescriptors=xworker.swt.design.InjectableControl/@Control
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=Control
    @/@Control/@Composite
    sname=Composite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.xworker.ThingRegistThing/@Composite
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=Composite
      @/@Control/@Composite/@compositeFillLayout
      sname=compositeFillLayout
      stype=SWT.HORIZONTAL
      sdescriptors=xworker.swt.Layouts/@FillLayout
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=compositeFillLayout
      @/@Control/@Composite/@mainSashForm
      sname=mainSashForm
      sstyle=VERTICAL
      sSMOOTH=false
      sweights=50,50
      sBORDER=false
      sH_SCROLL=false
      sV_SCROLL=false
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@SashForm
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=mainSashForm
        @/@Control/@Composite/@mainSashForm/@tabFolderCompoiste
        sname=tabFolderCompoiste
        sBORDER=false
        sH_SCROLL=false
        sV_SCROLL=false
        sNO_BACKGROUND=false
        sNO_FOCUS=false
        sNO_MERGE_PAINTS=false
        sNO_REDRAW_RESIZE=false
        sNO_RADIO_GROUP=false
        sEMBEDDED=false
        sDOUBLE_BUFFERED=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@Composite
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=tabFolderCompoiste
          @/@Control/@Composite/@mainSashForm/@tabFolderCompoiste/@tabFolderCompositeGridLayout
          sname=tabFolderCompositeGridLayout
          smakeColumnsEqualWidth=false
          smarginWidth=5
          smarginHeight=5
          smarginLeft=0
          smarginTop=0
          smarginRight=0
          smarginBottom=0
          shorizontalSpacing=5
          sverticalSpacing=5
          sdescriptors=xworker.swt.Layouts/@GridLayout
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=tabFolderCompositeGridLayout
          @/@Control/@Composite/@mainSashForm/@tabFolderCompoiste/@tabFolderForm
          sname=mainForm
          sdescriptorThing=xworker.swt.widgets.ExpandBar
          scolumn=1
          sH_SCROLL=true
          sV_SCROLL=true
          sNO_BACKGROUND=false
          sNO_FOCUS=false
          sNO_MERGE_PAINTS=false
          sNO_REDRAW_RESIZE=false
          sNO_RADIO_GROUP=false
          sEMBEDDED=false
          sDOUBLE_BUFFERED=false
          sdescriptors=xworker.swt.Widgets/@ThingForm
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=tabFolderForm
            @/@Control/@Composite/@mainSashForm/@tabFolderCompoiste/@tabFolderForm/@tabFolderFormGridData
            sname=tabFolderFormGridData
            sstyle=FILL_BOTH
            shorizontalIndent=0
            swidth=-1
            sheight=-1
            shorizontalAlignment=BEGINNING
            sverticalAlignment=CENTER
            shorizontalSpan=1
            sverticalSpan=1
            sgrabExcessHorizontalSpace=false
            sgrabExcessVerticalSpace=false
            sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=tabFolderFormGridData
        @/@Control/@Composite/@mainSashForm/@expandBar
        sname=expandBar
        sBORDER=false
        sV_SCROLL=true
        sH_SCROLL=false
        sNO_BACKGROUND=false
        sNO_FOCUS=false
        sNO_MERGE_PAINTS=false
        sNO_REDRAW_RESIZE=false
        sNO_RADIO_GROUP=false
        sEMBEDDED=false
        sDOUBLE_BUFFERED=false
        scapture=false
        senabled=true
        sredraw=true
        svisible=true
        sdescriptors=xworker.swt.Widgets/@ExpandBar
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=expandBar
          @/@Control/@Composite/@mainSashForm/@expandBar/@editItem
          sname=editItem
          sdescriptors=xworker.swt.widgets.ExpandBar/@ExpandItem
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=editItem
            @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite
            sname=editItemComposite
            sBORDER=false
            sH_SCROLL=false
            sV_SCROLL=false
            sNO_BACKGROUND=false
            sNO_FOCUS=false
            sNO_MERGE_PAINTS=false
            sNO_REDRAW_RESIZE=false
            sNO_RADIO_GROUP=false
            sEMBEDDED=false
            sDOUBLE_BUFFERED=false
            scapture=false
            senabled=true
            sredraw=true
            svisible=true
            sdescriptors=xworker.swt.Widgets/@Composite
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=editItemComposite
              @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@editItemCompositeGridLayout
              sname=editItemCompositeGridLayout
              smakeColumnsEqualWidth=false
              smarginWidth=5
              smarginHeight=5
              smarginLeft=0
              smarginTop=0
              smarginRight=0
              smarginBottom=0
              shorizontalSpacing=5
              sverticalSpacing=5
              sdescriptors=xworker.swt.Layouts/@GridLayout
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=editItemCompositeGridLayout
              @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@itemForm
              sname=itemForm
              sdescriptorThing=xworker.swt.custom.CTabFolder/@CTabItem
              scolumn=1
              sH_SCROLL=true
              sV_SCROLL=true
              sNO_BACKGROUND=false
              sNO_FOCUS=false
              sNO_MERGE_PAINTS=false
              sNO_REDRAW_RESIZE=false
              sNO_RADIO_GROUP=false
              sEMBEDDED=false
              sDOUBLE_BUFFERED=false
              sdescriptors=xworker.swt.Widgets/@ThingForm
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=itemForm
                @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@itemForm/@itemFormGridData
                sname=itemFormGridData
                sstyle=FILL_BOTH
                shorizontalIndent=0
                swidth=-1
                sheight=-1
                shorizontalAlignment=BEGINNING
                sverticalAlignment=CENTER
                shorizontalSpan=1
                sverticalSpan=1
                sgrabExcessHorizontalSpace=false
                sgrabExcessVerticalSpace=false
                sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=itemFormGridData
              @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770
              sname=tbuttonComposite
              sBORDER=false
              sH_SCROLL=false
              sV_SCROLL=false
              sNO_BACKGROUND=false
              sNO_FOCUS=false
              sNO_MERGE_PAINTS=false
              sNO_REDRAW_RESIZE=false
              sNO_RADIO_GROUP=false
              sEMBEDDED=false
              sDOUBLE_BUFFERED=false
              scapture=false
              senabled=true
              sredraw=true
              svisible=true
              sdescriptors=xworker.swt.Widgets/@Composite
              sid=24770
                @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24771
                sname=buttonCompositeGridData
                sstyle=FILL_HORIZONTAL
                shorizontalIndent=0
                swidth=-1
                sheight=-1
                shorizontalAlignment=END
                sverticalAlignment=CENTER
                shorizontalSpan=1
                sverticalSpan=1
                sgrabExcessHorizontalSpace=false
                sgrabExcessVerticalSpace=false
                sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
                sid=24771
                @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24772
                sname=buttonCompositeRowLayout
                sfill=false
                sjustify=false
                smarginWidth=0
                smarginHeight=0
                smarginLeft=3
                smarginTop=3
                smarginRight=3
                smarginBottom=3
                spack=true
                sspacing=3
                stype=SWT.HORIZONTAL
                swrap=true
                sdescriptors=xworker.swt.Layouts/@RowLayout
                sid=24772
                @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24773
                sname=updateButton
                stext=lang:d=更新&en=Update
                stype=SWT.PUSH
                sflat=false
                sborder=false
                sselected=false
                scapture=false
                senabled=true
                sredraw=true
                svisible=true
                sdescriptors=xworker.swt.Widgets/@Button
                sth_createIndex=false
                sid=24773
                  @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24773/@24774
                  sname=RowData
                  sexclude=false
                  swidth=80
                  sheight=-1
                  sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
                  sth_createIndex=false
                  sid=24774
                  @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24773/@24775
                  sname=Listeners
                  sdescriptors=xworker.swt.widgets.Widget/@Listeners
                  sth_createIndex=false
                  sid=24775
                    @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24773/@24775/@24776
                    sname=saveButtonSelection
                    stype=Selection
                    sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
                    sth_createIndex=false
                    sid=24776
                      @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24773/@24775/@24776/@GroovyAction
                      sname=GroovyAction
                      sisSynchronized=false
                      sthrowException=true
                      suseOtherAction=false
                      svarScope=Local
                      sdisableGlobalContext=false
                      Scode=
#$@text#$@
//保存数据
def values = itemForm.doAction("getValues", actionContext);
def thing = editItem.getData("thing");
thing.getAttributes().putAll(values);

//更新Item
editItem.setText(thing.getString("text", "", actionContext));
#$@text#$@
                      sinterpretationType=Action
                      screateLocalVarScope=false
                      ssaveReturn=false
                      sdebugLog=false
                      sdescriptors=xworker.lang.actions.Actions/@GroovyAction
                      sinheritDescription=false
                      sth_createIndex=false
                      sth_registMyChilds=false
                      sth_registDisabled=false
                      sth_mark=false
                      sid=GroovyAction
                @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777
                sname=deleteItemButton
                stext=lang:d=移除&en=Remove
                stype=SWT.PUSH
                sflat=false
                sborder=false
                sselected=false
                scapture=false
                senabled=true
                sredraw=true
                svisible=true
                sdescriptors=xworker.swt.Widgets/@Button
                sth_createIndex=false
                sid=24777
                  @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777/@24778
                  sname=RowData
                  sexclude=false
                  swidth=80
                  sheight=-1
                  sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
                  sth_createIndex=false
                  sid=24778
                  @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777/@24779
                  sname=Listeners
                  sdescriptors=xworker.swt.widgets.Widget/@Listeners
                  sth_createIndex=false
                  sid=24779
                    @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777/@24779/@24780
                    sname=deleteItemButtonSelection
                    stype=Selection
                    sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
                    sth_createIndex=false
                    sid=24780
                      @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777/@24779/@24780/@confirm
                      sname=confirm
                      sshell=ognl:saveButton.getShell()
                      sicon=ICON_QUESTION
                      sbuttons=OK | CANCEL
                      stitle=lang:d=移除条目&en=Remove Item
                      smessage=lang:d=确定要移除当前的条目么?&en=Are you sure to remove current item?
                      sinterpretationType=Self
                      sattributeTemplate=false
                      schildsAttributeTemplate=false
                      svarScope=Local
                      sisSynchronized=false
                      sthrowException=true
                      suseOtherAction=false
                      screateLocalVarScope=false
                      ssaveReturn=false
                      sdisableGlobalContext=false
                      sdebugLog=false
                      sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox
                      sinheritDescription=false
                      sth_createIndex=false
                      sth_registMyChilds=false
                      sth_registDisabled=false
                      sth_mark=false
                      sid=confirm
                        @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777/@24779/@24780/@confirm/@actions
                        sname=actions
                        sdescriptors=xworker.swt.actions.MessageBoxActions/@MessageBox/@actions1
                        sinheritDescription=false
                        sth_createIndex=false
                        sth_registMyChilds=false
                        sth_registDisabled=false
                        sth_mark=false
                        sid=actions
                          @/@Control/@Composite/@mainSashForm/@expandBar/@editItem/@editItemComposite/@24770/@24777/@24779/@24780/@confirm/@actions/@GroovyAction
                          sname=ok
                          sisSynchronized=false
                          sthrowException=true
                          suseOtherAction=false
                          svarScope=Local
                          sdisableGlobalContext=false
                          Scode=
#$@text#$@
editItem.getControl().dispose();
editItem.dispose();
#$@text#$@
                          sinterpretationType=Action
                          screateLocalVarScope=false
                          ssaveReturn=false
                          sdebugLog=false
                          sdescriptors=xworker.lang.actions.Actions/@GroovyAction
                          sinheritDescription=false
                          sth_createIndex=false
                          sth_registMyChilds=false
                          sth_registDisabled=false
                          sth_mark=false
                          sid=GroovyAction
          @/@Control/@Composite/@mainSashForm/@expandBar/@newItem
          sname=newItem
          sdescriptors=xworker.swt.widgets.ExpandBar/@ExpandItem
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=newItem
            @/@Control/@Composite/@mainSashForm/@expandBar/@newItem/@createNewButton
            sname=createNewButton
            stext=lang:d=创建&en=Create
            stype=SWT.PUSH
            sflat=false
            sborder=false
            sselected=false
            scapture=false
            senabled=true
            sredraw=true
            svisible=true
            sdescriptors=xworker.swt.Widgets/@Button
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=createNewButton
              @/@Control/@Composite/@mainSashForm/@expandBar/@newItem/@createNewButton/@Listeners
              sname=Listeners
              sdescriptors=xworker.swt.widgets.Widget/@Listeners
              sinheritDescription=false
              sth_createIndex=false
              sth_registMyChilds=false
              sth_registDisabled=false
              sth_mark=false
              sid=Listeners
                @/@Control/@Composite/@mainSashForm/@expandBar/@newItem/@createNewButton/@Listeners/@createNewItemButtonSelection
                sname=createNewItemButtonSelection
                stype=Selection
                sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
                sinheritDescription=false
                sth_createIndex=false
                sth_registMyChilds=false
                sth_registDisabled=false
                sth_mark=false
                sid=createNewItemButtonSelection
                  @/@Control/@Composite/@mainSashForm/@expandBar/@newItem/@createNewButton/@Listeners/@createNewItemButtonSelection/@GroovyAction
                  sname=GroovyAction
                  sisSynchronized=false
                  sthrowException=true
                  suseOtherAction=false
                  svarScope=Local
                  sdisableGlobalContext=false
                  Scode=
#$@text#$@
import org.xmeta.ActionContext;
import org.xmeta.Thing;

//获取当前的
def currentItem = expandBar.getItem(expandBar.getItems().length - 1);

def ac = new ActionContext();
ac.put("parent", expandBar);

def itemThing = world.getThing("xworker.swtshare.p2017.p06.p23.ExpandBarCreator/@Control/@Composite/@mainSashForm/@expandBar/@editItem");
def item = itemThing.doAction("create", ac);
item.setData("thing", new Thing("xworker.swt.widgets.ExpandBar/@ExpandItem"));
item.setData("actionContext", ac);
ac.put("item", item);

//dispose当前
currentItem.getControl().dispose();
currentItem.dispose();
//println "createNewButton.isDisposed()=" + createNewButton.isDisposed();
actionContext.peek().put("parent", expandBar);
def createItemThing = world.getThing("xworker.swtshare.p2017.p06.p23.ExpandBarCreator/@Control/@Composite/@mainSashForm/@expandBar/@newItem");
createItemThing.doAction("create", actionContext);
#$@text#$@
                  sinterpretationType=Action
                  screateLocalVarScope=false
                  ssaveReturn=false
                  sdebugLog=false
                  sdescriptors=xworker.lang.actions.Actions/@GroovyAction
                  sinheritDescription=false
                  sth_createIndex=false
                  sth_registMyChilds=false
                  sth_registDisabled=false
                  sth_mark=false
                  sid=GroovyAction
      @/@Control/@Composite/@init
      sname=init
      sisSynchronized=false
      sthrowException=true
      suseOtherAction=false
      svarScope=Local
      sdisableGlobalContext=false
      Scode=
#$@text#$@
editItem.getControl().dispose();
editItem.dispose();
#$@text#$@
      sinterpretationType=Action
      screateLocalVarScope=false
      ssaveReturn=false
      sdebugLog=false
      sdescriptors=xworker.swt.widgets.Widget/@Code
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=init
  @/@actions
  sname=actions
  sdescriptors=xworker.swt.design.InjectableControl/@actions1
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=actions
    @/@actions/@getInsertControl
    sname=getInsertControl
    sisSynchronized=false
    sthrowException=true
    suseOtherAction=false
    svarScope=Local
    sdisableGlobalContext=false
    Scode=
#$@text#$@
import org.xmeta.Thing;

//创建CTabFolder
def expandBarThing = new Thing("xworker.swt.widgets.ExpandBar");
expandBarThing.getAttributes().putAll(mainForm.doAction("getValues", actionContext));

//添加ui
//expandBarThing.addChild(world.getThing("xworker.swt.xwidgets.ineractive.CTabFolderEditor/@ctabFodler").detach());

//获取条目
for(item in expandBar.getItems()){
    def itemThing = item.getData("thing");
    if(itemThing == null){
        continue; //一般是最后的新建条目那个
    }
    
    def ac = item.getData("actionContext");
    itemThing.getAttributes().putAll(ac.itemForm.doAction("getValues", ac));
    
    //添加可注入面板
    def icomp = new Thing("xworker.swt.design.InjectableComposite");
    icomp.put("name", itemThing.getMetadata().getName() + "_InjectableComposite");
    
    itemThing.addChild(icomp);
    expandBarThing.addChild(itemThing);    
}

return expandBarThing;
#$@text#$@
    sinterpretationType=Action
    screateLocalVarScope=false
    ssaveReturn=false
    sdebugLog=false
    sdescriptors=xworker.lang.actions.Actions/@GroovyAction
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=getInsertControl
