%1499686035749
@
sname=InsertInjectableCompoiste
slabel=插入
stype=composite
sgroup=500|可注入
sicon=icons/application.png
sstyledTextForInsert=parentContext.parentContext.codeText
suseTargetThingDoc=false
sen_label=Insert
sen_group=500|Injectable
sdescriptors=xworker.swt.xworker.ThingRegistThing
sinheritDescription=false
sth_createIndex=true
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@Composite
  sname=Composite
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.xworker.ThingRegistThing/@Composite
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=Composite
    @/@Composite/@resources
    sname=resources
    sdescriptors=xworker.swt.Widgets/@Resource
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=resources
      @/@Composite/@resources/@I18nResource
      sname=I18nResource
      sdescriptors=xworker.swt.util.Resource/@I18nResource
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=I18nResource
        @/@Composite/@resources/@I18nResource/@insertButton
        sname=insertButton
        slabel=插入
        sen_label=Insert
        sdescriptors=xworker.lang.util.I18nResource/@resource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=insertButton
        @/@Composite/@resources/@I18nResource/@confirmMessage
        sname=confirmMessage
        slabel=确定要插入可注入面板吗？
        sen_label=Are you sure to insert an injection composite?
        sdescriptors=xworker.lang.util.I18nResource/@resource
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=confirmMessage
    @/@Composite/@compositeGridLayout
    sname=compositeGridLayout
    smakeColumnsEqualWidth=false
    smarginWidth=5
    smarginHeight=5
    smarginLeft=0
    smarginTop=0
    smarginRight=0
    smarginBottom=0
    shorizontalSpacing=5
    sverticalSpacing=5
    sdescriptors=xworker.swt.Layouts/@GridLayout
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=compositeGridLayout
    @/@Composite/@mainSashForm
    sname=mainSashForm
    sstyle=HORIZONTAL
    sSMOOTH=false
    sweights=30,70
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@SashForm
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=mainSashForm
      @/@Composite/@mainSashForm/@controlTree
      sname=controlTree
      sselectStyle=SINGLE
      sV_SCROLL=true
      sH_SCROLL=true
      sCHECK=false
      sFULL_SELECTION=false
      sHIDE_SELECTION=false
      sBORDER=false
      slineVisible=false
      smultipleColumns=false
      sheaderVisible=false
      ssortIndicator=false
      smoveableColumns=false
      sheadImages=false
      ssubImages=false
      scheckSelection=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Tree
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=controlTree
        @/@Composite/@mainSashForm/@controlTree/@onSelection
        sname=onSelection
        sdescriptors=xworker.swt.widgets.Widget/@Event
        sinheritDescription=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=onSelection
          @/@Composite/@mainSashForm/@controlTree/@onSelection/@Enabled
          sname=Enabled
          smethod=enable
          scontrolList=insertButton
          sinterpretationType=Self
          sattributeTemplate=false
          schildsAttributeTemplate=false
          svarScope=Local
          sisSynchronized=false
          sthrowException=true
          suseOtherAction=false
          screateLocalVarScope=false
          ssaveReturn=false
          sdisableGlobalContext=false
          sdebugLog=false
          sdescriptors=xworker.swt.actions.ControlActions/@Enabled
          sinheritDescription=false
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=Enabled
      @/@Composite/@mainSashForm/@rightForm
      sname=rightForm
      scolumn=1
      sH_SCROLL=true
      sV_SCROLL=true
      sNO_BACKGROUND=false
      sNO_FOCUS=false
      sNO_MERGE_PAINTS=false
      sNO_REDRAW_RESIZE=false
      sNO_RADIO_GROUP=false
      sEMBEDDED=false
      sDOUBLE_BUFFERED=false
      sdescriptors=xworker.swt.Widgets/@ThingForm
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=rightForm
        @/@Composite/@mainSashForm/@rightForm/@Thing
        sname=Thing
        sdescriptors=xworker.swt.xworker.ThingForm/@Thing
        smany=true
        seditCols=2
        sinitialization=false
        smodifier=public
        sinheritDescription=false
        snotXmlAttribute=false
        sjson_isArray=false
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=Thing
          @/@Composite/@mainSashForm/@rightForm/@Thing/@description
          sname=description
          sinputtype=htmlDesc
          sshowLabel=false
          sinputattrs=thingPath=xworker.swtshare.p2016.p12.p20.InsertInjectableCompoiste/@Composite/@mainSashForm/@rightForm/@Thing/@description&style=FILL_HORIZONTAL&height=300
          sreadOnly=false
          sdefault=xworker.swtshare.p2016.p12.p20.InsertInjectableCompoiste/@Composite/@mainSashForm/@rightForm/@Thing/@description
          sinheritDescription=false
          Sdescription=
#$@text#$@
<p>在控件之上插入一个可注入的面板，并且使控件作为可注入面板的子节点。目的是让该控件变成可以被替换的。</p>

<p><strong>注意：</strong></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp; 模型的路径会有变更，对模型路径敏感时请自行控制。</p>
#$@text#$@
          svalidateAllowBlank=true
          LvalidateOnBlur=true
          LallowDecimals=true
          LallowNegative=true
          snotXmlAttribute=false
          sdescriptors=xworker.lang.MetaDescriptor3/@attribute
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=description
          @/@Composite/@mainSashForm/@rightForm/@Thing/@name
          sname=name
          sshowLabel=true
          sreadOnly=false
          sinheritDescription=false
          svalidateAllowBlank=true
          LvalidateOnBlur=true
          LallowDecimals=true
          LallowNegative=true
          snotXmlAttribute=false
          sdescriptors=xworker.lang.MetaDescriptor3/@attribute
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=name
          @/@Composite/@mainSashForm/@rightForm/@Thing/@label
          sname=label
          sshowLabel=true
          sreadOnly=false
          sinheritDescription=false
          svalidateAllowBlank=true
          LvalidateOnBlur=true
          LallowDecimals=true
          LallowNegative=true
          snotXmlAttribute=false
          sdescriptors=xworker.lang.MetaDescriptor3/@attribute
          sth_createIndex=false
          sth_registMyChilds=false
          sth_registDisabled=false
          sth_mark=false
          sid=label
      @/@Composite/@mainSashForm/@mainSashFormGridData
      sname=mainSashFormGridData
      sstyle=FILL_BOTH
      shorizontalIndent=0
      swidth=-1
      sheight=-1
      shorizontalAlignment=BEGINNING
      sverticalAlignment=CENTER
      shorizontalSpan=1
      sverticalSpan=1
      sgrabExcessHorizontalSpace=false
      sgrabExcessVerticalSpace=false
      sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=mainSashFormGridData
    @/@Composite/@2689
    sname=buttonComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sid=2689
      @/@Composite/@2689/@2690
      sname=buttonCompositeGridData
      sstyle=FILL_HORIZONTAL
      shorizontalIndent=0
      swidth=-1
      sheight=-1
      shorizontalAlignment=END
      sverticalAlignment=CENTER
      shorizontalSpan=1
      sverticalSpan=1
      sgrabExcessHorizontalSpace=false
      sgrabExcessVerticalSpace=false
      sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
      sid=2690
      @/@Composite/@2689/@2691
      sname=buttonCompositeRowLayout
      sfill=false
      sjustify=false
      smarginWidth=0
      smarginHeight=0
      smarginLeft=3
      smarginTop=3
      smarginRight=3
      smarginBottom=3
      spack=true
      sspacing=3
      stype=SWT.HORIZONTAL
      swrap=true
      sdescriptors=xworker.swt.Layouts/@RowLayout
      sid=2691
      @/@Composite/@2689/@2692
      sname=insertButton
      stext=label:xworker.swtshare.p2016.p12.p20.InsertInjectableCompoiste/@Composite/@resources/@I18nResource/@insertButton
      stype=SWT.PUSH
      sflat=false
      sborder=false
      sselected=false
      scapture=false
      senabled=false
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Button
      sth_createIndex=false
      sid=2692
        @/@Composite/@2689/@2692/@2693
        sname=RowData
        sexclude=false
        swidth=80
        sheight=-1
        sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
        sth_createIndex=false
        sid=2693
        @/@Composite/@2689/@2692/@2694
        sname=Listeners
        sdescriptors=xworker.swt.widgets.Widget/@Listeners
        sth_createIndex=false
        sid=2694
          @/@Composite/@2689/@2692/@2694/@2695
          sname=insertButtonSelection
          stype=Selection
          sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
          sth_createIndex=false
          sid=2695
            @/@Composite/@2689/@2692/@2694/@2695/@GroovyAction
            sname=GroovyAction
            sisSynchronized=false
            sthrowException=true
            suseOtherAction=false
            svarScope=Local
            sdisableGlobalContext=false
            Scode=
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.MessageBox;

import org.xmeta.Thing;
import xworker.swt.design.InjectableComposite;
import xworker.swt.util.XWorkerTreeUtil;
import xworker.util.StringUtils;

//当前树选择的节点
def thing = controlTree.getSelection()[0].getData();

def box = new MessageBox(insertButton.getShell(), SWT.ICON_INFORMATION | SWT.OK | SWT.CANCEL);
box.setText(StringUtils.getString("label:xworker.swtshare.p2016.p12.p20.InsertInjectableCompoiste", actionContext));
box.setMessage(StringUtils.getString("label:xworker.swtshare.p2016.p12.p20.InsertInjectableCompoiste/@Composite/@resources/@I18nResource/@confirmMessage", actionContext));
if(box.open() != SWT.OK){
    return;
}

//创建可注入面板
def ic = new Thing("xworker.swt.design.InjectableComposite");
def values = rightForm.doAction("getValues", actionContext);
ic.getAttributes().putAll(values);

def child = new Thing("xworker.swt.design.InjectableComposite/@Control");
ic.addChild(child);

def dthing = thing.detach();
child.addChild(dthing);

thing.replace(ic);
thing.save();

//重新刷新树
def ui = parentContext.parentContext.ui;

//获取control和事物
def uiControl = ui.getControl();
def uiThing = uiControl.getData("thing");

def controlThing = uiThing.getThing("Control@0");
def controlChild = controlThing.getChilds().get(0);
if(controlThing != null && controlThing.getChilds().size() > 0){
    controlTree.removeAll();
    XWorkerTreeUtil.showThingOnTree(controlTree, controlThing.getChilds().get(0), actionContext);
    
    //刷新界面
    InjectableComposite.setChild(controlThing.getChilds().get(0), actionContext);
}
#$@text#$@
            sinterpretationType=Action
            screateLocalVarScope=false
            ssaveReturn=false
            sdebugLog=false
            sdescriptors=xworker.lang.actions.Actions/@GroovyAction
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=GroovyAction
    @/@Composite/@init
    sname=init
    sisSynchronized=false
    sthrowException=true
    suseOtherAction=false
    svarScope=Local
    sdisableGlobalContext=false
    Scode=
#$@text#$@
import xworker.swt.design.DesignShellActions;
import xworker.swt.util.XWorkerTreeUtil;

//获取ui
def ui = parentContext.parentContext.ui;

//获取control和事物
def control = ui.getControl();
def thing = control.getData("thing");

def controlThing = thing.getThing("Control@0");
if(controlThing != null && controlThing.getChilds().size() > 0){
    XWorkerTreeUtil.showThingOnTree(controlTree, controlThing.getChilds().get(0), actionContext);
}

//显示控件列表
//DesignShellActions.showControlsOnTree(control, controlTree, actionContext);
#$@text#$@
    sinterpretationType=Action
    screateLocalVarScope=false
    ssaveReturn=false
    sdebugLog=false
    sdescriptors=xworker.swt.widgets.Widget/@Code
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=init
