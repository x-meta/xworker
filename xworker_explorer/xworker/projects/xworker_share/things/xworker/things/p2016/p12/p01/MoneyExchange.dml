%1480592615124
@
sname=MoneyExchange
slabel=货币兑换
stype=composite
sgroup=金融.货币
sicon=icons/application.png
sstyledTextForInsert=parentContext.parentContext.codeText
suseTargetThingDoc=false
sdescriptors=xworker.swt.xworker.ThingRegistThing
sinheritDescription=false
sth_createIndex=true
sth_registThing=command|xworker.command.Root
sth_registMyChilds=false
sth_registDisabled=false
sth_mark=false
  @/@Composite
  sname=Composite
  sBORDER=false
  sH_SCROLL=false
  sV_SCROLL=false
  sNO_BACKGROUND=false
  sNO_FOCUS=false
  sNO_MERGE_PAINTS=false
  sNO_REDRAW_RESIZE=false
  sNO_RADIO_GROUP=false
  sEMBEDDED=false
  sDOUBLE_BUFFERED=false
  scapture=false
  senabled=true
  sredraw=true
  svisible=true
  sdescriptors=xworker.swt.xworker.ThingRegistThing/@Composite
  sinheritDescription=false
  sth_createIndex=false
  sth_registMyChilds=false
  sth_registDisabled=false
  sth_mark=false
  sid=Composite
    @/@Composite/@compositeGridLayout
    sname=compositeGridLayout
    smakeColumnsEqualWidth=false
    smarginWidth=5
    smarginHeight=5
    smarginLeft=0
    smarginTop=0
    smarginRight=0
    smarginBottom=0
    shorizontalSpacing=5
    sverticalSpacing=5
    sdescriptors=xworker.swt.Layouts/@GridLayout
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=compositeGridLayout
    @/@Composite/@thingForm
    sname=thingForm
    scolumn=1
    sH_SCROLL=true
    sV_SCROLL=true
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    sdescriptors=xworker.swt.Widgets/@ThingForm
    sinheritDescription=false
    sth_createIndex=false
    sth_registMyChilds=false
    sth_registDisabled=false
    sth_mark=false
    sid=thingForm
      @/@Composite/@thingForm/@Thing
      sname=Thing
      sdescriptors=xworker.swt.xworker.ThingForm/@Thing
      smany=true
      seditCols=2
      sinitialization=false
      smodifier=public
      sinheritDescription=false
      snotXmlAttribute=false
      sjson_isArray=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=Thing
        @/@Composite/@thingForm/@Thing/@count
        sname=count
        slabel=金额
        sshowLabel=true
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=false
        sblankText=金额不能为空！
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=count
        @/@Composite/@thingForm/@Thing/@srcCurrency
        sname=srcCurrency
        slabel=原始货币
        sinputtype=openWindow
        sshowLabel=true
        sinputattrs=xworker.dataObject.swt.AttributeDataObjectSelector/@shell|winWidth=-1,dataObject=xworker.things.p2016.p12.p01.CurrencyCode,winHeight=-1,attributeName=code,multi=false
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=false
        sblankText=请选择一个原始货币！
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        srelationDataObject=xworker.things.p2016.p12.p01.CurrencyCode
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=srcCurrency
        @/@Composite/@thingForm/@Thing/@targetCurrency
        sname=targetCurrency
        slabel=目标货币
        sinputtype=openWindow
        sshowLabel=true
        sinputattrs=xworker.dataObject.swt.AttributeDataObjectSelector/@shell|winWidth=-1,dataObject=xworker.things.p2016.p12.p01.CurrencyCode,winHeight=-1,attributeName=code,multi=false
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=false
        sblankText=请选择一个目标货币！
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        srelationDataObject=xworker.things.p2016.p12.p01.CurrencyCode
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=targetCurrency
        @/@Composite/@thingForm/@Thing/@amount
        sname=amount
        slabel=兑换后数量
        sshowLabel=true
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=true
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=amount
        @/@Composite/@thingForm/@Thing/@rate
        sname=rate
        slabel=汇率
        sshowLabel=true
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=true
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=rate
        @/@Composite/@thingForm/@Thing/@rateDate
        sname=rateDate
        slabel=汇率更新时间
        sshowLabel=true
        sreadOnly=false
        sinheritDescription=false
        svalidateAllowBlank=true
        LvalidateOnBlur=true
        LallowDecimals=true
        LallowNegative=true
        snotXmlAttribute=false
        sdescriptors=xworker.lang.MetaDescriptor3/@attribute
        sth_createIndex=false
        sth_registMyChilds=false
        sth_registDisabled=false
        sth_mark=false
        sid=rateDate
      @/@Composite/@thingForm/@thingFormGridData
      sname=thingFormGridData
      sstyle=FILL_HORIZONTAL
      shorizontalIndent=0
      swidth=-1
      sheight=-1
      shorizontalAlignment=BEGINNING
      sverticalAlignment=CENTER
      shorizontalSpan=1
      sverticalSpan=1
      sgrabExcessHorizontalSpace=false
      sgrabExcessVerticalSpace=false
      sxw_cl_global=false
      sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
      sinheritDescription=false
      sth_createIndex=false
      sth_registMyChilds=false
      sth_registDisabled=false
      sth_mark=false
      sid=thingFormGridData
    @/@Composite/@1993
    sname=buttonComposite
    sBORDER=false
    sH_SCROLL=false
    sV_SCROLL=false
    sNO_BACKGROUND=false
    sNO_FOCUS=false
    sNO_MERGE_PAINTS=false
    sNO_REDRAW_RESIZE=false
    sNO_RADIO_GROUP=false
    sEMBEDDED=false
    sDOUBLE_BUFFERED=false
    scapture=false
    senabled=true
    sredraw=true
    svisible=true
    sdescriptors=xworker.swt.Widgets/@Composite
    sid=1993
      @/@Composite/@1993/@1994
      sname=buttonCompositeGridData
      sstyle=FILL_HORIZONTAL
      shorizontalIndent=0
      swidth=-1
      sheight=-1
      shorizontalAlignment=BEGINNING
      sverticalAlignment=CENTER
      shorizontalSpan=1
      sverticalSpan=1
      sgrabExcessHorizontalSpace=false
      sgrabExcessVerticalSpace=false
      sxw_cl_global=false
      sdescriptors=xworker.swt.layout.LayoutDatas/@GridData
      sid=1994
      @/@Composite/@1993/@1995
      sname=buttonCompositeRowLayout
      sfill=false
      sjustify=false
      smarginWidth=0
      smarginHeight=0
      smarginLeft=3
      smarginTop=3
      smarginRight=3
      smarginBottom=3
      spack=true
      sspacing=3
      stype=SWT.HORIZONTAL
      swrap=true
      sdescriptors=xworker.swt.Layouts/@RowLayout
      sid=1995
      @/@Composite/@1993/@1996
      sname=exchangeButton
      stext=兑换
      stype=SWT.PUSH
      sflat=false
      sborder=false
      sselected=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Button
      sth_createIndex=false
      sid=1996
        @/@Composite/@1993/@1996/@1997
        sname=RowData
        sexclude=false
        swidth=80
        sheight=-1
        sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
        sth_createIndex=false
        sid=1997
        @/@Composite/@1993/@1996/@1998
        sname=Listeners
        sdescriptors=xworker.swt.widgets.Widget/@Listeners
        sth_createIndex=false
        sid=1998
          @/@Composite/@1993/@1996/@1998/@1999
          sname=exchangeButtonSelection
          stype=Selection
          sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
          sth_createIndex=false
          sid=1999
            @/@Composite/@1993/@1996/@1998/@1999/@GroovyAction
            sname=GroovyAction
            sisSynchronized=false
            sthrowException=true
            suseOtherAction=false
            svarScope=Local
            sdisableGlobalContext=false
            Scode=
#$@text#$@
import xworker.finance.exchange.CurrencyUtils;

if(thingForm.doAction("validate", actionContext)){
    def values = thingForm.doAction("getValues", actionContext);
    
    def rate = CurrencyUtils.getexChangeRate(values.srcCurrency, values.targetCurrency);
    def amount = CurrencyUtils.exchange(values.srcCurrency, values.targetCurrency, Double.parseDouble(values.count))
    values.put("amount", amount);
    values.put("rate", rate);
    thingForm.doAction("setValues", actionContext, "values", values);
}
#$@text#$@
            sinterpretationType=Action
            screateLocalVarScope=false
            ssaveReturn=false
            sdebugLog=false
            sdescriptors=xworker.lang.actions.Actions/@GroovyAction
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=GroovyAction
      @/@Composite/@1993/@19961
      sname=exchangeCodeButton
      stext=货币互换
      stype=SWT.PUSH
      sflat=false
      sborder=false
      sselected=false
      scapture=false
      senabled=true
      sredraw=true
      svisible=true
      sdescriptors=xworker.swt.Widgets/@Button
      sth_createIndex=false
      sid=19961
        @/@Composite/@1993/@19961/@1997
        sname=RowData
        sexclude=false
        swidth=80
        sheight=-1
        sdescriptors=xworker.swt.layout.LayoutDatas/@RowData
        sth_createIndex=false
        sid=1997
        @/@Composite/@1993/@19961/@1998
        sname=Listeners
        sdescriptors=xworker.swt.widgets.Widget/@Listeners
        sth_createIndex=false
        sid=1998
          @/@Composite/@1993/@19961/@1998/@1999
          sname=exchangeCodeButtonSelection
          stype=Selection
          sdescriptors=xworker.swt.events.Listeners/@listeners/@Listener
          sth_createIndex=false
          sid=1999
            @/@Composite/@1993/@19961/@1998/@1999/@GroovyAction
            sname=GroovyAction
            sisSynchronized=false
            sthrowException=true
            suseOtherAction=false
            svarScope=Local
            sdisableGlobalContext=false
            Scode=
#$@text#$@
def values = thingForm.doAction("getValues", actionContext);
def src = values.srcCurrency;
values.srcCurrency = values.targetCurrency;
values.targetCurrency = src;
thingForm.doAction("setValues", actionContext, "values", values);
#$@text#$@
            sinterpretationType=Action
            screateLocalVarScope=false
            ssaveReturn=false
            sdebugLog=false
            sdescriptors=xworker.lang.actions.Actions/@GroovyAction
            sinheritDescription=false
            sth_createIndex=false
            sth_registMyChilds=false
            sth_registDisabled=false
            sth_mark=false
            sid=GroovyAction
